<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>xproccorb.xpl</title><link rel="stylesheet" type="text/css" href="theme.css"></head><body><div><p class="spectrum"><span class="z">&lt;?</span><span class="pi">xml version="1.0" encoding="UTF-8"</span><span class="z">?&gt;</span><span class="txt">
</span><span class="z">&lt;!--</span><span class="cm"> 
     Syntax-highlighted transform of xproccorb.xpl
     on GitHub https://github.com/philipfennell/xproc-libraries.git
</span><span class="z">--&gt;</span><span class="txt">
</span><span class="es">&lt;</span><span class="en">p:declare-step</span><span class="z"> 
    </span><span class="atn">xmlns:c</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/ns/xproc-step</span><span class="z">"</span><span class="z">
    </span><span class="atn">xmlns:cx</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://xmlcalabash.com/ns/extensions</span><span class="z">"</span><span class="z">
    </span><span class="atn">xmlns:file</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.marklogic.com/xproc/file/</span><span class="z">"</span><span class="z">
    </span><span class="atn">xmlns:ml</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://xmlcalabash.com/ns/extensions/marklogic</span><span class="z">"</span><span class="z">
    </span><span class="atn">xmlns:p</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/ns/xproc</span><span class="z">"</span><span class="z">
    </span><span class="atn">xmlns:xpc</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.marklogic.com/xproccorb/</span><span class="z">"</span><span class="z">
    </span><span class="atn">xmlns:xs</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/2001/XMLSchema</span><span class="z">"</span><span class="z">
    </span><span class="atn">xmlns:xsi</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/2001/XMLSchema-instance</span><span class="z">"</span><span class="z">
    </span><span class="atn">xml:base</span><span class="atneq">=</span><span class="z">"</span><span class="av">../</span><span class="z">"</span><span class="z">
    </span><span class="atn">exclude-inline-prefixes</span><span class="atneq">=</span><span class="z">"</span><span class="av">xsi</span><span class="z">"</span><span class="z">
    </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">xproccorb</span><span class="z">"</span><span class="z">
    </span><span class="atn">version</span><span class="atneq">=</span><span class="z">"</span><span class="av">1.0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  
  </span><span class="es">&lt;</span><span class="en">p:input</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">source</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
  </span><span class="es">&lt;</span><span class="en">p:output</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">result</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
  
  </span><span class="es">&lt;</span><span class="en">p:serialization</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">result</span><span class="z">"</span><span class="z"> </span><span class="atn">encoding</span><span class="atneq">=</span><span class="z">"</span><span class="av">UTF-8</span><span class="z">"</span><span class="z"> </span><span class="atn">indent</span><span class="atneq">=</span><span class="z">"</span><span class="av">true</span><span class="z">"</span><span class="z"> </span><span class="atn">media-type</span><span class="atneq">=</span><span class="z">"</span><span class="av">application/xml</span><span class="z">"</span><span class="z"> </span><span class="atn">method</span><span class="atneq">=</span><span class="z">"</span><span class="av">xml</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
  
  </span><span class="es">&lt;</span><span class="en">p:import</span><span class="z"> </span><span class="atn">href</span><span class="atneq">=</span><span class="z">"</span><span class="av">pipelines/library-1.0.xpl</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
  
  
  
  </span><span class="es">&lt;</span><span class="en">p:declare-step</span><span class="z"> </span><span class="atn">type</span><span class="atneq">=</span><span class="z">"</span><span class="av">xpc:load-query</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="en">p:documentation</span><span class="scx">&gt;</span><span class="txt">Retrieves an XQuery referenced in the config file.</span><span class="ez">&lt;/</span><span class="cl">p:documentation</span><span class="ec">&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="en">p:input</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">source</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="en">p:output</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">result</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="enxsl">p:option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="fname">query</span><span class="z">"</span><span class="z"> </span><span class="atn">required</span><span class="atneq">=</span><span class="z">"</span><span class="av">true</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    
    </span><span class="es">&lt;</span><span class="enxsl">p:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="fname">user</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">ml:config</span><span class="step" start="11">/</span><span class="qname" start="12" select="quick">ml:user</span><span class="step" start="19">/</span><span class="node" start="20" pair-end="25" select="quick">text</span><span class="parenthesis">(</span><span class="parenthesis" start="25">)</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="enxsl">p:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="fname">password</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">ml:config</span><span class="step" start="11">/</span><span class="qname" start="12" select="quick">ml:password</span><span class="step" start="23">/</span><span class="node" start="24" pair-end="29" select="quick">text</span><span class="parenthesis">(</span><span class="parenthesis" start="29">)</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="enxsl">p:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="fname">host</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">ml:config</span><span class="step" start="11">/</span><span class="qname" start="12" select="quick">ml:host</span><span class="step" start="19">/</span><span class="node" start="20" pair-end="25" select="quick">text</span><span class="parenthesis">(</span><span class="parenthesis" start="25">)</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="enxsl">p:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="fname">port</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">ml:config</span><span class="step" start="11">/</span><span class="qname" start="12" select="quick">ml:port</span><span class="step" start="19">/</span><span class="node" start="20" pair-end="25" select="quick">text</span><span class="parenthesis">(</span><span class="parenthesis" start="25">)</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="enxsl">p:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="fname">content-database</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">ml:config</span><span class="step" start="11">/</span><span class="qname" start="12" select="quick">ml:content-database</span><span class="step" start="31">/</span><span class="node" start="32" pair-end="37" select="quick">text</span><span class="parenthesis">(</span><span class="parenthesis" start="37">)</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    
    </span><span class="es">&lt;</span><span class="en">p:group</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:documentation</span><span class="scx">&gt;</span><span class="txt">Build the request.</span><span class="ez">&lt;/</span><span class="cl">p:documentation</span><span class="ec">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:wrap-sequence</span><span class="z"> </span><span class="atn">wrapper</span><span class="atneq">=</span><span class="z">"</span><span class="av">c:request</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:add-attribute</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:request</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-name</span><span class="atneq">=</span><span class="z">"</span><span class="av">method</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-value</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">get</span><span class="op">'</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:add-attribute</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:request</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-name</span><span class="atneq">=</span><span class="z">"</span><span class="av">override-content-type</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-value</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">text</span><span class="step" start="5">/</span><span class="qname" start="6" select="quick">plain</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:add-attribute</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:request</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-name</span><span class="atneq">=</span><span class="z">"</span><span class="av">href</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">attribute-value</span><span class="z">"</span><span class="z">
                       </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:request</span><span class="step" start="11">/</span><span class="qname" start="12" select="quick">ml:config</span><span class="step" start="21">/</span><span class="node" start="22" pair-end="27" select="quick">node</span><span class="parenthesis">(</span><span class="parenthesis" start="27">)</span><span class="whitespace" start="28">
                               </span><span class="filter" start="29" pair-end="69" select="quick">[</span><span class="function" start="30" pair-end="41" select="quick">local-name</span><span class="parenthesis">(</span><span class="parenthesis" start="41">)</span><span class="whitespace" start="42"> </span><span class="op" start="43">=</span><span class="whitespace" start="44"> </span><span class="function" start="45" pair-end="68" select="quick">concat</span><span class="parenthesis">(</span><span class="variable" start="52" select="quick">$query</span><span class="op" start="58">,</span><span class="whitespace" start="59"> </span><span class="op">'</span><span class="literal" start="60">-query</span><span class="op">'</span><span class="parenthesis" start="68">)</span><span class="filter" start="69">]</span><span class="step" start="70">/</span><span class="axis" start="71">@</span><span class="qname" start="72" select="quick">href</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">p:add-attribute</span><span class="ec">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:make-absolute-uris</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:request</span><span class="step" start="11">/</span><span class="axis" start="12">@</span><span class="qname" start="13" select="quick">href</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:string-replace</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:request</span><span class="step" start="11">/</span><span class="axis" start="12">@</span><span class="qname" start="13" select="quick">href</span><span class="z">"</span><span class="z"> </span><span class="atn">replace</span><span class="atneq">=</span><span class="z">"</span><span class="function" start="1" pair-end="30" select="quick">replace</span><span class="parenthesis">(</span><span class="context" start="9">.</span><span class="op" start="10">,</span><span class="whitespace" start="11"> </span><span class="op">'</span><span class="literal" start="12">file:</span><span class="op">'</span><span class="op" start="19">,</span><span class="whitespace" start="20"> </span><span class="op">'</span><span class="literal" start="21">file://</span><span class="op">'</span><span class="parenthesis" start="30">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:documentation</span><span class="scx">&gt;</span><span class="txt">Fixes the URI so that it can be used by the http-request step.</span><span class="ez">&lt;/</span><span class="cl">p:documentation</span><span class="ec">&gt;</span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">p:string-replace</span><span class="ec">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:add-attribute</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:request</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-name</span><span class="atneq">=</span><span class="z">"</span><span class="av">detailed</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-value</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">true</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:delete</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:request</span><span class="step" start="11">/</span><span class="qname" start="12" select="quick">ml:config</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="cl">p:group</span><span class="ec">&gt;</span><span class="txt">
    
    </span><span class="es">&lt;</span><span class="en">p:http-request</span><span class="z"> </span><span class="atn">indent</span><span class="atneq">=</span><span class="z">"</span><span class="av">false</span><span class="z">"</span><span class="z"> </span><span class="atn">method</span><span class="atneq">=</span><span class="z">"</span><span class="av">text</span><span class="z">"</span><span class="z"> </span><span class="atn">encoding</span><span class="atneq">=</span><span class="z">"</span><span class="av">utf-8</span><span class="z">"</span><span class="z"> </span><span class="atn">media-type</span><span class="atneq">=</span><span class="z">"</span><span class="av">text/plain</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    
    </span><span class="es">&lt;</span><span class="en">p:group</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:documentation</span><span class="scx">&gt;</span><span class="txt">Add config properties to the retrieved query's wrapper element.</span><span class="ez">&lt;/</span><span class="cl">p:documentation</span><span class="ec">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:add-attribute</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-name</span><span class="atneq">=</span><span class="z">"</span><span class="av">user</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">attribute-value</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$user</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">p:add-attribute</span><span class="ec">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:add-attribute</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-name</span><span class="atneq">=</span><span class="z">"</span><span class="av">password</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">attribute-value</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$password</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">p:add-attribute</span><span class="ec">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:add-attribute</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-name</span><span class="atneq">=</span><span class="z">"</span><span class="av">host</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">attribute-value</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$host</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">p:add-attribute</span><span class="ec">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:add-attribute</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-name</span><span class="atneq">=</span><span class="z">"</span><span class="av">port</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">attribute-value</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$port</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">p:add-attribute</span><span class="ec">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:add-attribute</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="z">"</span><span class="z"> </span><span class="atn">attribute-name</span><span class="atneq">=</span><span class="z">"</span><span class="av">content-database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">attribute-value</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$content-database</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">p:add-attribute</span><span class="ec">&gt;</span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="cl">p:group</span><span class="ec">&gt;</span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="cl">p:declare-step</span><span class="ec">&gt;</span><span class="txt">
  
  </span><span class="es">&lt;</span><span class="en">p:declare-step</span><span class="z"> </span><span class="atn">type</span><span class="atneq">=</span><span class="z">"</span><span class="av">xpc:get-content-uris</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="en">p:documentation</span><span class="scx">&gt;</span><span class="txt">
      Executes the source XQuery against the specified
      database which returns a list of document URIs.
    </span><span class="ez">&lt;/</span><span class="cl">p:documentation</span><span class="ec">&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="en">p:input</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">source</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="en">p:output</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">result</span><span class="z">"</span><span class="z"> </span><span class="atn">sequence</span><span class="atneq">=</span><span class="z">"</span><span class="av">true</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    
    </span><span class="es">&lt;</span><span class="enxsl">ml:adhoc-query</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">fetch-uris</span><span class="z">"</span><span class="z"> </span><span class="atn">wrapper</span><span class="atneq">=</span><span class="z">"</span><span class="av">c:uri</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:input</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">source</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:input</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">parameters</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:empty</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">p:input</span><span class="ec">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">user</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="step" start="8">/</span><span class="axis" start="9">@</span><span class="qname" start="10" select="quick">user</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">password</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="step" start="8">/</span><span class="axis" start="9">@</span><span class="qname" start="10" select="quick">password</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">host</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="step" start="8">/</span><span class="axis" start="9">@</span><span class="qname" start="10" select="quick">host</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">port</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="step" start="8">/</span><span class="axis" start="9">@</span><span class="qname" start="10" select="quick">port</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">content-base</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="step" start="8">/</span><span class="axis" start="9">@</span><span class="qname" start="10" select="quick">content-database</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">ml:adhoc-query</span><span class="ec">&gt;</span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="cl">p:declare-step</span><span class="ec">&gt;</span><span class="txt">
  
  
  
  
  </span><span class="es">&lt;</span><span class="en">p:group</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="es">&lt;</span><span class="en">p:documentation</span><span class="scx">&gt;</span><span class="txt">
      Main pipeline that loads queries, executes them against the chosen content
      in the named database and returns the results of those queries/transforms.
    </span><span class="ez">&lt;/</span><span class="cl">p:documentation</span><span class="ec">&gt;</span><span class="txt">
    
    </span><span class="es">&lt;</span><span class="enxsl">xpc:load-query</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">uri-query</span><span class="z">"</span><span class="z"> </span><span class="atn">query</span><span class="atneq">=</span><span class="z">"</span><span class="av">uri</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    
    </span><span class="es">&lt;</span><span class="enxsl">xpc:get-content-uris</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">content-uris</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
    
    </span><span class="es">&lt;</span><span class="en">p:sink</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:documentation</span><span class="scx">&gt;</span><span class="txt">Provides a binding for the result port of 'content-uris'.</span><span class="ez">&lt;/</span><span class="cl">p:documentation</span><span class="ec">&gt;</span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="cl">p:sink</span><span class="ec">&gt;</span><span class="txt">
    
    </span><span class="es">&lt;</span><span class="enxsl">xpc:load-query</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">transform-query</span><span class="z">"</span><span class="z"> </span><span class="atn">query</span><span class="atneq">=</span><span class="z">"</span><span class="av">transform</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:input</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">source</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:pipe</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">source</span><span class="z">"</span><span class="z"> </span><span class="atn">step</span><span class="atneq">=</span><span class="z">"</span><span class="av">xproccorb</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">p:input</span><span class="ec">&gt;</span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xpc:load-query</span><span class="ec">&gt;</span><span class="txt">
    
    </span><span class="es">&lt;</span><span class="en">p:for-each</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">transform-documents</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="es">&lt;</span><span class="en">p:iteration-source</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:uri</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:pipe</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">result</span><span class="z">"</span><span class="z"> </span><span class="atn">step</span><span class="atneq">=</span><span class="z">"</span><span class="av">content-uris</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">p:iteration-source</span><span class="ec">&gt;</span><span class="txt">
      
      </span><span class="es">&lt;</span><span class="enxsl">ml:adhoc-query</span><span class="z"> </span><span class="atn">wrapper</span><span class="atneq">=</span><span class="z">"</span><span class="av">c:result</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:input</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">source</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="es">&lt;</span><span class="en">p:pipe</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">result</span><span class="z">"</span><span class="z"> </span><span class="atn">step</span><span class="atneq">=</span><span class="z">"</span><span class="av">transform-query</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="cl">p:input</span><span class="ec">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:input</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">parameters</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="es">&lt;</span><span class="en">p:empty</span><span class="sc">/&gt;</span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="cl">p:input</span><span class="ec">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">URI</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:uri</span><span class="step" start="7">/</span><span class="node" start="8" pair-end="13" select="quick">text</span><span class="parenthesis">(</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">user</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="step" start="8">/</span><span class="axis" start="9">@</span><span class="qname" start="10" select="quick">user</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="es">&lt;</span><span class="en">p:pipe</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">result</span><span class="z">"</span><span class="z"> </span><span class="atn">step</span><span class="atneq">=</span><span class="z">"</span><span class="av">transform-query</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="cl">p:with-option</span><span class="ec">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">password</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="step" start="8">/</span><span class="axis" start="9">@</span><span class="qname" start="10" select="quick">password</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="es">&lt;</span><span class="en">p:pipe</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">result</span><span class="z">"</span><span class="z"> </span><span class="atn">step</span><span class="atneq">=</span><span class="z">"</span><span class="av">transform-query</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="cl">p:with-option</span><span class="ec">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">host</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="step" start="8">/</span><span class="axis" start="9">@</span><span class="qname" start="10" select="quick">host</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="es">&lt;</span><span class="en">p:pipe</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">result</span><span class="z">"</span><span class="z"> </span><span class="atn">step</span><span class="atneq">=</span><span class="z">"</span><span class="av">transform-query</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="cl">p:with-option</span><span class="ec">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">port</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="step" start="8">/</span><span class="axis" start="9">@</span><span class="qname" start="10" select="quick">port</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="es">&lt;</span><span class="en">p:pipe</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">result</span><span class="z">"</span><span class="z"> </span><span class="atn">step</span><span class="atneq">=</span><span class="z">"</span><span class="av">transform-query</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="cl">p:with-option</span><span class="ec">&gt;</span><span class="txt">
        </span><span class="es">&lt;</span><span class="en">p:with-option</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">content-base</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">c:body</span><span class="step" start="8">/</span><span class="axis" start="9">@</span><span class="qname" start="10" select="quick">content-database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="es">&lt;</span><span class="en">p:pipe</span><span class="z"> </span><span class="atn">port</span><span class="atneq">=</span><span class="z">"</span><span class="av">result</span><span class="z">"</span><span class="z"> </span><span class="atn">step</span><span class="atneq">=</span><span class="z">"</span><span class="av">transform-query</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="cl">p:with-option</span><span class="ec">&gt;</span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">ml:adhoc-query</span><span class="ec">&gt;</span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="cl">p:for-each</span><span class="ec">&gt;</span><span class="txt">
    
    </span><span class="es">&lt;</span><span class="en">p:wrap-sequence</span><span class="z"> </span><span class="atn">wrapper</span><span class="atneq">=</span><span class="z">"</span><span class="av">c:results</span><span class="z">"</span><span class="sc">/&gt;</span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="cl">p:group</span><span class="ec">&gt;</span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">p:declare-step</span><span class="ec">&gt;</span><span class="txt">
</span></p></div></body></html>