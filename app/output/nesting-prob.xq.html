<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>nesting-prob.xq</title><link rel="stylesheet" type="text/css" href="theme.css"></head><body><div><pre class="spectrum"><span class="open"></span><span xq="yes" start="1" prev-is-closed="false" class="qname">declare</span><span xq="yes" start="8" prev-is-closed="true" class="whitespace"> </span><span xq="yes" start="9" prev-is-closed="true" class="qname">function</span><span xq="yes" start="17" prev-is-closed="true" class="whitespace"> </span><span xq="yes" start="18" prev-is-closed="true" class="function">display:print-modules</span><span class="parenthesis">(</span><span xq="yes" start="40" prev-is-closed="false" class="variable">$local</span><span xq="yes" start="46" prev-is-closed="true" class="whitespace"> </span><span xq="yes" start="47" prev-is-closed="true" class="op">as</span><span xq="yes" start="49" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="50" prev-is-closed="false" class="type-name">xs:boolean</span><span xq="yes" start="60" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="61" prev-is-closed="true" class="whitespace"> </span><span xq="yes" start="62" prev-is-closed="true" class="op">as</span><span xq="yes" start="64" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="65" prev-is-closed="false" class="node-type">element</span><span class="parenthesis">(</span><span xq="yes" start="73" prev-is-closed="false" class="parenthesis">)</span><span xq="yes" start="74" prev-is-closed="true" class="quantifier">+</span><span xq="yes" start="75" prev-is-closed="true" class="whitespace">&#xD;
</span><span xq="yes" start="77" prev-is-closed="true" class="op">{</span><span xq="yes" start="78" prev-is-closed="false" class="whitespace">&#xD;
  </span><span xq="yes" start="82" prev-is-closed="false" class="parenthesis">(</span><span pos="83" class="es">&lt;</span><span name="xml-open-tag" pos="84" class="en">div</span><span name="xml-name-end" pos="87" class="atn"> class</span><span name="x-equals" pos="93" class="atneq">=</span><span name="xml-att-quote" pos="94" class="z">"</span><span name="xml-literal-start" pos="95" class="av">home</span><span name="xml-att-quote" pos="99" class="z">"</span><span name="x-tag-end" pos="100" class="z">&gt;</span><span pos="101" class="txt">&#xD;
    </span><span name="nested-query" pos="107" class="op">{</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="whitespace">&#xD;
    </span><span xq="yes" start="7" prev-is-closed="true" class="if">if</span><span xq="yes" start="9" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="10" prev-is-closed="false" class="parenthesis">(</span><span xq="yes" start="11" prev-is-closed="false" class="function">fn:exists</span><span class="parenthesis">(</span><span xq="yes" start="21" prev-is-closed="false" class="function">fn:collection</span><span class="parenthesis">(</span><span xq="yes" start="35" prev-is-closed="false" class="variable">$display:XQDOC_COLLECTION</span><span xq="yes" start="60" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="61" prev-is-closed="true" class="step">/</span><span xq="yes" start="62" prev-is-closed="false" class="qname">xq:xqdoc</span><span xq="yes" start="70" prev-is-closed="true" class="step">/</span><span xq="yes" start="71" prev-is-closed="false" class="qname">xq:module</span><span xq="yes" start="80" prev-is-closed="true" class="filter">[</span><span xq="yes" start="81" prev-is-closed="false" class="axis">@</span><span xq="yes" start="82" prev-is-closed="false" class="qname">type</span><span xq="yes" start="86" prev-is-closed="true" class="op">=</span><span class="op">"</span><span class="literal" pos="194" xq="yes">library</span><span class="op">"</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="filter">]</span><span xq="yes" start="2" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="3" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="4" prev-is-closed="true" class="whitespace"> </span><span xq="yes" start="5" prev-is-closed="true" class="op">then</span><span xq="yes" start="9" prev-is-closed="false" class="whitespace">&#xD;
      </span><span xq="yes" start="17" prev-is-closed="false" class="parenthesis">(</span><span pos="220" class="es">&lt;</span><span name="xml-open-tag" pos="221" class="en">h4</span><span name="x-tag-end" pos="223" class="z">&gt;</span><span pos="224" class="txt">Library Modules</span><span pos="239" class="sc">&lt;/</span><span name="xml-close-tag" pos="241" class="cl">h4</span><span name="x-tag-end" pos="243" class="z">&gt;</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="op">,</span><span xq="yes" start="2" prev-is-closed="false" class="whitespace">&#xD;
        </span><span pos="255" class="es">&lt;</span><span name="xml-open-tag" pos="256" class="en">br</span><span name="x-tag-end" pos="258" class="z">/&gt;</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="op">,</span><span pos="261" class="es">&lt;</span><span name="xml-open-tag" pos="262" class="en">br</span><span name="x-tag-end" pos="264" class="z">/&gt;</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="op">,</span><span xq="yes" start="2" prev-is-closed="false" class="whitespace">&#xD;
        </span><span xq="yes" start="12" prev-is-closed="false" class="higher">for</span><span xq="yes" start="15" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="16" prev-is-closed="false" class="variable">$x</span><span xq="yes" start="18" prev-is-closed="true" class="whitespace"> </span><span xq="yes" start="19" prev-is-closed="true" class="op">in</span><span xq="yes" start="21" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="22" prev-is-closed="false" class="function">fn:collection</span><span class="parenthesis">(</span><span xq="yes" start="36" prev-is-closed="false" class="variable">$display:XQDOC_COLLECTION</span><span xq="yes" start="61" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="62" prev-is-closed="true" class="step">/</span><span xq="yes" start="63" prev-is-closed="false" class="qname">xq:xqdoc</span><span xq="yes" start="71" prev-is-closed="true" class="filter">[</span><span xq="yes" start="72" prev-is-closed="false" class="qname">xq:module</span><span xq="yes" start="81" prev-is-closed="true" class="step">/</span><span xq="yes" start="82" prev-is-closed="false" class="axis">@</span><span xq="yes" start="83" prev-is-closed="false" class="qname">type</span><span xq="yes" start="87" prev-is-closed="true" class="op">=</span><span class="op">"</span><span class="literal" pos="353" xq="yes">library</span><span class="op">"</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="filter">]</span><span xq="yes" start="2" prev-is-closed="true" class="whitespace">&#xD;
        </span><span xq="yes" start="12" prev-is-closed="true" class="type-op">order by</span><span xq="yes" start="20" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="21" prev-is-closed="false" class="variable">$x</span><span xq="yes" start="23" prev-is-closed="true" class="step">/</span><span xq="yes" start="24" prev-is-closed="false" class="qname">xq:module</span><span xq="yes" start="33" prev-is-closed="true" class="step">/</span><span xq="yes" start="34" prev-is-closed="false" class="qname">xq:uri</span><span xq="yes" start="40" prev-is-closed="true" class="whitespace">&#xD;
        </span><span xq="yes" start="50" prev-is-closed="true" class="op">return</span><span xq="yes" start="56" prev-is-closed="false" class="whitespace">&#xD;
         </span><span xq="yes" start="67" prev-is-closed="false" class="parenthesis">(</span><span xq="yes" start="68" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="69" prev-is-closed="false" class="function">display:build-link</span><span class="parenthesis">(</span><span class="op">"</span><span class="literal" pos="449" xq="yes">get-module</span><span class="op">"</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="op">,</span><span xq="yes" start="2" prev-is-closed="false" class="whitespace">&#xD;
                              </span><span xq="yes" start="34" prev-is-closed="false" class="variable">$local</span><span xq="yes" start="40" prev-is-closed="true" class="op">,</span><span xq="yes" start="41" prev-is-closed="false" class="whitespace"> &#xD;
                              </span><span xq="yes" start="74" prev-is-closed="false" class="parenthesis">(</span><span xq="yes" start="75" prev-is-closed="false" class="function">fn:string</span><span class="parenthesis">(</span><span xq="yes" start="85" prev-is-closed="false" class="variable">$x</span><span xq="yes" start="87" prev-is-closed="true" class="step">/</span><span xq="yes" start="88" prev-is-closed="false" class="qname">xq:module</span><span xq="yes" start="97" prev-is-closed="true" class="step">/</span><span xq="yes" start="98" prev-is-closed="false" class="qname">xq:uri</span><span xq="yes" start="104" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="105" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="106" prev-is-closed="true" class="op">,</span><span xq="yes" start="107" prev-is-closed="false" class="whitespace">&#xD;
                               </span><span xq="yes" start="140" prev-is-closed="false" class="function">display:decode-uri</span><span class="parenthesis">(</span><span xq="yes" start="159" prev-is-closed="false" class="function">fn:string</span><span class="parenthesis">(</span><span xq="yes" start="169" prev-is-closed="false" class="variable">$x</span><span xq="yes" start="171" prev-is-closed="true" class="step">/</span><span xq="yes" start="172" prev-is-closed="false" class="qname">xq:module</span><span xq="yes" start="181" prev-is-closed="true" class="step">/</span><span xq="yes" start="182" prev-is-closed="false" class="qname">xq:uri</span><span xq="yes" start="188" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="189" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="190" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="191" prev-is-closed="true" class="op">,</span><span xq="yes" start="192" prev-is-closed="false" class="whitespace">&#xD;
           </span><span pos="665" class="es">&lt;</span><span name="xml-open-tag" pos="666" class="en">br</span><span name="x-tag-end" pos="668" class="z">/&gt;</span><span xq="yes" start="1" prev-is-closed="true" class="whitespace"> </span><span xq="yes" start="2" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="3" prev-is-closed="true" class="whitespace">&#xD;
        </span><span xq="yes" start="13" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="14" prev-is-closed="true" class="whitespace">           &#xD;
    </span><span xq="yes" start="31" prev-is-closed="true" class="op">else</span><span xq="yes" start="35" prev-is-closed="false" class="whitespace">&#xD;
      </span><span xq="yes" start="43" prev-is-closed="false" class="parenthesis">(</span><span xq="yes" start="44" prev-is-closed="false" class="parenthesis">)</span><span xq="yes" start="45" prev-is-closed="true" class="whitespace">&#xD;
    </span><span name="unnested-xquery" pos="720" class="op">}</span><span name="resume-x-literal-txt" pos="721" class="txt">&#xD;
    </span><span name="nested-query" pos="727" class="op">{</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="whitespace">&#xD;
    </span><span xq="yes" start="7" prev-is-closed="true" class="if">if</span><span xq="yes" start="9" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="10" prev-is-closed="false" class="parenthesis">(</span><span xq="yes" start="11" prev-is-closed="false" class="function">fn:exists</span><span class="parenthesis">(</span><span xq="yes" start="21" prev-is-closed="false" class="function">fn:collection</span><span class="parenthesis">(</span><span xq="yes" start="35" prev-is-closed="false" class="variable">$display:XQDOC_COLLECTION</span><span xq="yes" start="60" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="61" prev-is-closed="true" class="step">/</span><span xq="yes" start="62" prev-is-closed="false" class="qname">xq:xqdoc</span><span xq="yes" start="70" prev-is-closed="true" class="step">/</span><span xq="yes" start="71" prev-is-closed="false" class="qname">xq:module</span><span xq="yes" start="80" prev-is-closed="true" class="filter">[</span><span xq="yes" start="81" prev-is-closed="false" class="axis">@</span><span xq="yes" start="82" prev-is-closed="false" class="qname">type</span><span xq="yes" start="86" prev-is-closed="true" class="op">=</span><span class="op">"</span><span class="literal" pos="814" xq="yes">main</span><span class="op">"</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="filter">]</span><span xq="yes" start="2" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="3" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="4" prev-is-closed="true" class="whitespace"> </span><span xq="yes" start="5" prev-is-closed="true" class="op">then</span><span xq="yes" start="9" prev-is-closed="false" class="whitespace">&#xD;
      </span><span xq="yes" start="17" prev-is-closed="false" class="parenthesis">(</span><span pos="837" class="es">&lt;</span><span name="xml-open-tag" pos="838" class="en">h4</span><span name="x-tag-end" pos="840" class="z">&gt;</span><span pos="841" class="txt">Main Modules</span><span pos="853" class="sc">&lt;/</span><span name="xml-close-tag" pos="855" class="cl">h4</span><span name="x-tag-end" pos="857" class="z">&gt;</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="op">,</span><span xq="yes" start="2" prev-is-closed="false" class="whitespace">&#xD;
        </span><span pos="869" class="es">&lt;</span><span name="xml-open-tag" pos="870" class="en">br</span><span name="x-tag-end" pos="872" class="z">/&gt;</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="op">,</span><span pos="875" class="es">&lt;</span><span name="xml-open-tag" pos="876" class="en">br</span><span name="x-tag-end" pos="878" class="z">/&gt;</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="op">,</span><span xq="yes" start="2" prev-is-closed="false" class="whitespace">&#xD;
        </span><span xq="yes" start="12" prev-is-closed="false" class="higher">for</span><span xq="yes" start="15" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="16" prev-is-closed="false" class="variable">$x</span><span xq="yes" start="18" prev-is-closed="true" class="whitespace"> </span><span xq="yes" start="19" prev-is-closed="true" class="op">in</span><span xq="yes" start="21" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="22" prev-is-closed="false" class="function">fn:collection</span><span class="parenthesis">(</span><span xq="yes" start="36" prev-is-closed="false" class="variable">$display:XQDOC_COLLECTION</span><span xq="yes" start="61" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="62" prev-is-closed="true" class="step">/</span><span xq="yes" start="63" prev-is-closed="false" class="qname">xq:xqdoc</span><span xq="yes" start="71" prev-is-closed="true" class="filter">[</span><span xq="yes" start="72" prev-is-closed="false" class="qname">xq:module</span><span xq="yes" start="81" prev-is-closed="true" class="step">/</span><span xq="yes" start="82" prev-is-closed="false" class="axis">@</span><span xq="yes" start="83" prev-is-closed="false" class="qname">type</span><span xq="yes" start="87" prev-is-closed="true" class="op">=</span><span class="op">"</span><span class="literal" pos="967" xq="yes">main</span><span class="op">"</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="filter">]</span><span xq="yes" start="2" prev-is-closed="true" class="whitespace">&#xD;
        </span><span xq="yes" start="12" prev-is-closed="true" class="type-op">order by</span><span xq="yes" start="20" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="21" prev-is-closed="false" class="qname">and</span><span xq="yes" start="24" prev-is-closed="true" class="whitespace"> </span><span xq="yes" start="25" prev-is-closed="true" class="step">/</span><span xq="yes" start="26" prev-is-closed="false" class="qname">xq:module</span><span xq="yes" start="35" prev-is-closed="true" class="step">/</span><span xq="yes" start="36" prev-is-closed="false" class="qname">xq:uri</span><span xq="yes" start="42" prev-is-closed="true" class="whitespace">&#xD;
        </span><span xq="yes" start="52" prev-is-closed="true" class="op">return</span><span xq="yes" start="58" prev-is-closed="false" class="whitespace">&#xD;
         </span><span xq="yes" start="69" prev-is-closed="false" class="parenthesis">(</span><span xq="yes" start="70" prev-is-closed="false" class="whitespace"> </span><span xq="yes" start="71" prev-is-closed="false" class="function">display:build-link</span><span class="parenthesis">(</span><span class="op">"</span><span class="literal" pos="1062" xq="yes">get-module</span><span class="op">"</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="op">,</span><span xq="yes" start="2" prev-is-closed="false" class="whitespace">&#xD;
                               </span><span xq="yes" start="35" prev-is-closed="false" class="variable">$local</span><span xq="yes" start="41" prev-is-closed="true" class="op">,</span><span xq="yes" start="42" prev-is-closed="false" class="whitespace"> &#xD;
                               </span><span xq="yes" start="76" prev-is-closed="false" class="parenthesis">(</span><span xq="yes" start="77" prev-is-closed="false" class="function">fn:string</span><span class="parenthesis">(</span><span xq="yes" start="87" prev-is-closed="false" class="variable">$x</span><span xq="yes" start="89" prev-is-closed="true" class="step">/</span><span xq="yes" start="90" prev-is-closed="false" class="qname">xq:module</span><span xq="yes" start="99" prev-is-closed="true" class="step">/</span><span xq="yes" start="100" prev-is-closed="false" class="qname">xq:uri</span><span xq="yes" start="106" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="107" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="108" prev-is-closed="true" class="op">,</span><span xq="yes" start="109" prev-is-closed="false" class="whitespace">&#xD;
                                </span><span xq="yes" start="143" prev-is-closed="false" class="function">display:decode-uri</span><span class="parenthesis">(</span><span xq="yes" start="162" prev-is-closed="false" class="function">xs:string</span><span class="parenthesis">(</span><span xq="yes" start="172" prev-is-closed="false" class="variable">$x</span><span xq="yes" start="174" prev-is-closed="true" class="step">/</span><span xq="yes" start="175" prev-is-closed="false" class="qname">xq:module</span><span xq="yes" start="184" prev-is-closed="true" class="step">/</span><span xq="yes" start="185" prev-is-closed="false" class="qname">xq:uri</span><span xq="yes" start="191" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="192" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="193" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="194" prev-is-closed="true" class="op">,</span><span xq="yes" start="195" prev-is-closed="false" class="whitespace">&#xD;
           </span><span pos="1281" class="es">&lt;</span><span name="xml-open-tag" pos="1282" class="en">br</span><span name="x-tag-end" pos="1284" class="z">/&gt;</span><span xq="yes" start="1" prev-is-closed="true" class="whitespace"> </span><span xq="yes" start="2" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="3" prev-is-closed="true" class="whitespace">&#xD;
      </span><span xq="yes" start="11" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="12" prev-is-closed="true" class="whitespace">&#xD;
    </span><span xq="yes" start="18" prev-is-closed="true" class="op">else</span><span xq="yes" start="22" prev-is-closed="false" class="whitespace">&#xD;
      </span><span xq="yes" start="30" prev-is-closed="false" class="parenthesis">(</span><span xq="yes" start="31" prev-is-closed="false" class="parenthesis">)</span><span xq="yes" start="32" prev-is-closed="true" class="whitespace">&#xD;
    </span><span name="unnested-xquery" pos="1323" class="op">}</span><span name="resume-x-literal-txt" pos="1324" class="txt">&#xD;
    </span><span pos="1330" class="sc">&lt;/</span><span name="xml-close-tag" pos="1332" class="cl">div</span><span name="x-tag-end" pos="1335" class="z">&gt;</span><span class="open"></span><span xq="yes" start="1" prev-is-closed="true" class="parenthesis">)</span><span xq="yes" start="2" prev-is-closed="true" class="whitespace">&#xD;
</span><span xq="yes" start="4" prev-is-closed="true" class="op">}</span><span xq="yes" start="5" prev-is-closed="true" class="op">;</span></pre></div></body></html>