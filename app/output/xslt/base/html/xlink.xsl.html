<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>xlink.xsl</title><link rel="stylesheet" type="text/css" href="../../../theme.css"></head><body><div><p class="spectrum"><span class="z">&lt;?</span><span class="pi">xml version="1.0" encoding="utf-8"</span><span class="z">?&gt;</span><span class="txt">
</span><span class="ww" id="w5"><span class="es">&lt;</span><a class="solar" href="../../../index.html"><span class="enxsl" id="e?{http://www.w3.org/1999/XSL/Transform}stylesheet">xsl:stylesheet</span></a><span class="z"> </span><span class="atn">xmlns:xsl</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/1999/XSL/Transform</span><span class="z">"</span><span class="z">
                </span><span class="atn">xmlns</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/1999/xhtml</span><span class="z">"</span><span class="z">
                </span><span class="atn">xmlns:db</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook</span><span class="z">"</span><span class="z">
                </span><span class="atn">xmlns:doc</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://nwalsh.com/xsl/documentation/1.0</span><span class="z">"</span><span class="z">
                </span><span class="atn">xmlns:f</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/extension</span><span class="z">"</span><span class="z">
                </span><span class="atn">xmlns:fn</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/2005/xpath-functions</span><span class="z">"</span><span class="z">
                </span><span class="atn">xmlns:h</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/1999/xhtml</span><span class="z">"</span><span class="z">
                </span><span class="atn">xmlns:m</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/mode</span><span class="z">"</span><span class="z">
                </span><span class="atn">xmlns:t</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/template</span><span class="z">"</span><span class="z">
                </span><span class="atn">xmlns:tp</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/template/private</span><span class="z">"</span><span class="z">
                </span><span class="atn">xmlns:u</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://nwalsh.com/xsl/unittests#</span><span class="z">"</span><span class="z">
                </span><span class="atn">xmlns:xlink</span><span class="atneq">=</span><span class="z">'</span><span class="av">http://www.w3.org/1999/xlink</span><span class="z">'</span><span class="z">
                </span><span class="atn">xmlns:xs</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/2001/XMLSchema</span><span class="z">"</span><span class="z">
                </span><span class="atn">exclude-result-prefixes</span><span class="atneq">=</span><span class="z">"</span><span class="av">db doc f fn h m t tp u xlink xs</span><span class="z">"</span><span class="z">
                </span><span class="atn">version</span><span class="atneq">=</span><span class="z">"</span><span class="av">2.0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  
  </span><span class="z">&lt;!--</span><span class="cm"> ============================================================ </span><span class="z">--&gt;</span><span class="txt">
  
  </span><span class="ww" id="w103"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}xlink">t:xlink</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w113"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?content">content</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="parenthesis" start="1" pair-end="2" select="quick">(</span><span class="parenthesis" start="2">)</span><span class="z">"</span><span id="wx128" class="sc">/&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w130"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w134"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xlink:type</span><span class="whitespace" start="12"> </span><span class="op" start="13">=</span><span class="whitespace" start="14"> </span><span class="op">'</span><span class="literal" start="15">extended</span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w151"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="../../../xslt/base/html/xlink.xsl.html#t?{http://docbook.org/xslt/ns/template}extended-xlink" class="solar"><span class="tcall">t:extended-xlink</span></a><span class="z">"</span><span id="wx159" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx163" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ww" id="w165"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xlink:type</span><span class="whitespace" start="12"> </span><span class="op" start="13">=</span><span class="whitespace" start="14"> </span><span class="op">'</span><span class="literal" start="15">simple</span><span class="op">'</span><span class="whitespace" start="23"> </span><span class="op" start="24">or</span><span class="whitespace" start="26"> </span><span class="axis" start="27">@</span><span class="qname" start="28" select="quick">xlink:href</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w187"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="../../../xslt/base/html/xlink.xsl.html#t?{http://docbook.org/xslt/ns/template}simple-xlink" class="solar"><span class="tcall">t:simple-xlink</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="ww" id="w197"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">content</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
            </span><span class="ww" id="w207"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
              </span><span class="ww" id="w211"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="type" start="1">empty</span><span class="parenthesis">(</span><span class="variable" start="7" select="quick">$content</span><span class="parenthesis" start="15">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
                </span><span class="ww" id="w224"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span id="wx226" class="sc">/&gt;</span></span><span class="txt">
              </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx230" class="ec">&gt;</span></span><span class="txt">
              </span><span class="ww" id="w232"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
                </span><span class="ww" id="w236"><span class="es">&lt;</span><span class="enxsl">xsl:sequence</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$content</span><span class="z">"</span><span id="wx244" class="sc">/&gt;</span></span><span class="txt">
              </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx248" class="ec">&gt;</span></span><span class="txt">
            </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx252" class="ec">&gt;</span></span><span class="txt">
          </span><span class="ez">&lt;/</span><span class="clxsl">xsl:with-param</span><span id="wx256" class="ec">&gt;</span></span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx260" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx264" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ww" id="w266"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="z">&lt;!--</span><span class="cm"> It's just a normal, unlinked element </span><span class="z">--&gt;</span><span class="txt">
        </span><span class="ww" id="w274"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="ww" id="w278"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="type" start="1">empty</span><span class="parenthesis">(</span><span class="variable" start="7" select="quick">$content</span><span class="parenthesis" start="15">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
            </span><span class="ww" id="w291"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span id="wx293" class="sc">/&gt;</span></span><span class="txt">
          </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx297" class="ec">&gt;</span></span><span class="txt">
          </span><span class="ww" id="w299"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
            </span><span class="ww" id="w303"><span class="es">&lt;</span><span class="enxsl">xsl:sequence</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$content</span><span class="z">"</span><span id="wx311" class="sc">/&gt;</span></span><span class="txt">
          </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx315" class="ec">&gt;</span></span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx319" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx323" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx327" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx331" class="ec">&gt;</span></span><span class="txt">
  
  </span><span class="z">&lt;!--</span><span class="cm"> ============================================================ </span><span class="z">--&gt;</span><span class="txt">
  
  </span><span class="ww" id="w337"><span class="es">&lt;</span><span class="en">doc:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">t:simple-xlink</span><span class="z">"</span><span class="z"> </span><span class="atn">xmlns</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w353"><span class="es">&lt;</span><span class="en">refpurpose</span><span class="scx">&gt;</span><span class="txt">Handle xlink:href attributes on inlines</span><span class="ez">&lt;/</span><span class="cl">refpurpose</span><span id="wx359" class="ec">&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w361"><span class="es">&lt;</span><span class="en">refdescription</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w365"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">This template generates XHTML anchors for inline elements that
      have xlink:href attributes.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx371" class="ec">&gt;</span></span><span class="txt">
      
      </span><span class="ww" id="w373"><span class="es">&lt;</span><span class="en">note</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w377"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">Nested anchors can occur this way and this code does not, at
        present, “unwrap” them as it should.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx383" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">note</span><span id="wx387" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="cl">refdescription</span><span id="wx391" class="ec">&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w393"><span class="es">&lt;</span><span class="en">refparameter</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w397"><span class="es">&lt;</span><span class="en">variablelist</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w401"><span class="es">&lt;</span><span class="en">varlistentry</span><span class="scx">&gt;</span><span class="txt"></span><span class="ww" id="w405"><span class="es">&lt;</span><span class="en">term</span><span class="scx">&gt;</span><span class="txt">content</span><span class="ez">&lt;/</span><span class="cl">term</span><span id="wx411" class="ec">&gt;</span></span><span class="txt">
          </span><span class="ww" id="w413"><span class="es">&lt;</span><span class="en">listitem</span><span class="scx">&gt;</span><span class="txt">
            </span><span class="ww" id="w417"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">The content of the link. This defaults to the result of
            calling “apply templates”.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx423" class="ec">&gt;</span></span><span class="txt">
          </span><span class="ez">&lt;/</span><span class="cl">listitem</span><span id="wx427" class="ec">&gt;</span></span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="cl">varlistentry</span><span id="wx431" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">variablelist</span><span id="wx435" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="cl">refparameter</span><span id="wx439" class="ec">&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w441"><span class="es">&lt;</span><span class="en">refreturn</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w445"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">The result tree markup for the context node.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx451" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="cl">refreturn</span><span id="wx455" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="cl">doc:template</span><span id="wx459" class="ec">&gt;</span></span><span class="txt">
  
  </span><span class="ww" id="w461"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}simple-xlink">t:simple-xlink</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w471"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?content">content</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w481"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span id="wx483" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:param</span><span id="wx487" class="ec">&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w489"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?link">link</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w499"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w503"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xlink:href</span><span class="whitespace" start="12">
                        </span><span class="op" start="21">and</span><span class="whitespace" start="24"> </span><span class="parenthesis" start="25" pair-end="79" select="quick">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="26" pair-end="41" select="quick">not</span></a><span class="parenthesis">(</span><span class="axis" start="30">@</span><span class="qname" start="31" select="quick">xlink:type</span><span class="parenthesis" start="41">)</span><span class="whitespace" start="42">
                        </span><span class="op" start="56">or</span><span class="whitespace" start="58"> </span><span class="axis" start="59">@</span><span class="qname" start="60" select="quick">xlink:type</span><span class="op" start="70">=</span><span class="op">'</span><span class="literal" start="71">simple</span><span class="op">'</span><span class="parenthesis" start="79">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="ww" id="w533"><span class="es">&lt;</span><span class="en">a</span><span class="scx">&gt;</span><span class="txt">
            </span><span class="ww" id="w537"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xlink.title</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
              </span><span class="ww" id="w548"><span class="es">&lt;</span><span class="enxsl">xsl:attribute</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xlink:title</span><span class="z">"</span><span id="wx563" class="sc">/&gt;</span></span><span class="txt">
            </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx567" class="ec">&gt;</span></span><span class="txt">
            
            </span><span class="ww" id="w569"><span class="es">&lt;</span><span class="enxsl">xsl:attribute</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">href</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
              </span><span class="ww" id="w579"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
                </span><span class="z">&lt;!--</span><span class="cm"> if the href starts with # and does not contain an "(" </span><span class="z">--&gt;</span><span class="txt">
                </span><span class="z">&lt;!--</span><span class="cm"> or if the href starts with #xpointer(id(, it's just an ID </span><span class="z">--&gt;</span><span class="txt">
                </span><span class="ww" id="w591"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-starts-with" class="solar"><span class="function" start="1" pair-end="28" select="quick">starts-with</span></a><span class="parenthesis">(</span><span class="axis" start="13">@</span><span class="qname" start="14" select="quick">xlink:href</span><span class="op" start="24">,</span><span class="op">'</span><span class="literal" start="25">#</span><span class="op">'</span><span class="parenthesis" start="28">)</span><span class="whitespace" start="29">
                                </span><span class="op" start="60">and</span><span class="whitespace" start="63"> </span><span class="parenthesis" start="64" pair-end="206" select="quick">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="65" pair-end="98" select="quick">not</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-contains" class="solar"><span class="function" start="69" pair-end="97" select="quick">contains</span></a><span class="parenthesis">(</span><span class="axis" start="78">@</span><span class="qname" start="79" select="quick">xlink:href</span><span class="op" start="89">,</span><span class="op">'</span><span class="literal" start="90">&amp;#40;</span><span class="op">'</span><span class="parenthesis" start="97">)</span><span class="parenthesis" start="98">)</span><span class="whitespace" start="99">
                                </span><span class="op" start="130">or</span><span class="whitespace" start="132"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-starts-with" class="solar"><span class="function" start="133" pair-end="205" select="quick">starts-with</span></a><span class="parenthesis">(</span><span class="axis" start="145">@</span><span class="qname" start="146" select="quick">xlink:href</span><span class="op" start="156">,</span><span class="whitespace" start="157">
                                </span><span class="op">'</span><span class="literal" start="182">#xpointer&amp;#40;id&amp;#40;</span><span class="op">'</span><span class="parenthesis" start="205">)</span><span class="parenthesis" start="206">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
                  </span><span class="ww" id="w639"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?idref">idref</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="../../../xslt/base/common/functions.xsl.html#f?{http://docbook.org/xslt/ns/extension}xpointer-idref" class="solar"><span class="function" start="1" pair-end="29" select="quick">f:xpointer-idref</span></a><span class="parenthesis">(</span><span class="axis" start="18">@</span><span class="qname" start="19" select="quick">xlink:href</span><span class="parenthesis" start="29">)</span><span class="z">"</span><span id="wx657" class="sc">/&gt;</span></span><span class="txt">
                  </span><span class="ww" id="w659"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target">target</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="16" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">id</span><span class="op">'</span><span class="op" start="9">,</span><span class="variable" start="10" select="quick">$idref</span><span class="parenthesis" start="16">)</span><span class="filter" start="17" pair-end="19" select="quick">[</span><span class="numeric" start="18">1</span><span class="filter" start="19">]</span><span class="z">"</span><span id="wx683" class="sc">/&gt;</span></span><span class="txt">
                  
                  </span><span class="ww" id="w685"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
                    </span><span class="ww" id="w689"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="1" pair-end="12" select="quick">not</span></a><span class="parenthesis">(</span><span class="variable" start="5" select="quick">$target</span><span class="parenthesis" start="12">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
                      </span><span class="ww" id="w702"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
                        </span><span class="ww" id="w706"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">XLink to nonexistent id: </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx712" class="ec">&gt;</span></span><span class="txt">
                        </span><span class="ww" id="w714"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$idref</span><span class="z">"</span><span id="wx722" class="sc">/&gt;</span></span><span class="txt">
                      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx726" class="ec">&gt;</span></span><span class="txt">
                      </span><span class="ww" id="w728"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">???</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx734" class="ec">&gt;</span></span><span class="txt">
                    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx738" class="ec">&gt;</span></span><span class="txt">
                    </span><span class="ww" id="w740"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
                      </span><span class="ww" id="w744"><span class="es">&lt;</span><span class="enxsl">xsl:attribute</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">href</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="../../../xslt/base/html/html.xsl.html#f?{http://docbook.org/xslt/ns/extension}href" class="solar"><span class="function" start="1" pair-end="17" select="quick">f:href</span></a><span class="parenthesis">(</span><span class="step" start="8">/</span><span class="op" start="9">,</span><span class="variable" start="10" select="quick">$target</span><span class="parenthesis" start="17">)</span><span class="z">"</span><span id="wx763" class="sc">/&gt;</span></span><span class="txt">
                    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx767" class="ec">&gt;</span></span><span class="txt">
                  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx771" class="ec">&gt;</span></span><span class="txt">
                </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx775" class="ec">&gt;</span></span><span class="txt">
                
                </span><span class="z">&lt;!--</span><span class="cm"> otherwise it's a URI </span><span class="z">--&gt;</span><span class="txt">
                </span><span class="ww" id="w781"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
                  </span><span class="ww" id="w785"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xlink:href</span><span class="z">"</span><span id="wx794" class="sc">/&gt;</span></span><span class="txt">
                </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx798" class="ec">&gt;</span></span><span class="txt">
              </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx802" class="ec">&gt;</span></span><span class="txt">
            </span><span class="ez">&lt;/</span><span class="clxsl">xsl:attribute</span><span id="wx806" class="ec">&gt;</span></span><span class="txt">
            </span><span class="ww" id="w808"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$content</span><span class="z">"</span><span id="wx816" class="sc">/&gt;</span></span><span class="txt">
          </span><span class="ez">&lt;/</span><span class="cl">a</span><span id="wx820" class="ec">&gt;</span></span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx824" class="ec">&gt;</span></span><span class="txt">
        </span><span class="ww" id="w826"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="ww" id="w830"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$content</span><span class="z">"</span><span id="wx838" class="sc">/&gt;</span></span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx842" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx846" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx850" class="ec">&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w852"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$link</span><span class="z">"</span><span id="wx860" class="sc">/&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w862"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?inline">inline</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span id="wx876" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ww" id="w878"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?id">id</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xml:id</span><span class="z">"</span><span id="wx893" class="sc">/&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w895"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?annotations">annotations</span><span class="z">"</span><span class="z"> </span><span class="atn">as</span><span class="atneq">=</span><span class="z">"</span><span class="av">element()*</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w911"><span class="es">&lt;</span><span class="enxsl">xsl:sequence</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="if" start="1">if</span><span class="whitespace" start="3"> </span><span class="parenthesis" start="4" pair-end="17" select="quick">(</span><span class="axis" start="5">@</span><span class="qname" start="6" select="quick">annotations</span><span class="parenthesis" start="17">)</span><span class="whitespace" start="18">
                            </span><span class="op" start="45">then</span><span class="whitespace" start="49"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="50" pair-end="86" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="54">id</span><span class="op">'</span><span class="op" start="58">,</span><a href="http://www.w3.org/TR/xpath-functions/#func-tokenize" class="solar"><span class="function" start="59" pair-end="85" select="quick">tokenize</span></a><span class="parenthesis">(</span><span class="axis" start="68">@</span><span class="qname" start="69" select="quick">annotations</span><span class="op" start="80">,</span><span class="op">'</span><span class="literal" start="81">\s</span><span class="op">'</span><span class="parenthesis" start="85">)</span><span class="parenthesis" start="86">)</span><span class="whitespace" start="87">
                            </span><span class="op" start="93">else</span><span class="whitespace" start="97"> </span><span class="parenthesis" start="98" pair-end="99" select="quick">(</span><span class="parenthesis" start="99">)</span><span class="z">"</span><span id="wx948" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ww" id="w950"><span class="es">&lt;</span><span class="enxsl">xsl:sequence</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="if" start="1">if</span><span class="whitespace" start="3"> </span><span class="parenthesis" start="4" pair-end="8" select="quick">(</span><span class="variable" start="5" select="quick">$id</span><span class="parenthesis" start="8">)</span><span class="whitespace" start="9">
                            </span><span class="op" start="15">then</span><span class="whitespace" start="19"> </span><span class="step" start="20">//</span><span class="qname" start="22" select="quick">db:annotation</span><span class="filter" start="35" pair-end="65" select="quick">[</span><a href="http://www.w3.org/TR/xpath-functions/#func-tokenize" class="solar"><span class="function" start="36" pair-end="60" select="quick">tokenize</span></a><span class="parenthesis">(</span><span class="axis" start="45">@</span><span class="qname" start="46" select="quick">annotates</span><span class="op" start="55">,</span><span class="op">'</span><span class="literal" start="56">\s</span><span class="op">'</span><span class="parenthesis" start="60">)</span><span class="op" start="61">=</span><span class="variable" start="62" select="quick">$id</span><span class="filter" start="65">]</span><span class="whitespace" start="66">
                            </span><span class="op" start="72">else</span><span class="whitespace" start="76"> </span><span class="parenthesis" start="77" pair-end="78" select="quick">(</span><span class="parenthesis" start="78">)</span><span class="z">"</span><span id="wx985" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx989" class="ec">&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w991"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$annotations</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w1001"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?id">id</span><span class="z">"</span><span class="z">
                    </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-concat" class="solar"><span class="function" start="1" pair-end="45" select="quick">concat</span></a><span class="parenthesis">(</span><a href="../../../xslt/base/common/functions.xsl.html#f?{http://docbook.org/xslt/ns/extension}node-id" class="solar"><span class="function" start="8" pair-end="19" select="quick">f:node-id</span></a><span class="parenthesis">(</span><span class="context" start="18">.</span><span class="parenthesis" start="19">)</span><span class="op" start="20">,</span><span class="op">'</span><span class="literal" start="21">-</span><span class="op">'</span><span class="op" start="24">,</span><a href="http://www.w3.org/TR/xpath-functions/#func-generate-id" class="solar"><span class="function" start="25" pair-end="44" select="quick">generate-id</span></a><span class="parenthesis">(</span><span class="variable" start="37" select="quick">$inline</span><span class="parenthesis" start="44">)</span><span class="parenthesis" start="45">)</span><span class="z">"</span><span id="wx1030" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ww" id="w1032"><span class="es">&lt;</span><span class="en">a</span><span class="z"> </span><span class="atn">style</span><span class="atneq">=</span><span class="z">"</span><span class="av">display: inline</span><span class="z">"</span><span class="z"> </span><span class="atn">onclick</span><span class="atneq">=</span><span class="z">"</span><span class="av">show_annotation('</span><span class="op">{</span><span class="variable" start="1" select="quick">$id</span><span class="op">}</span><span class="av">')</span><span class="z">"</span><span class="z">
         </span><span class="atn">id</span><span class="atneq">=</span><span class="z">"</span><span class="av">annot-</span><span class="op">{</span><span class="variable" start="1" select="quick">$id</span><span class="op">}</span><span class="av">-on</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w1062"><span class="es">&lt;</span><span class="en">img</span><span class="z"> </span><span class="atn">border</span><span class="atneq">=</span><span class="z">"</span><span class="av">0</span><span class="z">"</span><span class="z"> </span><span class="atn">src</span><span class="atneq">=</span><span class="z">"</span><span class="op">{</span><a href="../../../xslt/base/html/param.xsl.html#v?annotation.graphic.open" class="solar"><span class="variable" start="1" select="quick">$annotation.graphic.open</span></a><span class="op">}</span><span class="z">"</span><span class="z"> </span><span class="atn">alt</span><span class="atneq">=</span><span class="z">"</span><span class="av">[A+]</span><span class="z">"</span><span id="wx1084" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">a</span><span id="wx1088" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ww" id="w1090"><span class="es">&lt;</span><span class="en">a</span><span class="z"> </span><span class="atn">style</span><span class="atneq">=</span><span class="z">"</span><span class="av">display: none</span><span class="z">"</span><span class="z"> </span><span class="atn">onclick</span><span class="atneq">=</span><span class="z">"</span><span class="av">hide_annotation('</span><span class="op">{</span><span class="variable" start="1" select="quick">$id</span><span class="op">}</span><span class="av">')</span><span class="z">"</span><span class="z">
         </span><span class="atn">id</span><span class="atneq">=</span><span class="z">"</span><span class="av">annot-</span><span class="op">{</span><span class="variable" start="1" select="quick">$id</span><span class="op">}</span><span class="av">-off</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w1120"><span class="es">&lt;</span><span class="en">img</span><span class="z"> </span><span class="atn">border</span><span class="atneq">=</span><span class="z">"</span><span class="av">0</span><span class="z">"</span><span class="z"> </span><span class="atn">src</span><span class="atneq">=</span><span class="z">"</span><span class="op">{</span><a href="../../../xslt/base/html/param.xsl.html#v?annotation.graphic.close" class="solar"><span class="variable" start="1" select="quick">$annotation.graphic.close</span></a><span class="op">}</span><span class="z">"</span><span class="z"> </span><span class="atn">alt</span><span class="atneq">=</span><span class="z">"</span><span class="av">[A-]</span><span class="z">"</span><span id="wx1142" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">a</span><span id="wx1146" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ww" id="w1148"><span class="es">&lt;</span><span class="en">div</span><span class="z"> </span><span class="atn">style</span><span class="atneq">=</span><span class="z">"</span><span class="av">display: none</span><span class="z">"</span><span class="z"> </span><span class="atn">id</span><span class="atneq">=</span><span class="z">"</span><span class="av">annot-</span><span class="op">{</span><span class="variable" start="1" select="quick">$id</span><span class="op">}</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w1167"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:annotation</span><span class="z">"</span><span id="wx1181" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">div</span><span id="wx1185" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx1189" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx1193" class="ec">&gt;</span></span><span class="txt">
  
  </span><span class="z">&lt;!--</span><span class="cm"> ============================================================ </span><span class="z">--&gt;</span><span class="txt">
  
  </span><span class="ww" id="w1199"><span class="es">&lt;</span><span class="en">doc:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">t:extended-xlink</span><span class="z">"</span><span class="z"> </span><span class="atn">xmlns</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w1215"><span class="es">&lt;</span><span class="en">refpurpose</span><span class="scx">&gt;</span><span class="txt">Handle inline extended XLinks</span><span class="ez">&lt;/</span><span class="cl">refpurpose</span><span id="wx1221" class="ec">&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w1223"><span class="es">&lt;</span><span class="en">refdescription</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w1227"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">This template generates XHTML anchors for inline elements that
      are XLink extended links.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx1233" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="cl">refdescription</span><span id="wx1237" class="ec">&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w1239"><span class="es">&lt;</span><span class="en">refreturn</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w1243"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">The result tree markup for the context node.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx1249" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="cl">refreturn</span><span id="wx1253" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="cl">doc:template</span><span id="wx1257" class="ec">&gt;</span></span><span class="txt">
  
  </span><span class="z">&lt;!--</span><span class="cm">
  &lt;citetitle xlink:type="extended"&gt;
  &lt;link xlink:type="locator" xlink:href="http://docbook.org/" xlink:label="target"
  xlink:title="DocBook.org"/&gt;
  &lt;link xlink:type="locator" xlink:href="http://en.wikipedia.org/wiki/DocBook" xlink:label="target"
  xlink:title="DocBook on Wikipedia"/&gt;
  &lt;phrase xlink:type="resource" xlink:label="source"&gt;DocBook&lt;/phrase&gt;
  &lt;link xlink:type="arc" xlink:from="source" xlink:to="target"/&gt;
  &lt;/citetitle&gt;
  </span><span class="z">--&gt;</span><span class="txt">
  
  </span><span class="z">&lt;!--</span><span class="cm"> An "inline" extended link. Assume we have 1 resource and "n" locators. </span><span class="z">--&gt;</span><span class="txt">
  </span><span class="ww" id="w1267"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}extended-xlink">t:extended-xlink</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w1277"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?resource">resource</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">*</span><span class="filter" start="2" pair-end="25" select="quick">[</span><span class="axis" start="3">@</span><span class="qname" start="4" select="quick">xlink:type</span><span class="op" start="14">=</span><span class="op">'</span><span class="literal" start="15">resource</span><span class="op">'</span><span class="filter" start="25">]</span><span class="z">"</span><span id="wx1299" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ww" id="w1301"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?locator">locator</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">*</span><span class="filter" start="2" pair-end="24" select="quick">[</span><span class="axis" start="3">@</span><span class="qname" start="4" select="quick">xlink:type</span><span class="op" start="14">=</span><span class="op">'</span><span class="literal" start="15">locator</span><span class="op">'</span><span class="filter" start="24">]</span><span class="z">"</span><span id="wx1323" class="sc">/&gt;</span></span><span class="txt">
    
    </span><span class="ww" id="w1325"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w1329"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="type" start="1">empty</span><span class="parenthesis">(</span><span class="variable" start="7" select="quick">$resource</span><span class="parenthesis" start="16">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w1342"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="ww" id="w1346"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Warning: inline extended link with no resource</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1352" class="ec">&gt;</span></span><span class="txt">
          </span><span class="ww" id="w1354"><span class="es">&lt;</span><span class="enxsl">xsl:sequence</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span id="wx1362" class="sc">/&gt;</span></span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1366" class="ec">&gt;</span></span><span class="txt">
        </span><span class="ww" id="w1368"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span id="wx1370" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1374" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ww" id="w1376"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w1380"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-count" class="solar"><span class="function" start="1" pair-end="16" select="quick">count</span></a><span class="parenthesis">(</span><span class="variable" start="7" select="quick">$resource</span><span class="parenthesis" start="16">)</span><span class="whitespace" start="17"> </span><span class="qname" start="18" select="quick">&amp;</span><span class="op" start="19">gt</span><span class="qname" start="21" select="quick">;</span><span class="whitespace" start="22"> </span><span class="numeric" start="23">1</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="ww" id="w1399"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
            </span><span class="ww" id="w1403"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Warning: inline extended links are expected to have exactly one resource</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1409" class="ec">&gt;</span></span><span class="txt">
            </span><span class="ww" id="w1411"><span class="es">&lt;</span><span class="enxsl">xsl:sequence</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span id="wx1419" class="sc">/&gt;</span></span><span class="txt">
          </span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1423" class="ec">&gt;</span></span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1427" class="ec">&gt;</span></span><span class="txt">
        
        </span><span class="ww" id="w1429"><span class="es">&lt;</span><span class="en">span</span><span class="z"> </span><span class="atn">class</span><span class="atneq">=</span><span class="z">"</span><span class="av">nhrefs</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="ww" id="w1439"><span class="es">&lt;</span><span class="en">span</span><span class="z"> </span><span class="atn">class</span><span class="atneq">=</span><span class="z">"</span><span class="av">source</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
            </span><span class="ww" id="w1449"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$resource</span><span class="filter" start="10" pair-end="12" select="quick">[</span><span class="numeric" start="11">1</span><span class="filter" start="12">]</span><span class="z">"</span><span id="wx1460" class="sc">/&gt;</span></span><span class="txt">
          </span><span class="ez">&lt;/</span><span class="cl">span</span><span id="wx1464" class="ec">&gt;</span></span><span class="txt">
          
          </span><span class="ww" id="w1466"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?arcs">arcs</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">*</span><span class="filter" start="2" pair-end="62" select="quick">[</span><span class="axis" start="3">@</span><span class="qname" start="4" select="quick">xlink:type</span><span class="op" start="14">=</span><span class="op">'</span><span class="literal" start="15">arc</span><span class="op">'</span><span class="whitespace" start="20"> </span><span class="op" start="21">and</span><span class="whitespace" start="24"> </span><span class="axis" start="25">@</span><span class="qname" start="26" select="quick">xlink:from</span><span class="op" start="36">=</span><span class="variable" start="37" select="quick">$resource</span><span class="filter" start="46" pair-end="48" select="quick">[</span><span class="numeric" start="47">1</span><span class="filter" start="48">]</span><span class="step" start="49">/</span><span class="axis" start="50">@</span><span class="qname" start="51" select="quick">xlink:label</span><span class="filter" start="62">]</span><span class="z">"</span><span id="wx1501" class="sc">/&gt;</span></span><span class="txt">
          </span><span class="ww" id="w1503"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?to">to</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">*</span><span class="filter" start="2" pair-end="57" select="quick">[</span><span class="axis" start="3">@</span><span class="qname" start="4" select="quick">xlink:type</span><span class="op" start="14">=</span><span class="op">'</span><span class="literal" start="15">locator</span><span class="op">'</span><span class="whitespace" start="24"> </span><span class="op" start="25">and</span><span class="whitespace" start="28"> </span><span class="axis" start="29">@</span><span class="qname" start="30" select="quick">xlink:label</span><span class="op" start="41">=</span><span class="variable" start="42" select="quick">$arcs</span><span class="step" start="47">/</span><span class="axis" start="48">@</span><span class="qname" start="49" select="quick">xlink:to</span><span class="filter" start="57">]</span><span class="z">"</span><span id="wx1535" class="sc">/&gt;</span></span><span class="txt">
          
          </span><span class="ww" id="w1537"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$to</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
            </span><span class="ww" id="w1547"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt"> [</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1553" class="ec">&gt;</span></span><span class="txt">
            </span><span class="ww" id="w1555"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$to</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
              </span><span class="ww" id="w1565"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-position" class="solar"><span class="function" start="1" pair-end="10" select="quick">position</span></a><span class="parenthesis">(</span><span class="parenthesis" start="10">)</span><span class="whitespace" start="11"> </span><span class="qname" start="12" select="quick">&amp;</span><span class="op" start="13">gt</span><span class="qname" start="15" select="quick">;</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">1</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">, </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1585" class="ec">&gt;</span></span><span class="txt">
              </span><span class="ww" id="w1587"><span class="es">&lt;</span><span class="en">a</span><span class="z"> </span><span class="atn">href</span><span class="atneq">=</span><span class="z">"</span><span class="op">{</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xlink:href</span><span class="op">}</span><span class="z">"</span><span class="z"> </span><span class="atn">class</span><span class="atneq">=</span><span class="z">"</span><span class="av">arc</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
                </span><span class="ww" id="w1606"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
                  </span><span class="ww" id="w1610"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">*</span><span class="filter" start="2" pair-end="22" select="quick">[</span><span class="axis" start="3">@</span><span class="qname" start="4" select="quick">xlink:type</span><span class="op" start="14">=</span><span class="op">'</span><span class="literal" start="15">title</span><span class="op">'</span><span class="filter" start="22">]</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
                    </span><span class="ww" id="w1628"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">*</span><span class="filter" start="2" pair-end="22" select="quick">[</span><span class="axis" start="3">@</span><span class="qname" start="4" select="quick">xlink:type</span><span class="op" start="14">=</span><span class="op">'</span><span class="literal" start="15">title</span><span class="op">'</span><span class="filter" start="22">]</span><span class="filter" start="23" pair-end="25" select="quick">[</span><span class="numeric" start="24">1</span><span class="filter" start="25">]</span><span class="z">"</span><span id="wx1647" class="sc">/&gt;</span></span><span class="txt">
                  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1651" class="ec">&gt;</span></span><span class="txt">
                  </span><span class="ww" id="w1653"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xlink:title</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
                    </span><span class="ww" id="w1664"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xlink:title</span><span class="z">"</span><span id="wx1673" class="sc">/&gt;</span></span><span class="txt">
                  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1677" class="ec">&gt;</span></span><span class="txt">
                  </span><span class="ww" id="w1679"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
                    </span><span class="ww" id="w1683"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
                      </span><span class="ww" id="w1687"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Warning: inline extended link locator without title</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1693" class="ec">&gt;</span></span><span class="txt">
                      </span><span class="ww" id="w1695"><span class="es">&lt;</span><span class="enxsl">xsl:sequence</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span id="wx1703" class="sc">/&gt;</span></span><span class="txt">
                    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1707" class="ec">&gt;</span></span><span class="txt">
                    </span><span class="ww" id="w1709"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">???</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1715" class="ec">&gt;</span></span><span class="txt">
                  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx1719" class="ec">&gt;</span></span><span class="txt">
                </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx1723" class="ec">&gt;</span></span><span class="txt">
              </span><span class="ez">&lt;/</span><span class="cl">a</span><span id="wx1727" class="ec">&gt;</span></span><span class="txt">
            </span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx1731" class="ec">&gt;</span></span><span class="txt">
            </span><span class="ww" id="w1733"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">]</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1739" class="ec">&gt;</span></span><span class="txt">
          </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1743" class="ec">&gt;</span></span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="cl">span</span><span id="wx1747" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx1751" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx1755" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx1759" class="ec">&gt;</span></span><span class="txt">
  
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:stylesheet</span><span id="wx1763" class="ec">&gt;</span></span><span class="txt">
</span></p></div></body></html>