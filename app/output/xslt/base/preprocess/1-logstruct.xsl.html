<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>1-logstruct.xsl</title><link rel="stylesheet" type="text/css" href="../../../theme.css"></head><body><div><p class="spectrum"><span class="ww" id="w1"><span class="es">&lt;</span><a class="solar" href="../../../index.html"><span class="enxsl" id="e?{http://www.w3.org/1999/XSL/Transform}stylesheet">xsl:stylesheet</span></a><span class="z"> </span><span class="atn">xmlns:xsl</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/1999/XSL/Transform</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:db</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:f</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/extension</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:mp</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/mode/private</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:xs</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/2001/XMLSchema</span><span class="z">"</span><span class="z">
                		</span><span class="atn">exclude-result-prefixes</span><span class="atneq">=</span><span class="z">"</span><span class="av">db f mp xs</span><span class="z">"</span><span class="z">
                                </span><span class="atn">version</span><span class="atneq">=</span><span class="z">"</span><span class="av">2.0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> This stylesheet attempts to preserve the logical structure of an XML document </span><span class="z">--&gt;</span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> This may be the first in a series of transformations. Because
     only the first document in a series of transformations has
     (guaranteed) access to the original base URI and any declarations
     provided in an internal or external subset, this stylesheet simply
     provides an xml:base attribute and replaces all entityref
     attributes with fileref. </span><span class="z">--&gt;</span><span class="txt">

</span><span class="ww" id="w55"><span class="es">&lt;</span><span class="enxsl">xsl:output</span><span class="z"> </span><span class="atn">method</span><span class="atneq">=</span><span class="z">"</span><span class="av">xml</span><span class="z">"</span><span class="z"> </span><span class="atn">encoding</span><span class="atneq">=</span><span class="z">"</span><span class="av">utf-8</span><span class="z">"</span><span class="z"> </span><span class="atn">indent</span><span class="atneq">=</span><span class="z">"</span><span class="av">no</span><span class="z">"</span><span class="z"> </span><span class="atn">omit-xml-declaration</span><span class="atneq">=</span><span class="z">"</span><span class="av">yes</span><span class="z">"</span><span id="wx81" class="sc">/&gt;</span></span><span class="txt">

</span><span class="ww" id="w83"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w93"><span class="es">&lt;</span><span class="enxsl">xsl:sequence</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="../../../xslt/base/preprocess/1-logstruct.xsl.html#f?{http://docbook.org/xslt/ns/extension}explicit-logical-structure" class="solar"><span class="function" start="1" pair-end="31" select="quick">f:explicit-logical-structure</span></a><span class="parenthesis">(</span><span class="step" start="30">/</span><span class="parenthesis" start="31">)</span><span class="z">"</span><span id="wx104" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx108" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w110"><span class="es">&lt;</span><span class="enxsl">xsl:function</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="fname" id="f?{http://docbook.org/xslt/ns/extension}explicit-logical-structure">f:explicit-logical-structure</span><span class="z">"</span><span class="z"> </span><span class="atn">as</span><span class="atneq">=</span><span class="z">"</span><span class="av">document-node()</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w126"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?root">root</span><span class="z">"</span><span class="z"> </span><span class="atn">as</span><span class="atneq">=</span><span class="z">"</span><span class="av">document-node()</span><span class="z">"</span><span id="wx140" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ww" id="w142"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$root</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">mp:justcopy</span><span class="z">"</span><span id="wx156" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:function</span><span id="wx160" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w162"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">mp:justcopy</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w178"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w182"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">mp:justcopy</span><span class="z">"</span><span id="wx190" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx194" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx198" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w200"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="qname" start="2" select="quick">*</span><span class="filter" start="3" pair-end="5" select="quick">[</span><span class="numeric" start="4">1</span><span class="filter" start="5">]</span><span class="z">"</span><span class="z"> </span><span class="atn">priority</span><span class="atneq">=</span><span class="z">"</span><span class="av">2</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">mp:justcopy</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w226"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w230"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx239" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ww" id="w241"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="1" pair-end="14" select="quick">not</span></a><span class="parenthesis">(</span><span class="axis" start="5">@</span><span class="qname" start="6" select="quick">xml:base</span><span class="parenthesis" start="14">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w255"><span class="es">&lt;</span><span class="enxsl">xsl:attribute</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">xml:base</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-base-uri" class="solar"><span class="function" start="1" pair-end="11" select="quick">base-uri</span></a><span class="parenthesis">(</span><span class="context" start="10">.</span><span class="parenthesis" start="11">)</span><span class="z">"</span><span id="wx272" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx276" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ww" id="w278"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">mp:justcopy</span><span class="z">"</span><span id="wx286" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx290" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx294" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w296"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:imagedata</span><span class="filter" start="13" pair-end="24" select="quick">[</span><span class="axis" start="14">@</span><span class="qname" start="15" select="quick">entityref</span><span class="filter" start="24">]</span><span class="whitespace" start="25">
                                          </span><span class="op" start="47">|</span><span class="qname" start="48" select="quick">db:textdata</span><span class="filter" start="59" pair-end="70" select="quick">[</span><span class="axis" start="60">@</span><span class="qname" start="61" select="quick">entityref</span><span class="filter" start="70">]</span><span class="whitespace" start="71">
                     		     </span><span class="op" start="79">|</span><span class="qname" start="80" select="quick">db:videodata</span><span class="filter" start="92" pair-end="103" select="quick">[</span><span class="axis" start="93">@</span><span class="qname" start="94" select="quick">entityref</span><span class="filter" start="103">]</span><span class="whitespace" start="104">
                                          </span><span class="op" start="126">|</span><span class="qname" start="127" select="quick">db:audiodata</span><span class="filter" start="139" pair-end="150" select="quick">[</span><span class="axis" start="140">@</span><span class="qname" start="141" select="quick">entityref</span><span class="filter" start="150">]</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">mp:justcopy</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w337"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w341"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="filter" start="3" pair-end="41" select="quick">[</span><a href="http://www.w3.org/TR/xpath-functions/#func-node-name" class="solar"><span class="function" start="4" pair-end="15" select="quick">node-name</span></a><span class="parenthesis">(</span><span class="context" start="14">.</span><span class="parenthesis" start="15">)</span><span class="whitespace" start="16"> </span><span class="op" start="17">!=</span><span class="whitespace" start="19"> </span><span class="function" start="20" pair-end="40" select="quick">xs:QName</span><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="29">entityref</span><span class="op">'</span><span class="parenthesis" start="40">)</span><span class="filter" start="41">]</span><span class="z">"</span><span id="wx365" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ww" id="w367"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">entityref</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w378"><span class="es">&lt;</span><span class="enxsl">xsl:attribute</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">fileref</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w388"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-unparsed-entity-uri" class="solar"><span class="function" start="1" pair-end="31" select="quick">unparsed-entity-uri</span></a><span class="parenthesis">(</span><span class="axis" start="21">@</span><span class="qname" start="22" select="quick">entityref</span><span class="parenthesis" start="31">)</span><span class="z">"</span><span id="wx400" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:attribute</span><span id="wx404" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx408" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ww" id="w410"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">mp:justcopy</span><span class="z">"</span><span id="wx418" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx422" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx426" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w428"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">*</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">mp:justcopy</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w444"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w448"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx457" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ww" id="w459"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">mp:justcopy</span><span class="z">"</span><span id="wx467" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx471" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx475" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w477"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="node" start="1" pair-end="9" select="quick">comment</span><span class="parenthesis">(</span><span class="parenthesis" start="9">)</span><span class="op" start="10">|</span><span class="node" start="11" pair-end="34" select="quick">processing-instruction</span><span class="parenthesis">(</span><span class="parenthesis" start="34">)</span><span class="op" start="35">|</span><span class="node" start="36" pair-end="41" select="quick">text</span><span class="parenthesis">(</span><span class="parenthesis" start="41">)</span><span class="z">"</span><span class="z">
              	      </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">mp:justcopy</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w503"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span id="wx505" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx509" class="ec">&gt;</span></span><span class="txt">

</span><span class="ez">&lt;/</span><span class="clxsl">xsl:stylesheet</span><span id="wx513" class="ec">&gt;</span></span><span class="txt">
</span></p></div></body></html>