<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>olink.xsl</title><link rel="stylesheet" type="text/css" href="../../../theme.css"></head><body><div><p class="spectrum"><span class="z">&lt;?</span><span class="pi">xml version="1.0" encoding="utf-8"</span><span class="z">?&gt;</span><span class="txt">
</span><span class="ww" id="w5"><span class="es">&lt;</span><span class="enxsl">xsl:stylesheet</span><span class="z"> </span><span class="atn">xmlns:xsl</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/1999/XSL/Transform</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">xmlns:db</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">xmlns:doc</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://nwalsh.com/xsl/documentation/1.0</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">xmlns:f</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/extension</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">xmlns:fn</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/2005/xpath-functions</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">xmlns:m</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/mode</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">xmlns:n</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/normalize</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">xmlns:t</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/template</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">xmlns:xlink</span><span class="atneq">=</span><span class="z">'</span><span class="av">http://www.w3.org/1999/xlink</span><span class="z">'</span><span class="z">
££££££££££££££££qq</span><span class="atn">xmlns:xs</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/2001/XMLSchema</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">exclude-result-prefixes</span><span class="atneq">=</span><span class="z">"</span><span class="av">db doc f fn m n t xlink xs</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">version</span><span class="atneq">=</span><span class="z">"</span><span class="av">2.0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">

</span><span class="ww" id="w81"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.base.uri">olink.base.uri</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx97" class="sc">/&gt;</span></span><span class="txt"> 
</span><span class="ww" id="w99"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.debug">olink.debug</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="numeric" start="1">0</span><span class="z">"</span><span id="wx113" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w115"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?insert.olink.pdf.frag">insert.olink.pdf.frag</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="numeric" start="1">0</span><span class="z">"</span><span id="wx129" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w131"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?prefer.internal.olink">prefer.internal.olink</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="numeric" start="1">0</span><span class="z">"</span><span id="wx145" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w147"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.lang.fallback.sequence">olink.lang.fallback.sequence</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx163" class="sc">/&gt;</span></span><span class="txt"> 
</span><span class="ww" id="w165"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.fragid">olink.fragid</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">fragid=</span><span class="op">'</span><span class="z">"</span><span id="wx181" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w183"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.outline.ext">olink.outline.ext</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">.olink</span><span class="op">'</span><span class="z">"</span><span id="wx199" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w201"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.pubid">olink.pubid</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">pubid=</span><span class="op">'</span><span class="z">"</span><span id="wx217" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w219"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.resolver">olink.resolver</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">/cgi-bin/olink</span><span class="op">'</span><span class="z">"</span><span id="wx235" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w237"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.sysid">olink.sysid</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">sysid=</span><span class="op">'</span><span class="z">"</span><span id="wx253" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w255"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?use.local.olink.style">use.local.olink.style</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="numeric" start="1">0</span><span class="z">"</span><span id="wx269" class="sc">/&gt;</span></span><span class="txt"> 
</span><span class="ww" id="w271"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.database.document">target.database.document</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx287" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w289"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targets.filename">targets.filename</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">target.db</span><span class="op">'</span><span class="z">"</span><span id="wx305" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w307"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?current.docid">current.docid</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx323" class="sc">/&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> Create keys for quickly looking up olink targets </span><span class="z">--&gt;</span><span class="txt">
</span><span class="ww" id="w329"><span class="es">&lt;</span><span class="enxsl">xsl:key</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">targetdoc-key</span><span class="z">"</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">document</span><span class="z">"</span><span class="z"> </span><span class="atn">use</span><span class="atneq">=</span><span class="z">"</span><span class="av">@targetdoc</span><span class="z">"</span><span id="wx349" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w351"><span class="es">&lt;</span><span class="enxsl">xsl:key</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">targetptr-key</span><span class="z">"</span><span class="z">  </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">div</span><span class="op" start="4">|</span><span class="qname" start="5" select="quick">obj</span><span class="z">"</span><span class="z">
£££££££££qq</span><span class="atn">use</span><span class="atneq">=</span><span class="z">"</span><span class="av">concat(ancestor::document/@targetdoc, '/',
qq@targetptr, '/', ancestor::document/@lang)</span><span class="z">"</span><span id="wx373" class="sc">/&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> Return filename of database </span><span class="z">--&gt;</span><span class="txt">
</span><span class="ww" id="w379"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}select-target-database">t:select-target-database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w389"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetdoc.att">targetdoc.att</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx405" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w407"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetptr.att">targetptr.att</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx423" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w425"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.lang">olink.lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx441" class="sc">/&gt;</span></span><span class="txt">

qq</span><span class="z">&lt;!--</span><span class="cm"> This selection can be customized if needed </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w447"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.database.filename">target.database.filename</span><span class="z">"</span><span class="z"> 
££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?target.database.document" class="solar"><span class="variable" start="1" select="quick">$target.database.document</span></a><span class="z">"</span><span id="wx461" class="sc">/&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w463"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.database">target.database</span><span class="z">"</span><span class="z"> 
££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-document" class="solar"><span class="function" start="1" pair-end="37" select="quick">document</span></a><span class="parenthesis">(</span><span class="variable" start="10" select="quick">$target.database.filename</span><span class="op" start="35">,</span><span class="step" start="36">/</span><span class="parenthesis" start="37">)</span><span class="z">"</span><span id="wx482" class="sc">/&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w484"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Was the database document parameter not set? </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w492"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?target.database.document" class="solar"><span class="variable" start="1" select="quick">$target.database.document</span></a><span class="whitespace" start="26"> </span><span class="op" start="27">=</span><span class="whitespace" start="28"> </span><span class="op">'</span><span class="literal" start="29"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w508"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w512"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olinks not processed: must specify a </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx518" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w520"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">$target.database.document parameter&amp;#10;</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx526" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w528"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">when using olinks with targetdoc </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx534" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w536"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">and targetptr attributes.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx542" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx546" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx550" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="z">&lt;!--</span><span class="cm"> Did it not open? Should be a targetset element </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w556"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="1" pair-end="23" select="quick">not</span></a><span class="parenthesis">(</span><span class="variable" start="5" select="quick">$target.database</span><span class="step" start="21">/</span><span class="qname" start="22" select="quick">*</span><span class="parenthesis" start="23">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w571"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w575"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink error: could not open target database '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx581" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w583"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database.filename</span><span class="z">"</span><span id="wx591" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w593"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">'.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx599" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx603" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx607" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w609"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w613"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database.filename</span><span class="z">"</span><span id="wx621" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx625" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx629" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx633" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w635"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}select-olink-key">t:select-olink-key</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w645"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetdoc.att">targetdoc.att</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx661" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w663"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetptr.att">targetptr.att</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx679" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w681"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.lang">olink.lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx697" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w699"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.database">target.database</span><span class="z">"</span><span id="wx707" class="sc">/&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w709"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="step" start="17">/</span><span class="qname" start="18" select="quick">*</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w721"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.fallback.sequence">olink.fallback.sequence</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w731"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#t?{http://docbook.org/xslt/ns/template}select-olink-lang-fallback" class="solar"><span class="tcall">t:select-olink-lang-fallback</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w741"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">olink.lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.lang</span><span class="z">"</span><span id="wx755" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx759" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx763" class="ec">&gt;</span></span><span class="txt">
qq
qq</span><span class="z">&lt;!--</span><span class="cm"> Recurse through the languages until you find a match </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w769"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#t?{http://docbook.org/xslt/ns/template}select-olink-key-in-lang" class="solar"><span class="tcall">t:select-olink-key-in-lang</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w779"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">targetdoc.att</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetdoc.att</span><span class="z">"</span><span id="wx793" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w795"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">targetptr.att</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetptr.att</span><span class="z">"</span><span id="wx809" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w811"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">olink.lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.lang</span><span class="z">"</span><span id="wx825" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w827"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">target.database</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span id="wx841" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w843"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">fallback.index</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="numeric" start="1">1</span><span class="z">"</span><span id="wx857" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w859"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">olink.fallback.sequence</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.fallback.sequence</span><span class="z">"</span><span id="wx873" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx877" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx881" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx885" class="ec">&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> Locate olink key in a particular language </span><span class="z">--&gt;</span><span class="txt">
</span><span class="ww" id="w891"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}select-olink-key-in-lang">t:select-olink-key-in-lang</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w901"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetdoc.att">targetdoc.att</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx917" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w919"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetptr.att">targetptr.att</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx935" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w937"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.lang">olink.lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx953" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w955"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.database">target.database</span><span class="z">"</span><span id="wx963" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w965"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?fallback.index">fallback.index</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="numeric" start="1">1</span><span class="z">"</span><span id="wx979" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w981"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.fallback.sequence">olink.fallback.sequence</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx997" class="sc">/&gt;</span></span><span class="txt">
qq
qq</span><span class="ww" id="w999"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.lang">target.lang</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1009"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#t?{http://docbook.org/xslt/ns/template}select-target-lang" class="solar"><span class="tcall">t:select-target-lang</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1019"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">fallback.index</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$fallback.index</span><span class="z">"</span><span id="wx1033" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1035"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">olink.fallback.sequence</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.fallback.sequence</span><span class="z">"</span><span id="wx1049" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx1053" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx1057" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w1059"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1073"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt"></span><span class="ww" id="w1077"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink debug: cases for targetdoc='</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1083" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1085"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetdoc.att</span><span class="z">"</span><span id="wx1093" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1095"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' and targetptr='</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1101" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1103"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetptr.att</span><span class="z">"</span><span id="wx1111" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1113"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' in language '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1119" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1121"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.lang</span><span class="z">"</span><span id="wx1129" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1131"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">'.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1137" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1141" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1145" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="z">&lt;!--</span><span class="cm"> Customize these cases if you want different selection logic </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w1151"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?CaseA">CaseA</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> targetdoc.att = not blank
qqtargetptr.att = not blank
qq</span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w1165"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetdoc.att</span><span class="whitespace" start="15"> </span><span class="op" start="16">!=</span><span class="whitespace" start="18"> </span><span class="op">'</span><span class="literal" start="19"></span><span class="op">'</span><span class="whitespace" start="21"> </span><span class="op" start="22">and</span><span class="whitespace" start="25">
££££££££££££££qq</span><span class="variable" start="44" select="quick">$targetptr.att</span><span class="whitespace" start="58"> </span><span class="op" start="59">!=</span><span class="whitespace" start="61"> </span><span class="op">'</span><span class="literal" start="62"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1191"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1201"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?key">key</span><span class="z">"</span><span class="z"> 
££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-concat" class="solar"><span class="function" start="1" pair-end="137" select="quick">concat</span></a><span class="parenthesis">(</span><span class="variable" start="8" select="quick">$targetdoc.att</span><span class="op" start="22">,</span><span class="whitespace" start="23"> </span><span class="op">'</span><span class="literal" start="24">/</span><span class="op">'</span><span class="op" start="27">,</span><span class="whitespace" start="28"> 
££££££££££££££££££££££qq</span><span class="variable" start="67" select="quick">$targetptr.att</span><span class="op" start="81">,</span><span class="whitespace" start="82"> </span><span class="op">'</span><span class="literal" start="83">/</span><span class="op">'</span><span class="op" start="86">,</span><span class="whitespace" start="87">
££££££££££££££££££££££qq</span><span class="variable" start="125" select="quick">$target.lang</span><span class="parenthesis" start="137">)</span><span class="z">"</span><span id="wx1234" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1236"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1240"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="26" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$key</span><span class="parenthesis" start="26">)</span><span class="step" start="27">/</span><span class="axis" start="28">@</span><span class="qname" start="29" select="quick">href</span><span class="whitespace" start="33"> </span><span class="op" start="34">!=</span><span class="whitespace" start="36"> </span><span class="op">'</span><span class="literal" start="37"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1267"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$key</span><span class="z">"</span><span id="wx1275" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1277"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1291"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseA matched.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1297" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1301" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1305" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1307"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1321"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseA NOT matched</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1327" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1331" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx1335" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx1339" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1343" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx1347" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w1349"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?CaseB">CaseB</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> targetdoc.att = not blank
qqtargetptr.att = not blank
qqprefer.internal.olink = not zero
qqcurrent.docid = not blank 
qq</span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w1363"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetdoc.att</span><span class="whitespace" start="15"> </span><span class="op" start="16">!=</span><span class="whitespace" start="18"> </span><span class="op">'</span><span class="literal" start="19"></span><span class="op">'</span><span class="whitespace" start="21"> </span><span class="op" start="22">and</span><span class="whitespace" start="25">
££££££££££££££qq</span><span class="variable" start="44" select="quick">$targetptr.att</span><span class="whitespace" start="58"> </span><span class="op" start="59">!=</span><span class="whitespace" start="61"> </span><span class="op">'</span><span class="literal" start="62"></span><span class="op">'</span><span class="whitespace" start="64"> </span><span class="op" start="65">and</span><span class="whitespace" start="68">
££££££££££££££qq</span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="87" select="quick">$current.docid</span></a><span class="whitespace" start="101"> </span><span class="op" start="102">!=</span><span class="whitespace" start="104"> </span><span class="op">'</span><span class="literal" start="105"></span><span class="op">'</span><span class="whitespace" start="107"> </span><span class="op" start="108">and</span><span class="whitespace" start="111">
££££££££££££££qq</span><a href="olink.xsl.html#v?prefer.internal.olink" class="solar"><span class="variable" start="130" select="quick">$prefer.internal.olink</span></a><span class="whitespace" start="152"> </span><span class="op" start="153">!=</span><span class="whitespace" start="155"> </span><span class="numeric" start="156">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1407"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1417"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?key">key</span><span class="z">"</span><span class="z"> 
££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-concat" class="solar"><span class="function" start="1" pair-end="137" select="quick">concat</span></a><span class="parenthesis">(</span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="8" select="quick">$current.docid</span></a><span class="op" start="22">,</span><span class="whitespace" start="23"> </span><span class="op">'</span><span class="literal" start="24">/</span><span class="op">'</span><span class="op" start="27">,</span><span class="whitespace" start="28"> 
££££££££££££££££££££££qq</span><span class="variable" start="67" select="quick">$targetptr.att</span><span class="op" start="81">,</span><span class="whitespace" start="82"> </span><span class="op">'</span><span class="literal" start="83">/</span><span class="op">'</span><span class="op" start="86">,</span><span class="whitespace" start="87">
££££££££££££££££££££££qq</span><span class="variable" start="125" select="quick">$target.lang</span><span class="parenthesis" start="137">)</span><span class="z">"</span><span id="wx1450" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1452"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1456"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="26" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$key</span><span class="parenthesis" start="26">)</span><span class="step" start="27">/</span><span class="axis" start="28">@</span><span class="qname" start="29" select="quick">href</span><span class="whitespace" start="33"> </span><span class="op" start="34">!=</span><span class="whitespace" start="36"> </span><span class="op">'</span><span class="literal" start="37"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1483"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$key</span><span class="z">"</span><span id="wx1491" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1493"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1507"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseB matched.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1513" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1517" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1521" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1523"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1537"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseB NOT matched</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1543" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1547" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx1551" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx1555" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1559" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx1563" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w1565"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?CaseC">CaseC</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> targetdoc.att = blank
qqtargetptr.att = not blank
qqcurrent.docid = not blank 
qq</span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w1579"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-string-length" class="solar"><span class="function" start="1" pair-end="29" select="quick">string-length</span></a><span class="parenthesis">(</span><span class="variable" start="15" select="quick">$targetdoc.att</span><span class="parenthesis" start="29">)</span><span class="whitespace" start="30"> </span><span class="op" start="31">=</span><span class="whitespace" start="32"> </span><span class="numeric" start="33">0</span><span class="whitespace" start="34"> </span><span class="op" start="35">and</span><span class="whitespace" start="38">
££££££££££££££qq</span><span class="variable" start="57" select="quick">$targetptr.att</span><span class="whitespace" start="71"> </span><span class="op" start="72">!=</span><span class="whitespace" start="74"> </span><span class="op">'</span><span class="literal" start="75"></span><span class="op">'</span><span class="whitespace" start="77"> </span><span class="op" start="78">and</span><span class="whitespace" start="81">
££££££££££££££qq</span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="100" select="quick">$current.docid</span></a><span class="whitespace" start="114"> </span><span class="op" start="115">!=</span><span class="whitespace" start="117"> </span><span class="op">'</span><span class="literal" start="118"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Must use a for-each to change context for keys to work </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w1620"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1630"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?key">key</span><span class="z">"</span><span class="z"> 
££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-concat" class="solar"><span class="function" start="1" pair-end="137" select="quick">concat</span></a><span class="parenthesis">(</span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="8" select="quick">$current.docid</span></a><span class="op" start="22">,</span><span class="whitespace" start="23"> </span><span class="op">'</span><span class="literal" start="24">/</span><span class="op">'</span><span class="op" start="27">,</span><span class="whitespace" start="28"> 
££££££££££££££££££££££qq</span><span class="variable" start="67" select="quick">$targetptr.att</span><span class="op" start="81">,</span><span class="whitespace" start="82"> </span><span class="op">'</span><span class="literal" start="83">/</span><span class="op">'</span><span class="op" start="86">,</span><span class="whitespace" start="87">
££££££££££££££££££££££qq</span><span class="variable" start="125" select="quick">$target.lang</span><span class="parenthesis" start="137">)</span><span class="z">"</span><span id="wx1663" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1665"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1669"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="26" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$key</span><span class="parenthesis" start="26">)</span><span class="step" start="27">/</span><span class="axis" start="28">@</span><span class="qname" start="29" select="quick">href</span><span class="whitespace" start="33"> </span><span class="op" start="34">!=</span><span class="whitespace" start="36"> </span><span class="op">'</span><span class="literal" start="37"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1696"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$key</span><span class="z">"</span><span id="wx1704" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1706"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1720"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseC matched.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1726" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1730" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1734" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1736"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1750"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseC NOT matched.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1756" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1760" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx1764" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx1768" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1772" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx1776" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w1778"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?CaseD">CaseD</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> targetdoc.att = blank
qqtargetptr.att = not blank
qqcurrent.docid = blank 
qq</span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> This is possible if only one document in the database </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w1796"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-string-length" class="solar"><span class="function" start="1" pair-end="29" select="quick">string-length</span></a><span class="parenthesis">(</span><span class="variable" start="15" select="quick">$targetdoc.att</span><span class="parenthesis" start="29">)</span><span class="whitespace" start="30"> </span><span class="op" start="31">=</span><span class="whitespace" start="32"> </span><span class="numeric" start="33">0</span><span class="whitespace" start="34"> </span><span class="op" start="35">and</span><span class="whitespace" start="38">
££££££££££££££qq</span><span class="variable" start="57" select="quick">$targetptr.att</span><span class="whitespace" start="71"> </span><span class="op" start="72">!=</span><span class="whitespace" start="74"> </span><span class="op">'</span><span class="literal" start="75"></span><span class="op">'</span><span class="whitespace" start="77"> </span><span class="op" start="78">and</span><span class="whitespace" start="81">
££££££££££££££qq</span><a href="http://www.w3.org/TR/xpath-functions/#func-string-length" class="solar"><span class="function" start="100" pair-end="128" select="quick">string-length</span></a><span class="parenthesis">(</span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="114" select="quick">$current.docid</span></a><span class="parenthesis" start="128">)</span><span class="whitespace" start="129"> </span><span class="op" start="130">=</span><span class="whitespace" start="131"> </span><span class="numeric" start="132">0</span><span class="whitespace" start="133"> </span><span class="op" start="134">and</span><span class="whitespace" start="137">
££££££££££££££qq</span><a href="http://www.w3.org/TR/xpath-functions/#func-count" class="solar"><span class="function" start="156" pair-end="188" select="quick">count</span></a><span class="parenthesis">(</span><span class="variable" start="162" select="quick">$target.database</span><span class="step" start="178">//</span><span class="qname" start="180" select="quick">document</span><span class="parenthesis" start="188">)</span><span class="whitespace" start="189"> </span><span class="op" start="190">=</span><span class="whitespace" start="191"> </span><span class="numeric" start="192">1</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1847"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1857"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?key">key</span><span class="z">"</span><span class="z"> 
££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-concat" class="solar"><span class="function" start="1" pair-end="145" select="quick">concat</span></a><span class="parenthesis">(</span><span class="context" start="8">.</span><span class="step" start="9">//</span><span class="qname" start="11" select="quick">document</span><span class="step" start="19">/</span><span class="axis" start="20">@</span><span class="qname" start="21" select="quick">targetdoc</span><span class="op" start="30">,</span><span class="whitespace" start="31"> </span><span class="op">'</span><span class="literal" start="32">/</span><span class="op">'</span><span class="op" start="35">,</span><span class="whitespace" start="36"> 
££££££££££££££££££££££qq</span><span class="variable" start="75" select="quick">$targetptr.att</span><span class="op" start="89">,</span><span class="whitespace" start="90"> </span><span class="op">'</span><span class="literal" start="91">/</span><span class="op">'</span><span class="op" start="94">,</span><span class="whitespace" start="95">
££££££££££££££££££££££qq</span><span class="variable" start="133" select="quick">$target.lang</span><span class="parenthesis" start="145">)</span><span class="z">"</span><span id="wx1895" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1897"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1901"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="26" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$key</span><span class="parenthesis" start="26">)</span><span class="step" start="27">/</span><span class="axis" start="28">@</span><span class="qname" start="29" select="quick">href</span><span class="whitespace" start="33"> </span><span class="op" start="34">!=</span><span class="whitespace" start="36"> </span><span class="op">'</span><span class="literal" start="37"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1928"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$key</span><span class="z">"</span><span id="wx1936" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1938"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1952"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseD matched.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1958" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1962" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1966" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w1968"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w1982"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseD NOT matched</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1988" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1992" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx1996" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx2000" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx2004" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx2008" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w2010"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?CaseE">CaseE</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> targetdoc.att = not blank
qqtargetptr.att = blank
qq</span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w2024"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetdoc.att</span><span class="whitespace" start="15"> </span><span class="op" start="16">!=</span><span class="whitespace" start="18"> </span><span class="op">'</span><span class="literal" start="19"></span><span class="op">'</span><span class="whitespace" start="21"> </span><span class="op" start="22">and</span><span class="whitespace" start="25">
££££££££££££££qq</span><a href="http://www.w3.org/TR/xpath-functions/#func-string-length" class="solar"><span class="function" start="44" pair-end="72" select="quick">string-length</span></a><span class="parenthesis">(</span><span class="variable" start="58" select="quick">$targetptr.att</span><span class="parenthesis" start="72">)</span><span class="whitespace" start="73"> </span><span class="op" start="74">=</span><span class="whitespace" start="75"> </span><span class="numeric" start="76">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">

qq</span><span class="z">&lt;!--</span><span class="cm"> Try the document's root element id </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w2055"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?rootid">rootid</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2065"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2069"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.lang</span><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="op">'</span><span class="literal" start="17"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2085"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="step" start="17">//</span><span class="qname" start="19" select="quick">document</span><span class="filter" start="27" pair-end="80" select="quick">[</span><span class="axis" start="28">@</span><span class="qname" start="29" select="quick">targetdoc</span><span class="whitespace" start="38"> </span><span class="op" start="39">=</span><span class="whitespace" start="40"> </span><span class="variable" start="41" select="quick">$targetdoc.att</span><span class="whitespace" start="55"> </span><span class="op" start="56">and</span><span class="whitespace" start="59"> </span><span class="axis" start="60">@</span><span class="qname" start="61" select="quick">lang</span><span class="whitespace" start="65"> </span><span class="op" start="66">=</span><span class="whitespace" start="67"> </span><span class="variable" start="68" select="quick">$target.lang</span><span class="filter" start="80">]</span><span class="step" start="81">/</span><span class="qname" start="82" select="quick">*</span><span class="filter" start="83" pair-end="85" select="quick">[</span><span class="numeric" start="84">1</span><span class="filter" start="85">]</span><span class="step" start="86">/</span><span class="axis" start="87">@</span><span class="qname" start="88" select="quick">targetptr</span><span class="z">"</span><span id="wx2120" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2124" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2126"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2130"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="step" start="17">//</span><span class="qname" start="19" select="quick">document</span><span class="filter" start="27" pair-end="70" select="quick">[</span><span class="axis" start="28">@</span><span class="qname" start="29" select="quick">targetdoc</span><span class="whitespace" start="38"> </span><span class="op" start="39">=</span><span class="whitespace" start="40"> </span><span class="variable" start="41" select="quick">$targetdoc.att</span><span class="whitespace" start="55"> </span><span class="op" start="56">and</span><span class="whitespace" start="59"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="60" pair-end="69" select="quick">not</span></a><span class="parenthesis">(</span><span class="axis" start="64">@</span><span class="qname" start="65" select="quick">lang</span><span class="parenthesis" start="69">)</span><span class="filter" start="70">]</span><span class="step" start="71">/</span><span class="qname" start="72" select="quick">*</span><span class="filter" start="73" pair-end="75" select="quick">[</span><span class="numeric" start="74">1</span><span class="filter" start="75">]</span><span class="step" start="76">/</span><span class="axis" start="77">@</span><span class="qname" start="78" select="quick">targetptr</span><span class="z">"</span><span id="wx2164" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx2168" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx2172" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx2176" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w2178"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2188"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?key">key</span><span class="z">"</span><span class="z"> 
££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-concat" class="solar"><span class="function" start="1" pair-end="130" select="quick">concat</span></a><span class="parenthesis">(</span><span class="variable" start="8" select="quick">$targetdoc.att</span><span class="op" start="22">,</span><span class="whitespace" start="23"> </span><span class="op">'</span><span class="literal" start="24">/</span><span class="op">'</span><span class="op" start="27">,</span><span class="whitespace" start="28"> 
££££££££££££££££££££££qq</span><a href="ram.xsl.html#v?rootid" class="solar"><span class="variable" start="67" select="quick">$rootid</span></a><span class="op" start="74">,</span><span class="whitespace" start="75"> </span><span class="op">'</span><span class="literal" start="76">/</span><span class="op">'</span><span class="op" start="79">,</span><span class="whitespace" start="80">
££££££££££££££££££££££qq</span><span class="variable" start="118" select="quick">$target.lang</span><span class="parenthesis" start="130">)</span><span class="z">"</span><span id="wx2221" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2223"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2227"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="26" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$key</span><span class="parenthesis" start="26">)</span><span class="step" start="27">/</span><span class="axis" start="28">@</span><span class="qname" start="29" select="quick">href</span><span class="whitespace" start="33"> </span><span class="op" start="34">!=</span><span class="whitespace" start="36"> </span><span class="op">'</span><span class="literal" start="37"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2254"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$key</span><span class="z">"</span><span id="wx2262" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2264"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2278"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseE matched.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx2284" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx2288" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2292" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2294"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2308"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseE NOT matched.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx2314" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2318" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx2322" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx2326" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx2330" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx2334" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w2336"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?CaseF">CaseF</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> targetdoc.att = not blank
qqtargetptr.att = blank
qqprefer.internal.olink = not zero
qqcurrent.docid = not blank 
qq</span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w2350"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetdoc.att</span><span class="whitespace" start="15"> </span><span class="op" start="16">!=</span><span class="whitespace" start="18"> </span><span class="op">'</span><span class="literal" start="19"></span><span class="op">'</span><span class="whitespace" start="21"> </span><span class="op" start="22">and</span><span class="whitespace" start="25">
££££££££££££££qq</span><a href="http://www.w3.org/TR/xpath-functions/#func-string-length" class="solar"><span class="function" start="44" pair-end="72" select="quick">string-length</span></a><span class="parenthesis">(</span><span class="variable" start="58" select="quick">$targetptr.att</span><span class="parenthesis" start="72">)</span><span class="whitespace" start="73"> </span><span class="op" start="74">=</span><span class="whitespace" start="75"> </span><span class="numeric" start="76">0</span><span class="whitespace" start="77"> </span><span class="op" start="78">and</span><span class="whitespace" start="81">
££££££££££££££qq</span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="100" select="quick">$current.docid</span></a><span class="whitespace" start="114"> </span><span class="op" start="115">!=</span><span class="whitespace" start="117"> </span><span class="op">'</span><span class="literal" start="118"></span><span class="op">'</span><span class="whitespace" start="120"> </span><span class="op" start="121">and</span><span class="whitespace" start="124">
££££££££££££££qq</span><a href="olink.xsl.html#v?prefer.internal.olink" class="solar"><span class="variable" start="143" select="quick">$prefer.internal.olink</span></a><span class="whitespace" start="165"> </span><span class="op" start="166">!=</span><span class="whitespace" start="168"> </span><span class="numeric" start="169">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Try the document's root element id </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w2399"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?rootid">rootid</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2409"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2413"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.lang</span><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="op">'</span><span class="literal" start="17"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2429"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="step" start="17">//</span><span class="qname" start="19" select="quick">document</span><span class="filter" start="27" pair-end="80" select="quick">[</span><span class="axis" start="28">@</span><span class="qname" start="29" select="quick">targetdoc</span><span class="whitespace" start="38"> </span><span class="op" start="39">=</span><span class="whitespace" start="40"> </span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="41" select="quick">$current.docid</span></a><span class="whitespace" start="55"> </span><span class="op" start="56">and</span><span class="whitespace" start="59"> </span><span class="axis" start="60">@</span><span class="qname" start="61" select="quick">lang</span><span class="whitespace" start="65"> </span><span class="op" start="66">=</span><span class="whitespace" start="67"> </span><span class="variable" start="68" select="quick">$target.lang</span><span class="filter" start="80">]</span><span class="step" start="81">/</span><span class="qname" start="82" select="quick">*</span><span class="filter" start="83" pair-end="85" select="quick">[</span><span class="numeric" start="84">1</span><span class="filter" start="85">]</span><span class="step" start="86">/</span><span class="axis" start="87">@</span><span class="qname" start="88" select="quick">targetptr</span><span class="z">"</span><span id="wx2464" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2468" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2470"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2474"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="step" start="17">//</span><span class="qname" start="19" select="quick">document</span><span class="filter" start="27" pair-end="70" select="quick">[</span><span class="axis" start="28">@</span><span class="qname" start="29" select="quick">targetdoc</span><span class="whitespace" start="38"> </span><span class="op" start="39">=</span><span class="whitespace" start="40"> </span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="41" select="quick">$current.docid</span></a><span class="whitespace" start="55"> </span><span class="op" start="56">and</span><span class="whitespace" start="59"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="60" pair-end="69" select="quick">not</span></a><span class="parenthesis">(</span><span class="axis" start="64">@</span><span class="qname" start="65" select="quick">lang</span><span class="parenthesis" start="69">)</span><span class="filter" start="70">]</span><span class="step" start="71">/</span><span class="qname" start="72" select="quick">*</span><span class="filter" start="73" pair-end="75" select="quick">[</span><span class="numeric" start="74">1</span><span class="filter" start="75">]</span><span class="step" start="76">/</span><span class="axis" start="77">@</span><span class="qname" start="78" select="quick">targetptr</span><span class="z">"</span><span id="wx2508" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx2512" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx2516" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx2520" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w2522"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2532"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?key">key</span><span class="z">"</span><span class="z"> 
££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-concat" class="solar"><span class="function" start="1" pair-end="130" select="quick">concat</span></a><span class="parenthesis">(</span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="8" select="quick">$current.docid</span></a><span class="op" start="22">,</span><span class="whitespace" start="23"> </span><span class="op">'</span><span class="literal" start="24">/</span><span class="op">'</span><span class="op" start="27">,</span><span class="whitespace" start="28"> 
££££££££££££££££££££££qq</span><a href="ram.xsl.html#v?rootid" class="solar"><span class="variable" start="67" select="quick">$rootid</span></a><span class="op" start="74">,</span><span class="whitespace" start="75"> </span><span class="op">'</span><span class="literal" start="76">/</span><span class="op">'</span><span class="op" start="79">,</span><span class="whitespace" start="80">
££££££££££££££££££££££qq</span><span class="variable" start="118" select="quick">$target.lang</span><span class="parenthesis" start="130">)</span><span class="z">"</span><span id="wx2565" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2567"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2571"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="26" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$key</span><span class="parenthesis" start="26">)</span><span class="step" start="27">/</span><span class="axis" start="28">@</span><span class="qname" start="29" select="quick">href</span><span class="whitespace" start="33"> </span><span class="op" start="34">!=</span><span class="whitespace" start="36"> </span><span class="op">'</span><span class="literal" start="37"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2598"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$key</span><span class="z">"</span><span id="wx2606" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2608"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2622"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseF matched.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx2628" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx2632" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2636" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2638"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2652"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseF NOT matched.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx2658" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2662" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx2666" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx2670" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx2674" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx2678" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="z">&lt;!--</span><span class="cm"> Now select the best match. Customize the order if needed </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w2684"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?selected.key">selected.key</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2694"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2698"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseB</span><span class="whitespace" start="7"> </span><span class="op" start="8">!=</span><span class="whitespace" start="10"> </span><span class="op">'</span><span class="literal" start="11"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2714"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseB</span><span class="z">"</span><span id="wx2722" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2724"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2738"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2742"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseB key is the final selection: </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx2748" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2750"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseB</span><span class="z">"</span><span id="wx2758" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx2762" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx2766" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2770" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2772"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseA</span><span class="whitespace" start="7"> </span><span class="op" start="8">!=</span><span class="whitespace" start="10"> </span><span class="op">'</span><span class="literal" start="11"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2788"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseA</span><span class="z">"</span><span id="wx2796" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2798"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2812"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2816"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseA key is the final selection: </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx2822" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2824"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseA</span><span class="z">"</span><span id="wx2832" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx2836" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx2840" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2844" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2846"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseC</span><span class="whitespace" start="7"> </span><span class="op" start="8">!=</span><span class="whitespace" start="10"> </span><span class="op">'</span><span class="literal" start="11"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2862"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseC</span><span class="z">"</span><span id="wx2870" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2872"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2886"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2890"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseC key is the final selection: </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx2896" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2898"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseC</span><span class="z">"</span><span id="wx2906" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx2910" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx2914" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2918" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2920"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseD</span><span class="whitespace" start="7"> </span><span class="op" start="8">!=</span><span class="whitespace" start="10"> </span><span class="op">'</span><span class="literal" start="11"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2936"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseD</span><span class="z">"</span><span id="wx2944" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2946"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2960"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w2964"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseD key is the final selection: </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx2970" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2972"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseD</span><span class="z">"</span><span id="wx2980" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx2984" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx2988" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2992" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w2994"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseF</span><span class="whitespace" start="7"> </span><span class="op" start="8">!=</span><span class="whitespace" start="10"> </span><span class="op">'</span><span class="literal" start="11"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3010"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseF</span><span class="z">"</span><span id="wx3018" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3020"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3034"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3038"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseF key is the final selection: </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx3044" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3046"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseF</span><span class="z">"</span><span id="wx3054" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx3058" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx3062" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx3066" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3068"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseE</span><span class="whitespace" start="7"> </span><span class="op" start="8">!=</span><span class="whitespace" start="10"> </span><span class="op">'</span><span class="literal" start="11"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3084"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseE</span><span class="z">"</span><span id="wx3092" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3094"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3108"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3112"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink debug: CaseE key is the final selection: </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx3118" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3120"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$CaseE</span><span class="z">"</span><span id="wx3128" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx3132" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx3136" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx3140" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3142"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3146"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3160"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3164"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink debug: No case matched for lang '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx3170" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3172"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.lang</span><span class="z">"</span><span id="wx3180" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3182"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">'.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx3188" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx3192" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx3196" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx3200" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx3204" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx3208" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w3210"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3214"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$selected.key</span><span class="whitespace" start="14"> </span><span class="op" start="15">!=</span><span class="whitespace" start="17"> </span><span class="op">'</span><span class="literal" start="18"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3230"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$selected.key</span><span class="z">"</span><span id="wx3238" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx3242" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3244"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-string-length" class="solar"><span class="function" start="1" pair-end="28" select="quick">string-length</span></a><span class="parenthesis">(</span><span class="variable" start="15" select="quick">$selected.key</span><span class="parenthesis" start="28">)</span><span class="whitespace" start="29"> </span><span class="op" start="30">=</span><span class="whitespace" start="31"> </span><span class="numeric" start="32">0</span><span class="whitespace" start="33"> </span><span class="op" start="34">and</span><span class="whitespace" start="37"> 
££££££££££££££££qq</span><a href="http://www.w3.org/TR/xpath-functions/#func-string-length" class="solar"><span class="function" start="59" pair-end="85" select="quick">string-length</span></a><span class="parenthesis">(</span><span class="variable" start="73" select="quick">$target.lang</span><span class="parenthesis" start="85">)</span><span class="whitespace" start="86"> </span><span class="op" start="87">=</span><span class="whitespace" start="88"> </span><span class="numeric" start="89">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> No match on last try, and we are done </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx3278" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3280"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Recurse through next language </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w3288"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#t?{http://docbook.org/xslt/ns/template}select-olink-key-in-lang" class="solar"><span class="tcall">t:select-olink-key-in-lang</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3298"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">targetdoc.att</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetdoc.att</span><span class="z">"</span><span id="wx3312" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3314"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">targetptr.att</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetptr.att</span><span class="z">"</span><span id="wx3328" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3330"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">olink.lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.lang</span><span class="z">"</span><span id="wx3344" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3346"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">target.database</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span id="wx3360" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3362"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">fallback.index</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$fallback.index</span><span class="whitespace" start="16"> </span><span class="op" start="17">+</span><span class="whitespace" start="18"> </span><span class="numeric" start="19">1</span><span class="z">"</span><span id="wx3380" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3382"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">olink.fallback.sequence</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.fallback.sequence</span><span class="z">"</span><span id="wx3396" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx3400" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx3404" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx3408" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx3412" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w3414"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}select-target-lang">t:select-target-lang</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3424"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?fallback.index">fallback.index</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="numeric" start="1">1</span><span class="z">"</span><span id="wx3438" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3440"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.fallback.sequence">olink.fallback.sequence</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx3456" class="sc">/&gt;</span></span><span class="txt">

qq</span><span class="z">&lt;!--</span><span class="cm"> recurse backwards to find the lang matching the index </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w3462"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?firstlang">firstlang</span><span class="z">"</span><span class="z"> 
££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-substring-before" class="solar"><span class="function" start="1" pair-end="47" select="quick">substring-before</span></a><span class="parenthesis">(</span><span class="variable" start="18" select="quick">$olink.fallback.sequence</span><span class="op" start="42">,</span><span class="whitespace" start="43"> </span><span class="op">'</span><span class="literal" start="44"> </span><span class="op">'</span><span class="parenthesis" start="47">)</span><span class="z">"</span><span id="wx3484" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3486"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?rest">rest</span><span class="z">"</span><span class="z"> 
££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-substring-after" class="solar"><span class="function" start="1" pair-end="46" select="quick">substring-after</span></a><span class="parenthesis">(</span><span class="variable" start="17" select="quick">$olink.fallback.sequence</span><span class="op" start="41">,</span><span class="whitespace" start="42"> </span><span class="op">'</span><span class="literal" start="43"> </span><span class="op">'</span><span class="parenthesis" start="46">)</span><span class="z">"</span><span id="wx3508" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3510"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3514"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$fallback.index</span><span class="whitespace" start="16"> </span><span class="op" start="17">=</span><span class="whitespace" start="18"> </span><span class="numeric" start="19">1</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3528"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$firstlang</span><span class="z">"</span><span id="wx3536" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx3540" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3542"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$fallback.index</span><span class="whitespace" start="16"> </span><span class="qname" start="17" select="quick">&amp;</span><span class="op" start="18">gt</span><span class="qname" start="20" select="quick">;</span><span class="whitespace" start="21"> </span><span class="numeric" start="22">1</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3558"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#t?{http://docbook.org/xslt/ns/template}select-target-lang" class="solar"><span class="tcall">t:select-target-lang</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3568"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">fallback.index</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$fallback.index</span><span class="whitespace" start="16"> </span><span class="op" start="17">-</span><span class="whitespace" start="18"> </span><span class="numeric" start="19">1</span><span class="z">"</span><span id="wx3586" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3588"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">olink.fallback.sequence</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$rest</span><span class="z">"</span><span id="wx3602" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx3606" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx3610" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3612"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx3618" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx3622" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx3626" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w3628"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}select-olink-lang-fallback">t:select-olink-lang-fallback</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3638"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.lang">olink.lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx3654" class="sc">/&gt;</span></span><span class="txt">

qq</span><span class="z">&lt;!--</span><span class="cm"> Prefer language of the olink element </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w3660"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-concat" class="solar"><span class="function" start="1" pair-end="110" select="quick">concat</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-normalize-space" class="solar"><span class="function" start="8" pair-end="104" select="quick">normalize-space</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-concat" class="solar"><span class="function" start="24" pair-end="103" select="quick">concat</span></a><span class="parenthesis">(</span><span class="variable" start="31" select="quick">$olink.lang</span><span class="op" start="42">,</span><span class="whitespace" start="43"> </span><span class="op">'</span><span class="literal" start="44"> </span><span class="op">'</span><span class="op" start="47">,</span><span class="whitespace" start="48"> 
££££££££££££££££££££££qq</span><a href="olink.xsl.html#v?olink.lang.fallback.sequence" class="solar"><span class="variable" start="74" select="quick">$olink.lang.fallback.sequence</span></a><span class="parenthesis" start="103">)</span><span class="parenthesis" start="104">)</span><span class="op" start="105">,</span><span class="whitespace" start="106"> </span><span class="op">'</span><span class="literal" start="107"> </span><span class="op">'</span><span class="parenthesis" start="110">)</span><span class="z">"</span><span id="wx3690" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx3694" class="ec">&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> Returns the complete olink href value if found </span><span class="z">--&gt;</span><span class="txt">
</span><span class="ww" id="w3700"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}make-olink-href">t:make-olink-href</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3710"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.key">olink.key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx3726" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3728"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.database">target.database</span><span class="z">"</span><span id="wx3736" class="sc">/&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w3738"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.key</span><span class="whitespace" start="11"> </span><span class="op" start="12">!=</span><span class="whitespace" start="14"> </span><span class="op">'</span><span class="literal" start="15"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3754"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.href">target.href</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3764"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3774"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="axis" start="34">@</span><span class="qname" start="35" select="quick">href</span><span class="z">"</span><span id="wx3793" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx3797" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx3801" class="ec">&gt;</span></span><span class="txt">
qq
qq</span><span class="ww" id="w3803"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetdoc">targetdoc</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3813"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-substring-before" class="solar"><span class="function" start="1" pair-end="33" select="quick">substring-before</span></a><span class="parenthesis">(</span><span class="variable" start="18" select="quick">$olink.key</span><span class="op" start="28">,</span><span class="whitespace" start="29"> </span><span class="op">'</span><span class="literal" start="30">/</span><span class="op">'</span><span class="parenthesis" start="33">)</span><span class="z">"</span><span id="wx3829" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx3833" class="ec">&gt;</span></span><span class="txt">
qq
qq</span><span class="z">&lt;!--</span><span class="cm"> Does the target database use a sitemap? </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w3839"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?use.sitemap">use.sitemap</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3849"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3853"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="step" start="17">//</span><span class="qname" start="19" select="quick">sitemap</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">1</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx3867" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3869"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">0</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx3875" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx3879" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx3883" class="ec">&gt;</span></span><span class="txt">
qq
qq</span><span class="z">&lt;!--</span><span class="cm"> Get the baseuri for this targetptr </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w3889"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?baseuri">baseuri</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3899"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Does the database use a sitemap? </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w3907"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$use.sitemap</span><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3921"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Was current.docid parameter set? </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w3929"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="1" select="quick">$current.docid</span></a><span class="whitespace" start="15"> </span><span class="op" start="16">!=</span><span class="whitespace" start="18"> </span><span class="op">'</span><span class="literal" start="19"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Was it found in the database? </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w3949"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?currentdoc.key">currentdoc.key</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3959"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w3969"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="76" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetdoc-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21">
££££££££££££££££££££££qq</span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="62" select="quick">$current.docid</span></a><span class="parenthesis" start="76">)</span><span class="step" start="77">/</span><span class="axis" start="78">@</span><span class="qname" start="79" select="quick">targetdoc</span><span class="z">"</span><span id="wx3988" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx3992" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx3996" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w3998"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4002"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$currentdoc.key</span><span class="whitespace" start="16"> </span><span class="op" start="17">!=</span><span class="whitespace" start="19"> </span><span class="op">'</span><span class="literal" start="20"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4018"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4028"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#t?{http://docbook.org/xslt/ns/template}targetpath" class="solar"><span class="tcall">t:targetpath</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4038"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">dirnode</span><span class="z">"</span><span class="z"> 
££££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="36" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetdoc-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="22" select="quick">$current.docid</span></a><span class="parenthesis" start="36">)</span><span class="step" start="37">/</span><span class="axis" start="38">parent::</span><span class="qname" start="46" select="quick">dir</span><span class="z">"</span><span id="wx4063" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4065"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">targetdoc</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetdoc</span><span class="z">"</span><span id="wx4079" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx4083" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each </span><span id="wx4087" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx4091" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4093"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4097"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4101"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink error: cannot compute relative </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx4107" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4109"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">sitemap path because $current.docid '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx4115" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4117"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="1" select="quick">$current.docid</span></a><span class="z">"</span><span id="wx4125" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4127"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' not found in target database.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx4133" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx4137" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx4141" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx4145" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx4149" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4151"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4155"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4159"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink warning: cannot compute relative </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx4165" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4167"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">sitemap path without $current.docid parameter</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx4173" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx4177" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx4181" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx4185" class="ec">&gt;</span></span><span class="txt"> 
qq</span><span class="z">&lt;!--</span><span class="cm"> In either case, add baseuri from its document entry</span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w4191"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?docbaseuri">docbaseuri</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4201"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4211"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetdoc-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$targetdoc</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="axis" start="34">@</span><span class="qname" start="35" select="quick">baseuri</span><span class="z">"</span><span id="wx4230" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx4234" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx4238" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4240"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$docbaseuri</span><span class="whitespace" start="12"> </span><span class="op" start="13">!=</span><span class="whitespace" start="15"> </span><span class="op">'</span><span class="literal" start="16"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4256"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$docbaseuri</span><span class="z">"</span><span id="wx4264" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx4268" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx4272" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> No database sitemap in use </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w4278"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Just use any baseuri from its document entry </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w4286"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?docbaseuri">docbaseuri</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4296"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4306"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetdoc-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$targetdoc</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="axis" start="34">@</span><span class="qname" start="35" select="quick">baseuri</span><span class="z">"</span><span id="wx4325" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx4329" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx4333" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4335"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$docbaseuri</span><span class="whitespace" start="12"> </span><span class="op" start="13">!=</span><span class="whitespace" start="15"> </span><span class="op">'</span><span class="literal" start="16"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4351"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$docbaseuri</span><span class="z">"</span><span id="wx4359" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx4363" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx4367" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx4371" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx4375" class="ec">&gt;</span></span><span class="txt">
qq
qq</span><span class="z">&lt;!--</span><span class="cm"> Form the href information </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w4381"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$baseuri</span><span class="whitespace" start="9"> </span><span class="op" start="10">!=</span><span class="whitespace" start="12"> </span><span class="op">'</span><span class="literal" start="13"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4397"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$baseuri</span><span class="z">"</span><span id="wx4405" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4407"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-substring" class="solar"><span class="function" start="1" pair-end="27" select="quick">substring</span></a><span class="parenthesis">(</span><span class="variable" start="11" select="quick">$target.href</span><span class="op" start="23">,</span><span class="numeric" start="24">1</span><span class="op" start="25">,</span><span class="numeric" start="26">1</span><span class="parenthesis" start="27">)</span><span class="whitespace" start="28"> </span><span class="op" start="29">!=</span><span class="whitespace" start="31"> </span><span class="op">'</span><span class="literal" start="32">#</span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm">xsl:text&gt;/&lt;/xsl:text</span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx4436" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx4440" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> optionally turn off frag for PDF references </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w4446"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="1" pair-end="194" select="quick">not</span></a><span class="parenthesis">(</span><a href="olink.xsl.html#v?insert.olink.pdf.frag" class="solar"><span class="variable" start="5" select="quick">$insert.olink.pdf.frag</span></a><span class="whitespace" start="27"> </span><span class="op" start="28">=</span><span class="whitespace" start="29"> </span><span class="numeric" start="30">0</span><span class="whitespace" start="31"> </span><span class="op" start="32">and</span><span class="whitespace" start="35">
££££££££££££££qq</span><a href="http://www.w3.org/TR/xpath-functions/#func-translate" class="solar"><span class="function" start="46" pair-end="138" select="quick">translate</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-substring" class="solar"><span class="function" start="56" pair-end="103" select="quick">substring</span></a><span class="parenthesis">(</span><span class="variable" start="66" select="quick">$baseuri</span><span class="op" start="74">,</span><span class="whitespace" start="75"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-string-length" class="solar"><span class="function" start="76" pair-end="98" select="quick">string-length</span></a><span class="parenthesis">(</span><span class="variable" start="90" select="quick">$baseuri</span><span class="parenthesis" start="98">)</span><span class="whitespace" start="99"> </span><span class="op" start="100">-</span><span class="whitespace" start="101"> </span><span class="numeric" start="102">3</span><span class="parenthesis" start="103">)</span><span class="op" start="104">,</span><span class="whitespace" start="105">
££££££££££££££qq</span><span class="op">'</span><span class="literal" start="126">PDF</span><span class="op">'</span><span class="op" start="131">,</span><span class="whitespace" start="132"> </span><span class="op">'</span><span class="literal" start="133">pdf</span><span class="op">'</span><span class="parenthesis" start="138">)</span><span class="whitespace" start="139"> </span><span class="op" start="140">=</span><span class="whitespace" start="141"> </span><span class="op">'</span><span class="literal" start="142">.pdf</span><span class="op">'</span><span class="whitespace" start="148">
££££££££££££££qq</span><span class="op" start="159">and</span><span class="whitespace" start="162"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-starts-with" class="solar"><span class="function" start="163" pair-end="192" select="quick">starts-with</span></a><span class="parenthesis">(</span><span class="variable" start="175" select="quick">$target.href</span><span class="op" start="187">,</span><span class="whitespace" start="188"> </span><span class="op">'</span><span class="literal" start="189">#</span><span class="op">'</span><span class="parenthesis" start="192">)</span><span class="whitespace" start="193"> </span><span class="parenthesis" start="194">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4512"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.href</span><span class="z">"</span><span id="wx4520" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx4524" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx4528" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx4532" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w4534"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}olink-hottext">t:olink-hottext</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4544"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.database">target.database</span><span class="z">"</span><span id="wx4552" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4554"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.lang">olink.lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx4570" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4572"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.key">olink.key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx4588" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4590"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?referrer">referrer</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span id="wx4604" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4606"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?xrefstyle">xrefstyle</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xrefstyle</span><span class="z">"</span><span id="wx4621" class="sc">/&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w4623"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> If it has elements or text (not just PI or comment) </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w4631"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">child::</span><span class="node" start="8" pair-end="13" select="quick">text</span><span class="parenthesis">(</span><span class="parenthesis" start="13">)</span><span class="whitespace" start="14"> </span><span class="op" start="15">or</span><span class="whitespace" start="17"> </span><span class="axis" start="18">child::</span><span class="qname" start="25" select="quick">*</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4649"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span id="wx4651" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx4655" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4657"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.key</span><span class="whitespace" start="11"> </span><span class="op" start="12">!=</span><span class="whitespace" start="14"> </span><span class="op">'</span><span class="literal" start="15"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Get the xref text for this record </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w4677"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?xref.text">xref.text</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4687"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4697"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="qname" start="34" select="quick">xreftext</span><span class="z">"</span><span id="wx4715" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx4719" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx4723" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w4725"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?xref.number">xref.number</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4735"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4745"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="axis" start="34">@</span><span class="qname" start="35" select="quick">number</span><span class="z">"</span><span id="wx4764" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx4768" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx4772" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w4774"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.elem">target.elem</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4784"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4794"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="axis" start="34">@</span><span class="qname" start="35" select="quick">element</span><span class="z">"</span><span id="wx4813" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx4817" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx4821" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w4823"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?lang">lang</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4833"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?candidate">candidate</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4843"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4853"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="axis" start="34">@</span><span class="qname" start="35" select="quick">lang</span><span class="z">"</span><span id="wx4872" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx4876" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx4880" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4882"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4886"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$candidate</span><span class="whitespace" start="11"> </span><span class="op" start="12">!=</span><span class="whitespace" start="14"> </span><span class="op">'</span><span class="literal" start="15"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4902"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$candidate</span><span class="z">"</span><span id="wx4910" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx4914" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w4916"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4920"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.lang</span><span class="z">"</span><span id="wx4928" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx4932" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx4936" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx4940" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w4942"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetdoc">targetdoc</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4952"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-substring-before" class="solar"><span class="function" start="1" pair-end="33" select="quick">substring-before</span></a><span class="parenthesis">(</span><span class="variable" start="18" select="quick">$olink.key</span><span class="op" start="28">,</span><span class="whitespace" start="29"> </span><span class="op">'</span><span class="literal" start="30">/</span><span class="op">'</span><span class="parenthesis" start="33">)</span><span class="z">"</span><span id="wx4968" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx4972" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w4974"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w4978"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="whitespace" start="11"> </span><span class="op" start="12">!=</span><span class="whitespace" start="14"> </span><span class="op">'</span><span class="literal" start="15"></span><span class="op">'</span><span class="whitespace" start="17"> </span><span class="op" start="18">and</span><span class="whitespace" start="21">
££££££££££££££££qq</span><a href="http://www.w3.org/TR/xpath-functions/#func-starts-with" class="solar"><span class="function" start="46" pair-end="96" select="quick">starts-with</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-normalize-space" class="solar"><span class="function" start="58" pair-end="84" select="quick">normalize-space</span></a><span class="parenthesis">(</span><span class="variable" start="74" select="quick">$xrefstyle</span><span class="parenthesis" start="84">)</span><span class="op" start="85">,</span><span class="whitespace" start="86"> </span><span class="op">'</span><span class="literal" start="87">select:</span><span class="op">'</span><span class="parenthesis" start="96">)</span><span class="whitespace" start="97"> </span><span class="op" start="98">and</span><span class="whitespace" start="101">
££££££££££££££££qq</span><span class="parenthesis" start="126" pair-end="218" select="quick">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-contains" class="solar"><span class="function" start="127" pair-end="159" select="quick">contains</span></a><span class="parenthesis">(</span><span class="variable" start="136" select="quick">$xrefstyle</span><span class="op" start="146">,</span><span class="whitespace" start="147"> </span><span class="op">'</span><span class="literal" start="148">nodocname</span><span class="op">'</span><span class="parenthesis" start="159">)</span><span class="whitespace" start="160"> </span><span class="op" start="161">or</span><span class="whitespace" start="163">
££££££££££££££££qq</span><a href="http://www.w3.org/TR/xpath-functions/#func-contains" class="solar"><span class="function" start="188" pair-end="217" select="quick">contains</span></a><span class="parenthesis">(</span><span class="variable" start="197" select="quick">$xrefstyle</span><span class="op" start="207">,</span><span class="whitespace" start="208"> </span><span class="op">'</span><span class="literal" start="209">nopage</span><span class="op">'</span><span class="parenthesis" start="217">)</span><span class="parenthesis" start="218">)</span><span class="whitespace" start="219"> </span><span class="op" start="220">and</span><span class="whitespace" start="223">
££££££££££££££££qq</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="248" pair-end="281" select="quick">not</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-contains" class="solar"><span class="function" start="252" pair-end="280" select="quick">contains</span></a><span class="parenthesis">(</span><span class="variable" start="261" select="quick">$xrefstyle</span><span class="op" start="271">,</span><span class="whitespace" start="272"> </span><span class="op">'</span><span class="literal" start="273">title</span><span class="op">'</span><span class="parenthesis" start="280">)</span><span class="parenthesis" start="281">)</span><span class="whitespace" start="282"> </span><span class="op" start="283">and</span><span class="whitespace" start="286">
££££££££££££££££qq</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="311" pair-end="344" select="quick">not</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-contains" class="solar"><span class="function" start="315" pair-end="343" select="quick">contains</span></a><span class="parenthesis">(</span><span class="variable" start="324" select="quick">$xrefstyle</span><span class="op" start="334">,</span><span class="whitespace" start="335"> </span><span class="op">'</span><span class="literal" start="336">label</span><span class="op">'</span><span class="parenthesis" start="343">)</span><span class="parenthesis" start="344">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt"> 
qq</span><span class="ww" id="w5065"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref.text</span><span class="z">"</span><span id="wx5073" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx5077" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5079"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="whitespace" start="11"> </span><span class="op" start="12">!=</span><span class="whitespace" start="14"> </span><span class="op">'</span><span class="literal" start="15"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5095"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5109"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5113"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">xrefstyle is '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx5119" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5121"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="z">"</span><span id="wx5129" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5131"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">'.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx5137" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx5141" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx5145" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5147"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?template">template</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5157"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5161"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-starts-with" class="solar"><span class="function" start="1" pair-end="93" select="quick">starts-with</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-normalize-space" class="solar"><span class="function" start="13" pair-end="39" select="quick">normalize-space</span></a><span class="parenthesis">(</span><span class="variable" start="29" select="quick">$xrefstyle</span><span class="parenthesis" start="39">)</span><span class="op" start="40">,</span><span class="whitespace" start="41">
££££££££££££££££qq</span><span class="op">'</span><span class="literal" start="84">select:</span><span class="op">'</span><span class="parenthesis" start="93">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5182"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="gentext.xsl.html#t?make-gentext-template" class="solar"><span class="tcall">make-gentext-template</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5192"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">xrefstyle</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="z">"</span><span id="wx5206" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5208"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">purpose</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">olink</span><span class="op">'</span><span class="z">"</span><span id="wx5224" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5226"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">referrer</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span id="wx5240" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5242"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">target.elem</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx5256" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx5260" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx5264" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5266"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-starts-with" class="solar"><span class="function" start="1" pair-end="95" select="quick">starts-with</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-normalize-space" class="solar"><span class="function" start="13" pair-end="39" select="quick">normalize-space</span></a><span class="parenthesis">(</span><span class="variable" start="29" select="quick">$xrefstyle</span><span class="parenthesis" start="39">)</span><span class="op" start="40">,</span><span class="whitespace" start="41">
££££££££££££££££qq</span><span class="op">'</span><span class="literal" start="84">template:</span><span class="op">'</span><span class="parenthesis" start="95">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5287"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-substring-after" class="solar"><span class="function" start="1" pair-end="91" select="quick">substring-after</span></a><span class="parenthesis">(</span><span class="whitespace" start="17">
££££££££££££££££££££££qq</span><a href="http://www.w3.org/TR/xpath-functions/#func-normalize-space" class="solar"><span class="function" start="51" pair-end="77" select="quick">normalize-space</span></a><span class="parenthesis">(</span><span class="variable" start="67" select="quick">$xrefstyle</span><span class="parenthesis" start="77">)</span><span class="op" start="78">,</span><span class="whitespace" start="79"> </span><span class="op">'</span><span class="literal" start="80">template:</span><span class="op">'</span><span class="parenthesis" start="91">)</span><span class="z">"</span><span id="wx5307" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx5311" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5313"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Look for Gentext template with @style attribute </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Must compare to no style value because gentext.template
qqfalls back to no style </span><span class="z">--&gt;</span><span class="txt">

qq</span><span class="ww" id="w5325"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?xref-context">xref-context</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5335"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="l10n.xsl.html#t?gentext-template" class="solar"><span class="tcall">gentext-template</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5345"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">context</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">xref</span><span class="op">'</span><span class="z">"</span><span id="wx5361" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5363"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">name</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx5377" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5379"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$lang</span><span class="z">"</span><span id="wx5393" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx5397" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx5401" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w5403"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?styled-xref-context">styled-xref-context</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5413"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="l10n.xsl.html#t?gentext-template" class="solar"><span class="tcall">gentext-template</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5423"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">context</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">xref</span><span class="op">'</span><span class="z">"</span><span id="wx5439" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5441"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">name</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx5455" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5457"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$lang</span><span class="z">"</span><span id="wx5471" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5473"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">xrefstyle</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="z">"</span><span id="wx5487" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx5491" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx5495" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w5497"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?xref-number-context">xref-number-context</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5507"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="l10n.xsl.html#t?gentext-template" class="solar"><span class="tcall">gentext-template</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5517"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">context</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">xref-number</span><span class="op">'</span><span class="z">"</span><span id="wx5533" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5535"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">name</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx5549" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5551"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$lang</span><span class="z">"</span><span id="wx5565" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx5569" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx5573" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w5575"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?styled-xref-number-context">styled-xref-number-context</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5585"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="l10n.xsl.html#t?gentext-template" class="solar"><span class="tcall">gentext-template</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5595"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">context</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">xref-number</span><span class="op">'</span><span class="z">"</span><span id="wx5611" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5613"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">name</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx5627" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5629"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$lang</span><span class="z">"</span><span id="wx5643" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5645"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">xrefstyle</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="z">"</span><span id="wx5659" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx5663" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx5667" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w5669"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?xref-number-and-title-context">xref-number-and-title-context</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5679"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="l10n.xsl.html#t?gentext-template" class="solar"><span class="tcall">gentext-template</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5689"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">context</span><span class="z">"</span><span class="z"> 
££££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">xref-number-and-title</span><span class="op">'</span><span class="z">"</span><span id="wx5705" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5707"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">name</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx5721" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5723"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$lang</span><span class="z">"</span><span id="wx5737" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx5741" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx5745" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w5747"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?styled-xref-number-and-title-context">styled-xref-number-and-title-context</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5757"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="l10n.xsl.html#t?gentext-template" class="solar"><span class="tcall">gentext-template</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5767"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">context</span><span class="z">"</span><span class="z"> 
££££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">xref-number-and-title</span><span class="op">'</span><span class="z">"</span><span id="wx5783" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5785"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">name</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx5799" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5801"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$lang</span><span class="z">"</span><span id="wx5815" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5817"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">xrefstyle</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="z">"</span><span id="wx5831" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx5835" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx5839" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w5841"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5845"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref-number-and-title-context</span><span class="whitespace" start="31"> </span><span class="op" start="32">!=</span><span class="whitespace" start="34"> 
££££££££££££££££qq</span><span class="variable" start="69" select="quick">$styled-xref-number-and-title-context</span><span class="whitespace" start="106"> </span><span class="op" start="107">and</span><span class="whitespace" start="110">
££££££££££££££££qq</span><span class="variable" start="144" select="quick">$xref.number</span><span class="whitespace" start="156"> </span><span class="op" start="157">!=</span><span class="whitespace" start="159"> </span><span class="op">'</span><span class="literal" start="160"></span><span class="op">'</span><span class="whitespace" start="162"> </span><span class="op" start="163">and</span><span class="whitespace" start="166">
££££££££££££££££qq</span><a href="ram.xsl.html#v?xref.with.number.and.title" class="solar"><span class="variable" start="200" select="quick">$xref.with.number.and.title</span></a><span class="whitespace" start="227"> </span><span class="op" start="228">!=</span><span class="whitespace" start="230"> </span><span class="numeric" start="231">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5877"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$styled-xref-number-and-title-context</span><span class="z">"</span><span id="wx5885" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx5889" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5891"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref-number-context</span><span class="whitespace" start="21"> </span><span class="op" start="22">!=</span><span class="whitespace" start="24"> 
££££££££££££££££qq</span><span class="variable" start="59" select="quick">$styled-xref-number-context</span><span class="whitespace" start="86"> </span><span class="op" start="87">and</span><span class="whitespace" start="90">
££££££££££££££££qq</span><span class="variable" start="124" select="quick">$xref.number</span><span class="whitespace" start="136"> </span><span class="op" start="137">!=</span><span class="whitespace" start="139"> </span><span class="op">'</span><span class="literal" start="140"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5915"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$styled-xref-number-context</span><span class="z">"</span><span id="wx5923" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx5927" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5929"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref-context</span><span class="whitespace" start="14"> </span><span class="op" start="15">!=</span><span class="whitespace" start="17"> </span><span class="variable" start="18" select="quick">$styled-xref-context</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5943"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$styled-xref-context</span><span class="z">"</span><span id="wx5951" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx5955" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w5957"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref-number-and-title-context</span><span class="whitespace" start="31"> </span><span class="op" start="32">!=</span><span class="whitespace" start="34"> </span><span class="op">'</span><span class="literal" start="35"></span><span class="op">'</span><span class="whitespace" start="37"> </span><span class="op" start="38">and</span><span class="whitespace" start="41">
££££££££££££££££qq</span><span class="variable" start="75" select="quick">$xref.number</span><span class="whitespace" start="87"> </span><span class="op" start="88">!=</span><span class="whitespace" start="90"> </span><span class="op">'</span><span class="literal" start="91"></span><span class="op">'</span><span class="whitespace" start="93"> </span><span class="op" start="94">and</span><span class="whitespace" start="97">
££££££££££££££££qq</span><a href="ram.xsl.html#v?xref.with.number.and.title" class="solar"><span class="variable" start="131" select="quick">$xref.with.number.and.title</span></a><span class="whitespace" start="158"> </span><span class="op" start="159">!=</span><span class="whitespace" start="161"> </span><span class="numeric" start="162">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w5991"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref-number-and-title-context</span><span class="z">"</span><span id="wx5999" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6001"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6011"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6015"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink error: no gentext template</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6021" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6023"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt"> exists for xrefstyle '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6029" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6031"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="z">"</span><span id="wx6039" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6041"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' for element '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6047" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6049"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx6057" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6059"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' in language '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6065" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6067"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$lang</span><span class="z">"</span><span id="wx6075" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6077"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' in context 'xref-number-and-title</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6083" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6085"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">'. Using template without @style.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6091" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx6095" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx6099" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx6103" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6105"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref-number-context</span><span class="whitespace" start="21"> </span><span class="op" start="22">!=</span><span class="whitespace" start="24"> </span><span class="op">'</span><span class="literal" start="25"></span><span class="op">'</span><span class="whitespace" start="27"> </span><span class="op" start="28">and</span><span class="whitespace" start="31">
££££££££££££££££qq</span><span class="variable" start="65" select="quick">$xref.number</span><span class="whitespace" start="77"> </span><span class="op" start="78">!=</span><span class="whitespace" start="80"> </span><span class="op">'</span><span class="literal" start="81"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6131"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref-number-context</span><span class="z">"</span><span id="wx6139" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6141"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6151"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6155"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink error: no gentext template</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6161" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6163"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt"> exists for xrefstyle '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6169" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6171"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="z">"</span><span id="wx6179" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6181"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' for element '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6187" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6189"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx6197" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6199"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' in language '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6205" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6207"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$lang</span><span class="z">"</span><span id="wx6215" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6217"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' in context 'xref-number</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6223" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6225"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">'. Using template without @style.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6231" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx6235" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx6239" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx6243" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6245"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref-context</span><span class="whitespace" start="14"> </span><span class="op" start="15">!=</span><span class="whitespace" start="17"> </span><span class="op">'</span><span class="literal" start="18"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6261"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref-context</span><span class="z">"</span><span id="wx6269" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6271"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6281"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6285"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink error: no gentext template</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6291" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6293"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt"> exists for xrefstyle '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6299" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6301"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="z">"</span><span id="wx6309" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6311"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' for element '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6317" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6319"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx6327" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6329"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' in language '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6335" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6337"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$lang</span><span class="z">"</span><span id="wx6345" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6347"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' in context 'xref</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6353" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6355"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">'. Using template without @style.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6361" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx6365" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx6369" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx6373" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6375"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6379"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6383"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink error: no gentext template</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6389" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6391"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt"> exists for xrefstyle '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6397" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6399"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="z">"</span><span id="wx6407" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6409"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' for element '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6415" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6417"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx6425" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6427"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">' in language '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6433" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6435"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$lang</span><span class="z">"</span><span id="wx6443" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6445"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">'. Trying '%t'.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6451" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx6455" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6457"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">%t</span><span class="op">'</span><span class="z">"</span><span id="wx6467" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx6471" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx6475" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx6479" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx6483" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx6487" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w6489"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?olink.debug" class="solar"><span class="variable" start="1" select="quick">$olink.debug</span></a><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="numeric" start="17">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6503"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6507"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink debug: xrefstyle template is '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6513" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6515"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$template</span><span class="z">"</span><span id="wx6523" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6525"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">'.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx6531" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx6535" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx6539" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w6541"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="gentext.xsl.html#t?substitute-markup" class="solar"><span class="tcall">substitute-markup</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6551"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">template</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$template</span><span class="z">"</span><span id="wx6565" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6567"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6577"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6587"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="qname" start="34" select="quick">ttl</span><span class="z">"</span><span id="wx6605" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx6609" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:with-param</span><span id="wx6613" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6615"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">label</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6625"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6635"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="axis" start="34">@</span><span class="qname" start="35" select="quick">number</span><span class="z">"</span><span id="wx6654" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx6658" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:with-param</span><span id="wx6662" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6664"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">pagenumber</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6674"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6684"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="axis" start="34">@</span><span class="qname" start="35" select="quick">page</span><span class="z">"</span><span id="wx6703" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx6707" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:with-param</span><span id="wx6711" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6713"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">docname</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6723"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6733"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetdoc-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$targetdoc</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="qname" start="34" select="quick">div</span><span class="filter" start="37" pair-end="39" select="quick">[</span><span class="numeric" start="38">1</span><span class="filter" start="39">]</span><span class="step" start="40">/</span><span class="qname" start="41" select="quick">ttl</span><span class="z">"</span><span id="wx6756" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx6760" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:with-param</span><span id="wx6764" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx6768" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx6772" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w6774"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#v?use.local.olink.style" class="solar"><span class="variable" start="1" select="quick">$use.local.olink.style</span></a><span class="whitespace" start="23"> </span><span class="op" start="24">!=</span><span class="whitespace" start="26"> </span><span class="numeric" start="27">0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">

qq</span><span class="ww" id="w6788"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?template">template</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6798"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="l10n.xsl.html#t?gentext-template" class="solar"><span class="tcall">gentext-template</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6808"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">context</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">xref</span><span class="op">'</span><span class="z">"</span><span id="wx6824" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6826"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">name</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.elem</span><span class="z">"</span><span id="wx6840" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6842"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$lang</span><span class="z">"</span><span id="wx6856" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx6860" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx6864" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w6866"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="gentext.xsl.html#t?substitute-markup" class="solar"><span class="tcall">substitute-markup</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6876"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">template</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$template</span><span class="z">"</span><span id="wx6890" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6892"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6902"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6912"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="qname" start="34" select="quick">ttl</span><span class="z">"</span><span id="wx6930" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx6934" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:with-param</span><span id="wx6938" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6940"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">label</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6950"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w6960"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="axis" start="34">@</span><span class="qname" start="35" select="quick">number</span><span class="z">"</span><span id="wx6979" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx6983" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:with-param</span><span id="wx6987" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx6991" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx6995" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w6997"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref.text</span><span class="whitespace" start="11"> </span><span class="op" start="12">!=</span><span class="op">'</span><span class="literal" start="14"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7012"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xref.text</span><span class="z">"</span><span id="wx7020" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx7024" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7026"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7030"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7034"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink error: no generated text for </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx7040" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7042"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">targetdoc/targetptr/lang = '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx7048" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7050"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.key</span><span class="z">"</span><span id="wx7058" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7060"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">'.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx7066" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx7070" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7072"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">????</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx7078" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx7082" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx7086" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx7090" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7092"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">targetdoc</span><span class="whitespace" start="11"> </span><span class="op" start="12">!=</span><span class="whitespace" start="14"> </span><span class="op">'</span><span class="literal" start="15"></span><span class="op">'</span><span class="whitespace" start="17"> </span><span class="op" start="18">or</span><span class="whitespace" start="20"> </span><span class="axis" start="21">@</span><span class="qname" start="22" select="quick">targetptr</span><span class="whitespace" start="31"> </span><span class="op" start="32">!=</span><span class="whitespace" start="34"> </span><span class="op">'</span><span class="literal" start="35"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7120"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7124"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Olink error: no generated text for </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx7130" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7132"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">targetdoc/targetptr/lang = '</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx7138" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7140"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.key</span><span class="z">"</span><span id="wx7148" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7150"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">'.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx7156" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx7160" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7162"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">????</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx7168" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx7172" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7174"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> old style olink </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w7182"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="ef.xsl.html#t?{http://docbook.org/xslt/ns/template}olink-outline" class="solar"><span class="tcall">t:olink-outline</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7192"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">outline.base.uri</span><span class="z">"</span><span class="z">
££££££££££££££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-unparsed-entity-uri" class="solar"><span class="function" start="1" pair-end="34" select="quick">unparsed-entity-uri</span></a><span class="parenthesis">(</span><span class="axis" start="21">@</span><span class="qname" start="22" select="quick">targetdocent</span><span class="parenthesis" start="34">)</span><span class="z">"</span><span id="wx7210" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7212"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">localinfo</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">localinfo</span><span class="z">"</span><span id="wx7227" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7229"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">return</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">xreftext</span><span class="op">'</span><span class="z">"</span><span id="wx7245" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx7249" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx7253" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx7257" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx7261" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w7263"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">*</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">olink.docname.markup</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> No-op for now </span><span class="z">--&gt;</span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx7285" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w7287"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}targetpath">t:targetpath</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7297"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?dirnode">dirnode</span><span class="z">"</span><span id="wx7305" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7307"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetdoc">targetdoc</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx7323" class="sc">/&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> 
&lt;xsl:message&gt;dirnode is &lt;xsl:value-of select="$dirnode/@name"/&gt;&lt;/xsl:message&gt;
&lt;xsl:message&gt;targetdoc is &lt;xsl:value-of select="$targetdoc"/&gt;&lt;/xsl:message&gt;
</span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> recursive template generates path to olink target directory </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w7333"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Have we arrived at the final path step? </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w7341"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$dirnode</span><span class="step" start="9">/</span><span class="axis" start="10">child::</span><span class="qname" start="17" select="quick">document</span><span class="filter" start="25" pair-end="49" select="quick">[</span><span class="axis" start="26">@</span><span class="qname" start="27" select="quick">targetdoc</span><span class="whitespace" start="36"> </span><span class="op" start="37">=</span><span class="whitespace" start="38"> </span><span class="variable" start="39" select="quick">$targetdoc</span><span class="filter" start="49">]</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> We are done </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx7368" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Have we reached the top without a match? </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w7374"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-name" class="solar"><span class="function" start="1" pair-end="14" select="quick">name</span></a><span class="parenthesis">(</span><span class="variable" start="6" select="quick">$dirnode</span><span class="parenthesis" start="14">)</span><span class="whitespace" start="15"> </span><span class="op" start="16">!=</span><span class="whitespace" start="18"> </span><span class="op">'</span><span class="literal" start="19">dir</span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7393"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">Olink error: cannot locate targetdoc </span><span class="ww" id="w7397"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetdoc</span><span class="z">"</span><span id="wx7405" class="sc">/&gt;</span></span><span class="txt"> in sitemap</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx7409" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx7413" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Is the target in a descendant? </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w7419"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$dirnode</span><span class="step" start="9">/</span><span class="axis" start="10">descendant::</span><span class="qname" start="22" select="quick">document</span><span class="step" start="30">/</span><span class="axis" start="31">@</span><span class="qname" start="32" select="quick">targetdoc</span><span class="whitespace" start="41"> </span><span class="op" start="42">=</span><span class="whitespace" start="43"> </span><span class="variable" start="44" select="quick">$targetdoc</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7439"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?step">step</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$dirnode</span><span class="step" start="9">/</span><span class="axis" start="10">child::</span><span class="qname" start="17" select="quick">dir</span><span class="filter" start="20" pair-end="65" select="quick">[</span><span class="axis" start="21">descendant::</span><span class="qname" start="33" select="quick">document</span><span class="step" start="41">/</span><span class="axis" start="42">@</span><span class="qname" start="43" select="quick">targetdoc</span><span class="whitespace" start="52"> </span><span class="op" start="53">=</span><span class="whitespace" start="54"> </span><span class="variable" start="55" select="quick">$targetdoc</span><span class="filter" start="65">]</span><span class="z">"</span><span id="wx7467" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7469"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="z"> </span><span class="atneq">= </span><span class="z">"</span><span class="variable" start="1" select="quick">$step</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7480"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$step</span><span class="step" start="6">/</span><span class="axis" start="7">@</span><span class="qname" start="8" select="quick">name</span><span class="z">"</span><span id="wx7491" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7493"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">/</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx7499" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx7503" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Now recurse with the child </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w7509"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#t?{http://docbook.org/xslt/ns/template}targetpath" class="solar"><span class="tcall">t:targetpath</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7519"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">dirnode</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$step</span><span class="z">"</span><span id="wx7533" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7535"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">targetdoc</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetdoc</span><span class="z">"</span><span id="wx7549" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx7553" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx7557" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Otherwise we need to move up a step </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w7563"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7567"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$dirnode</span><span class="step" start="9">/</span><span class="axis" start="10">parent::</span><span class="qname" start="18" select="quick">dir</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7580"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">../</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx7586" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx7590" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7592"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#t?{http://docbook.org/xslt/ns/template}targetpath" class="solar"><span class="tcall">t:targetpath</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7602"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">dirnode</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$dirnode</span><span class="step" start="9">/</span><span class="axis" start="10">parent::</span><span class="qname" start="18" select="quick">*</span><span class="z">"</span><span id="wx7619" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7621"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">targetdoc</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$targetdoc</span><span class="z">"</span><span id="wx7635" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx7639" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx7643" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx7647" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx7651" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w7653"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}olink-page-citation">t:olink-page-citation</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7663"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.key">olink.key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx7679" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7681"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.lang">olink.lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">en</span><span class="op">'</span><span class="z">"</span><span id="wx7697" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7699"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.database">target.database</span><span class="z">"</span><span id="wx7707" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7709"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?linkend">linkend</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx7725" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7727"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?xrefstyle">xrefstyle</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xrefstyle</span><span class="z">"</span><span id="wx7742" class="sc">/&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w7744"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetdoc">targetdoc</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7754"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-substring-before" class="solar"><span class="function" start="1" pair-end="33" select="quick">substring-before</span></a><span class="parenthesis">(</span><span class="variable" start="18" select="quick">$olink.key</span><span class="op" start="28">,</span><span class="whitespace" start="29"> </span><span class="op">'</span><span class="literal" start="30">/</span><span class="op">'</span><span class="parenthesis" start="33">)</span><span class="z">"</span><span id="wx7770" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx7774" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w7776"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7780"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$linkend</span><span class="whitespace" start="9"> </span><span class="op" start="10">!=</span><span class="whitespace" start="12"> </span><span class="op">'</span><span class="literal" start="13"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7796"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="olink.xsl.html#t?{http://docbook.org/xslt/ns/template}xref-page-citation" class="solar"><span class="tcall">t:xref-page-citation</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7806"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">linkend</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$linkend</span><span class="z">"</span><span id="wx7820" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7822"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">target</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="19" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">id</span><span class="op">'</span><span class="op" start="9">,</span><span class="whitespace" start="10"> </span><span class="variable" start="11" select="quick">$linkend</span><span class="parenthesis" start="19">)</span><span class="z">"</span><span id="wx7844" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7846"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">xrefstyle</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$xrefstyle</span><span class="z">"</span><span id="wx7860" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx7864" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx7868" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w7870"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="1" pair-end="185" select="quick">not</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-starts-with" class="solar"><span class="function" start="5" pair-end="79" select="quick">starts-with</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-normalize-space" class="solar"><span class="function" start="17" pair-end="43" select="quick">normalize-space</span></a><span class="parenthesis">(</span><span class="variable" start="33" select="quick">$xrefstyle</span><span class="parenthesis" start="43">)</span><span class="op" start="44">,</span><span class="whitespace" start="45">
££££££££££££££££qq</span><span class="op">'</span><span class="literal" start="70">select:</span><span class="op">'</span><span class="parenthesis" start="79">)</span><span class="whitespace" start="80"> 
££££££££££££££££qq</span><span class="op" start="98">and</span><span class="whitespace" start="101"> </span><span class="parenthesis" start="102" pair-end="184" select="quick">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-contains" class="solar"><span class="function" start="103" pair-end="130" select="quick">contains</span></a><span class="parenthesis">(</span><span class="variable" start="112" select="quick">$xrefstyle</span><span class="op" start="122">,</span><span class="whitespace" start="123"> </span><span class="op">'</span><span class="literal" start="124">page</span><span class="op">'</span><span class="parenthesis" start="130">)</span><span class="whitespace" start="131">
££££££££££££££££qq</span><span class="op" start="153">or</span><span class="whitespace" start="155"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-contains" class="solar"><span class="function" start="156" pair-end="183" select="quick">contains</span></a><span class="parenthesis">(</span><span class="variable" start="165" select="quick">$xrefstyle</span><span class="op" start="175">,</span><span class="whitespace" start="176"> </span><span class="op">'</span><span class="literal" start="177">Page</span><span class="op">'</span><span class="parenthesis" start="183">)</span><span class="parenthesis" start="184">)</span><span class="parenthesis" start="185">)</span><span class="whitespace" start="186">
££££££££££££££££qq</span><span class="op" start="203">and</span><span class="whitespace" start="206"> </span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="207" select="quick">$current.docid</span></a><span class="whitespace" start="221"> </span><span class="op" start="222">!=</span><span class="whitespace" start="224"> </span><span class="op">'</span><span class="literal" start="225"></span><span class="op">'</span><span class="whitespace" start="227"> 
££££££££££££££££qq</span><span class="op" start="245">and</span><span class="whitespace" start="248"> </span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="249" select="quick">$current.docid</span></a><span class="whitespace" start="263"> </span><span class="op" start="264">!=</span><span class="whitespace" start="266"> </span><span class="variable" start="267" select="quick">$targetdoc</span><span class="whitespace" start="277">
££££££££££££££££qq</span><span class="op" start="294">and</span><span class="whitespace" start="297"> </span><span class="qname" start="298" select="quick">olink.insert.page.number</span><span class="whitespace" start="322"> </span><span class="op" start="323">=</span><span class="whitespace" start="324"> </span><span class="numeric" start="325">1</span><span class="whitespace" start="326"> </span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq
qq</span><span class="ww" id="w7947"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?page-number">page-number</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7957"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w7967"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="axis" start="34">@</span><span class="qname" start="35" select="quick">page</span><span class="z">"</span><span id="wx7986" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx7990" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx7994" class="ec">&gt;</span></span><span class="txt">
qq
qq</span><span class="ww" id="w7996"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$page-number</span><span class="whitespace" start="13"> </span><span class="op" start="14">!=</span><span class="whitespace" start="16"> </span><span class="op">'</span><span class="literal" start="17"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8012"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="gentext.xsl.html#t?substitute-markup" class="solar"><span class="tcall">substitute-markup</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8022"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">template</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8032"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="l10n.xsl.html#t?gentext-template" class="solar"><span class="tcall">gentext-template</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8042"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">name</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">olink.page.citation</span><span class="op">'</span><span class="z">"</span><span id="wx8058" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8060"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">context</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">xref</span><span class="op">'</span><span class="z">"</span><span id="wx8076" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8078"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.lang</span><span class="z">"</span><span id="wx8092" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx8096" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:with-param</span><span id="wx8100" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8102"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">pagenumber</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$page-number</span><span class="z">"</span><span id="wx8116" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx8120" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx8124" class="ec">&gt;</span></span><span class="txt">
qq
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx8128" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx8132" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx8136" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w8138"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}olink-document-citation">t:olink-document-citation</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8148"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.key">olink.key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx8164" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8166"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?olink.lang">olink.lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">en</span><span class="op">'</span><span class="z">"</span><span id="wx8182" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8184"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target.database">target.database</span><span class="z">"</span><span id="wx8192" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8194"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?xrefstyle">xrefstyle</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xrefstyle</span><span class="z">"</span><span id="wx8209" class="sc">/&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w8211"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?page">page</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8221"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8231"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetptr-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$olink.key</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="axis" start="34">@</span><span class="qname" start="35" select="quick">page</span><span class="z">"</span><span id="wx8250" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx8254" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx8258" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w8260"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetdoc">targetdoc</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8270"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-substring-before" class="solar"><span class="function" start="1" pair-end="33" select="quick">substring-before</span></a><span class="parenthesis">(</span><span class="variable" start="18" select="quick">$olink.key</span><span class="op" start="28">,</span><span class="whitespace" start="29"> </span><span class="op">'</span><span class="literal" start="30">/</span><span class="op">'</span><span class="parenthesis" start="33">)</span><span class="z">"</span><span id="wx8286" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx8290" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w8292"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?targetptr">targetptr</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8302"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-substring-before" class="solar"><span class="function" start="1" pair-end="55" select="quick">substring-before</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-substring-after" class="solar"><span class="function" start="18" pair-end="49" select="quick">substring-after</span></a><span class="parenthesis">(</span><span class="variable" start="34" select="quick">$olink.key</span><span class="op" start="44">,</span><span class="whitespace" start="45"> </span><span class="op">'</span><span class="literal" start="46">/</span><span class="op">'</span><span class="parenthesis" start="49">)</span><span class="op" start="50">,</span><span class="whitespace" start="51"> </span><span class="op">'</span><span class="literal" start="52">/</span><span class="op">'</span><span class="parenthesis" start="55">)</span><span class="z">"</span><span id="wx8326" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx8330" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="z">&lt;!--</span><span class="cm"> Don't add docname if pointing to root element </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w8336"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?rootptr">rootptr</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8346"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8356"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetdoc-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$targetdoc</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="qname" start="34" select="quick">div</span><span class="filter" start="37" pair-end="39" select="quick">[</span><span class="numeric" start="38">1</span><span class="filter" start="39">]</span><span class="step" start="40">/</span><span class="axis" start="41">@</span><span class="qname" start="42" select="quick">targetptr</span><span class="z">"</span><span id="wx8380" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx8384" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx8388" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w8390"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?docname">docname</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8400"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target.database</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8410"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> 
££££qq</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="32" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">targetdoc-key</span><span class="op">'</span><span class="op" start="20">,</span><span class="whitespace" start="21"> </span><span class="variable" start="22" select="quick">$targetdoc</span><span class="parenthesis" start="32">)</span><span class="step" start="33">/</span><span class="qname" start="34" select="quick">div</span><span class="filter" start="37" pair-end="39" select="quick">[</span><span class="numeric" start="38">1</span><span class="filter" start="39">]</span><span class="step" start="40">/</span><span class="qname" start="41" select="quick">ttl</span><span class="z">"</span><span id="wx8433" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx8437" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx8441" class="ec">&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w8443"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="1" pair-end="109" select="quick">not</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-starts-with" class="solar"><span class="function" start="5" pair-end="55" select="quick">starts-with</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-normalize-space" class="solar"><span class="function" start="17" pair-end="43" select="quick">normalize-space</span></a><span class="parenthesis">(</span><span class="variable" start="33" select="quick">$xrefstyle</span><span class="parenthesis" start="43">)</span><span class="op" start="44">,</span><span class="whitespace" start="45"> </span><span class="op">'</span><span class="literal" start="46">select:</span><span class="op">'</span><span class="parenthesis" start="55">)</span><span class="whitespace" start="56"> 
££££££££££££££qq</span><span class="op" start="72">and</span><span class="whitespace" start="75"> </span><span class="parenthesis" start="76" pair-end="108" select="quick">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-contains" class="solar"><span class="function" start="77" pair-end="107" select="quick">contains</span></a><span class="parenthesis">(</span><span class="variable" start="86" select="quick">$xrefstyle</span><span class="op" start="96">,</span><span class="whitespace" start="97"> </span><span class="op">'</span><span class="literal" start="98">docname</span><span class="op">'</span><span class="parenthesis" start="107">)</span><span class="parenthesis" start="108">)</span><span class="parenthesis" start="109">)</span><span class="whitespace" start="110">
££££££££££££££qq</span><span class="op" start="125">and</span><span class="whitespace" start="128"> </span><span class="parenthesis" start="129" pair-end="178" select="quick">(</span><a href="ram.xsl.html#v?olink.doctitle" class="solar"><span class="variable" start="130" select="quick">$olink.doctitle</span></a><span class="whitespace" start="145"> </span><span class="op" start="146">=</span><span class="whitespace" start="147"> </span><span class="op">'</span><span class="literal" start="148">yes</span><span class="op">'</span><span class="whitespace" start="153"> </span><span class="op" start="154">or</span><span class="whitespace" start="156"> </span><a href="ram.xsl.html#v?olink.doctitle" class="solar"><span class="variable" start="157" select="quick">$olink.doctitle</span></a><span class="whitespace" start="172"> </span><span class="op" start="173">=</span><span class="whitespace" start="174"> </span><span class="op">'</span><span class="literal" start="175">1</span><span class="op">'</span><span class="parenthesis" start="178">)</span><span class="whitespace" start="179">
££££££££££££££qq</span><span class="op" start="194">and</span><span class="whitespace" start="197"> </span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="198" select="quick">$current.docid</span></a><span class="whitespace" start="212"> </span><span class="op" start="213">!=</span><span class="whitespace" start="215"> </span><span class="op">'</span><span class="literal" start="216"></span><span class="op">'</span><span class="whitespace" start="218"> 
££££££££££££££qq</span><span class="op" start="234">and</span><span class="whitespace" start="237"> </span><span class="variable" start="238" select="quick">$rootptr</span><span class="whitespace" start="246"> </span><span class="op" start="247">!=</span><span class="whitespace" start="249"> </span><span class="variable" start="250" select="quick">$targetptr</span><span class="whitespace" start="260">
££££££££££££££qq</span><span class="op" start="275">and</span><span class="whitespace" start="278"> </span><a href="olink.xsl.html#v?current.docid" class="solar"><span class="variable" start="279" select="quick">$current.docid</span></a><span class="whitespace" start="293"> </span><span class="op" start="294">!=</span><span class="whitespace" start="296"> </span><span class="variable" start="297" select="quick">$targetdoc</span><span class="whitespace" start="307">
££££££££££££££qq</span><span class="op" start="322">and</span><span class="whitespace" start="325"> </span><span class="variable" start="326" select="quick">$docname</span><span class="whitespace" start="334"> </span><span class="op" start="335">!=</span><span class="whitespace" start="337"> </span><span class="op">'</span><span class="literal" start="338"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8539"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="gentext.xsl.html#t?substitute-markup" class="solar"><span class="tcall">substitute-markup</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8549"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">template</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8559"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="l10n.xsl.html#t?gentext-template" class="solar"><span class="tcall">gentext-template</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8569"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">name</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">olink.document.citation</span><span class="op">'</span><span class="z">"</span><span id="wx8585" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8587"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">context</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">xref</span><span class="op">'</span><span class="z">"</span><span id="wx8603" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8605"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">lang</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$olink.lang</span><span class="z">"</span><span id="wx8619" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx8623" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:with-param</span><span id="wx8627" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8629"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">docname</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$docname</span><span class="z">"</span><span id="wx8643" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8645"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">pagenumber</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$page</span><span class="z">"</span><span id="wx8659" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx8663" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx8667" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx8671" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w8673"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/template}xref-page-citation">t:xref-page-citation</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="z">&lt;!--</span><span class="cm"> Determine if this xref should have a page citation.
qqContext node is the xref or local olink element </span><span class="z">--&gt;</span><span class="txt">
qq</span><span class="ww" id="w8687"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?linkend">linkend</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">linkend</span><span class="z">"</span><span id="wx8702" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8704"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?target">target</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="1" pair-end="19" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="5">id</span><span class="op">'</span><span class="op" start="9">,</span><span class="whitespace" start="10"> </span><span class="variable" start="11" select="quick">$linkend</span><span class="parenthesis" start="19">)</span><span class="z">"</span><span id="wx8726" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ww" id="w8728"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?xrefstyle">xrefstyle</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">xrefstyle</span><span class="z">"</span><span id="wx8743" class="sc">/&gt;</span></span><span class="txt">

qq</span><span class="ww" id="w8745"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="1" pair-end="159" select="quick">not</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-starts-with" class="solar"><span class="function" start="5" pair-end="54" select="quick">starts-with</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-normalize-space" class="solar"><span class="function" start="17" pair-end="43" select="quick">normalize-space</span></a><span class="parenthesis">(</span><span class="variable" start="33" select="quick">$xrefstyle</span><span class="parenthesis" start="43">)</span><span class="op" start="44">,</span><span class="op">'</span><span class="literal" start="45">select:</span><span class="op">'</span><span class="parenthesis" start="54">)</span><span class="whitespace" start="55">
££££££££££££££qq</span><span class="op" start="72">and</span><span class="whitespace" start="75"> </span><span class="parenthesis" start="76" pair-end="158" select="quick">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-contains" class="solar"><span class="function" start="77" pair-end="104" select="quick">contains</span></a><span class="parenthesis">(</span><span class="variable" start="86" select="quick">$xrefstyle</span><span class="op" start="96">,</span><span class="whitespace" start="97"> </span><span class="op">'</span><span class="literal" start="98">page</span><span class="op">'</span><span class="parenthesis" start="104">)</span><span class="whitespace" start="105">
££££££££££££££qq</span><span class="op" start="127">or</span><span class="whitespace" start="129"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-contains" class="solar"><span class="function" start="130" pair-end="157" select="quick">contains</span></a><span class="parenthesis">(</span><span class="variable" start="139" select="quick">$xrefstyle</span><span class="op" start="149">,</span><span class="whitespace" start="150"> </span><span class="op">'</span><span class="literal" start="151">Page</span><span class="op">'</span><span class="parenthesis" start="157">)</span><span class="parenthesis" start="158">)</span><span class="parenthesis" start="159">)</span><span class="whitespace" start="160">
££££££££££££££qq</span><span class="op" start="177">and</span><span class="whitespace" start="180"> </span><span class="parenthesis" start="181" pair-end="269" select="quick">(</span><span class="whitespace" start="182"> </span><a href="ram.xsl.html#v?insert.xref.page.number" class="solar"><span class="variable" start="183" select="quick">$insert.xref.page.number</span></a><span class="whitespace" start="207"> </span><span class="op" start="208">=</span><span class="whitespace" start="209"> </span><span class="op">'</span><span class="literal" start="210">yes</span><span class="op">'</span><span class="whitespace" start="215"> 
££££££££££££££qq</span><span class="op" start="236">or</span><span class="whitespace" start="238"> </span><a href="ram.xsl.html#v?insert.xref.page.number" class="solar"><span class="variable" start="239" select="quick">$insert.xref.page.number</span></a><span class="whitespace" start="263"> </span><span class="op" start="264">=</span><span class="whitespace" start="265"> </span><span class="op">'</span><span class="literal" start="266">1</span><span class="op">'</span><span class="parenthesis" start="269">)</span><span class="whitespace" start="270">
££££££££££££££qq</span><span class="op" start="287">or</span><span class="whitespace" start="289"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="290" pair-end="308" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="variable" start="301" select="quick">$target</span><span class="parenthesis" start="308">)</span><span class="whitespace" start="309"> </span><span class="op" start="310">=</span><span class="whitespace" start="311"> </span><span class="op">'</span><span class="literal" start="312">para</span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8830"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$target</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">page.citation</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
qq</span><span class="ww" id="w8846"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">id</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$linkend</span><span class="z">"</span><span id="wx8860" class="sc">/&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:apply-templates</span><span id="wx8864" class="ec">&gt;</span></span><span class="txt">
qq</span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx8868" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx8872" class="ec">&gt;</span></span><span class="txt">

</span><span class="ez">&lt;/</span><span class="clxsl">xsl:stylesheet</span><span id="wx8876" class="ec">&gt;</span></span><span class="txt">

</span></p></div></body></html>