<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>XMLSpectrum output</title></head><body><div><pre class="spectrum" style="&#xA;    margin:0px;&#xA;    font-family:'Source Code Pro', monospace;&#xA;    font-size: 0.8em;&#xA;    white-space: pre-wrap;&#xA;    display: block;&#xA;    border: none thin;&#xA;    border-color: #405075;&#xA;    background-color:#f5f5f5;&#xA;    padding: 2px;&#xA;    margin-bottom:5px;&#xA;"><span class="z" style="color: #afbfcf">&lt;?</span><span class="pi" style="color: #566874">xml version="1.0" encoding="utf-8"</span><span class="z" style="color: #afbfcf">?&gt;</span><span class="txt" style="color: #ad95af">
</span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
XMLSpectrum by Phil Fearon Qutoric Limited 2012 (c)
http://qutoric.com
License: Apache 2.0 http://www.apache.org/licenses/LICENSE-2.0.html

Purpose: Syntax highlighter for XPath (text), XML, XSLT and XSD 1.1 file formats

Interface Functions:
====================
f:render(xml-content, is-xml, root-prefix)
loc:showXPath(text-content)
f:get-css(color-theme)
f:indent(spans, char-width)
f:link(spans, paths, location)

Interface Templates:
====================
&lt;xsl:template match="span" mode="markup"&gt;

Global Variables (for overriding)
=================================
w3c-xpath-functions-uri: location of resource proxy
font-name:               abbreviated font name [std|scp] default
                         is std for standard monospace - override
                         with 'scp' for 'Souce Code Pro'
                         font-family

</span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">

</span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:stylesheet</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">version</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">2.0</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">xmlns:xsl</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">http://www.w3.org/1999/XSL/Transform</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">xmlns:xs</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">http://www.w3.org/2001/XMLSchema</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">xmlns:loc</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">com.qutoric.sketchpath.functions</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">xmlns:css</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">css-defs.com</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">exclude-result-prefixes</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">loc f xs css c</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">xmlns</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">xmlns:c</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">http://xmlspectrum.colors.org</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">xmlns:f</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">internal</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color-theme</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">dark</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">force-newline</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">no</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">insert-newlines</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$force-newline</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">eq</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="19" style="color: #585858">yes</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">max-newline-length</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="numeric" start="1" style="color: #566874">80</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">resolved-theme</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="28" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$color-theme</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" start="18" style="color: #ddad60">eq</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="21" style="color: #585858">light</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" start="30" style="color: #ddad60">then</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="35" style="color: #585858">solarized-light</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="52" style="color: #ddad60">
                        </span><span class="op" start="53" style="color: #ddad60">else</span><span class="whitespace" start="57" style="color: #ddad60"> </span><span class="if" start="58" style="color: #ddad60">if</span><span class="whitespace" start="60" style="color: #ddad60"> </span><span class="parenthesis" start="61" pair-end="84" select="quick" style="color: #295f94">(</span><span class="variable" start="62" select="quick" style="color: #ad95af">$color-theme</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="op" start="75" style="color: #ddad60">eq</span><span class="whitespace" start="77" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="78" style="color: #585858">dark</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="84" style="color: #295f94">)</span><span class="whitespace" start="85" style="color: #ddad60"> </span><span class="op" start="86" style="color: #ddad60">then</span><span class="whitespace" start="90" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="91" style="color: #585858">solarized-dark</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="107" style="color: #ddad60">
                        </span><span class="op" start="108" style="color: #ddad60">else</span><span class="whitespace" start="112" style="color: #ddad60"> </span><span class="variable" start="113" select="quick" style="color: #ad95af">$color-theme</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> override these variables </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">w3c-xpath-functions-uri</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">http://www.w3.org/TR/xpath-functions/</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">font-name</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">std</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">theme-doc-uri</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">data/color-themes.xml</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">css-inline</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">no</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">css-doc</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="51" select="quick" style="color: #885d3b">doc</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="5" pair-end="50" select="quick" style="color: #885d3b">resolve-uri</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="17" select="quick" style="color: #ad95af">$theme-doc-uri</span><span class="op" start="31" style="color: #ddad60">,</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="function" start="33" pair-end="49" select="quick" style="color: #885d3b">static-base-uri</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="49" style="color: #295f94">)</span><span class="parenthesis" start="50" style="color: #295f94">)</span><span class="parenthesis" start="51" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color-theme-data</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element(c:theme)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$css-doc</span><span class="step" start="9" style="color: #ddad60">/</span><span class="qname" start="10" select="quick" style="color: #b05a65">c:themes</span><span class="step" start="18" style="color: #ddad60">/</span><span class="qname" start="19" select="quick" style="color: #b05a65">c:theme</span><span class="filter" start="26" pair-end="64" select="quick" style="color: #295f94">[</span><span class="axis" start="27" style="color: #566874">@</span><span class="qname" start="28" select="quick" style="color: #b05a65">name</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" start="33" style="color: #ddad60">eq</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="function" start="36" pair-end="63" select="quick" style="color: #885d3b">f:get-theme</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="48" select="quick" style="color: #ad95af">$resolved-theme</span><span class="parenthesis" start="63" style="color: #295f94">)</span><span class="filter" start="64" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color-modes</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element(colors)*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="38" select="quick" style="color: #885d3b">f:get-inline-colors</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="21" select="quick" style="color: #ad95af">$color-theme-data</span><span class="parenthesis" start="38" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">document-type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> override if xml document type is not included here </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">xsd-names</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">document-types</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">document-type</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xslt</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">ns</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">http://www.w3.org/1999/XSL/Transform</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">ns</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">document-type</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">document-type</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xsd</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">ns</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">http://www.w3.org/2001/XMLSchema</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">ns</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">xpath-names</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">assert</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">test</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">alternative</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">test</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">field</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">xpath</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">selector</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">xpath</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">xpath-names</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">highlight-names</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">attribute</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">attribute</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">attribute</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">highlight-names</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">document-type</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">document-type</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">schematron</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">ns</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">http://purl.oclc.org/dsdl/schematron</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">ns</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">ns</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">http://www.ascc.net/xml/schematron</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">ns</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">xpath-names</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">assert</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">test</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">key</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">path</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">report</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">test</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">rule</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">context</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">value-of</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">select</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">xpath-names</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">highlight-names</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">pattern</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">attribute</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">key</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">attribute</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">highlight-names</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">document-type</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">document-type</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">deltaxml</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">ns</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">http://www.deltaxml.com/ns/well-formed-delta-v1</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">ns</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">xpath-names</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">deltaV2</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">xpath-names</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">highlight-names</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">pattern</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">attribute</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">key</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">attribute</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">highlight-names</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">document-type</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">document-type</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xproc</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">ns</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">http://www.w3.org/ns/xproc</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">ns</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">xpath-names</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">add-attribute</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> note: XProc spec states attribute-value has type xs:string
                       but the value may be an XPath expression so it can
                       do no harm to colorise as such </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">attribute-value</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">delete</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">filter</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">select</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">hash</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">input</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">select</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">insert</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">iteration-source</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">select</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">label-elements</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">label</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">make-absolute-uris</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">namespaces</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">element</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">option</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">select</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">rename</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">replace</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">set-attributes</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">string-replace</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">replace</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">unwrap</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">uuid</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">variable</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">select</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">viewport</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">when</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">test</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">with-option</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">select</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">with-param</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">select</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">wrap</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">www-form-urlencode</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">att</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">match</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">att</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">xpath-names</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">highlight-names</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">option</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">attribute</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">variable</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">attribute</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">highlight-names</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">document-type</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">document-types</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:doctype-from-xmlns</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">xmlns</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf">
        </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="parenthesis" start="1" pair-end="49" select="quick" style="color: #295f94">(</span><span class="variable" start="2" select="quick" style="color: #ad95af">$xsd-names</span><span class="step" start="12" style="color: #ddad60">/</span><span class="qname" start="13" select="quick" style="color: #b05a65">document-type</span><span class="filter" start="26" pair-end="38" select="quick" style="color: #295f94">[</span><span class="qname" start="27" select="quick" style="color: #b05a65">ns</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" start="30" style="color: #ddad60">=</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="variable" start="32" select="quick" style="color: #ad95af">$xmlns</span><span class="filter" start="38" style="color: #295f94">]</span><span class="step" start="39" style="color: #ddad60">/</span><span class="axis" start="40" style="color: #566874">@</span><span class="qname" start="41" select="quick" style="color: #b05a65">name</span><span class="op" start="45" style="color: #ddad60">,</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="47" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="49" style="color: #295f94">)</span><span class="filter" start="50" pair-end="52" select="quick" style="color: #295f94">[</span><span class="numeric" start="51" style="color: #566874">1</span><span class="filter" start="52" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:xsd-xpath-names</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">doctype</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf">
        </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$xsd-names</span><span class="step" start="11" style="color: #ddad60">/</span><span class="qname" start="12" select="quick" style="color: #b05a65">document-type</span><span class="filter" start="25" pair-end="43" select="quick" style="color: #295f94">[</span><span class="axis" start="26" style="color: #566874">@</span><span class="qname" start="27" select="quick" style="color: #b05a65">name</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" start="32" style="color: #ddad60">eq</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="variable" start="35" select="quick" style="color: #ad95af">$doctype</span><span class="filter" start="43" style="color: #295f94">]</span><span class="step" start="44" style="color: #ddad60">/</span><span class="qname" start="45" select="quick" style="color: #b05a65">xpath-names</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:xsd-highlight-names</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">doctype</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf">
        </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$xsd-names</span><span class="step" start="11" style="color: #ddad60">/</span><span class="qname" start="12" select="quick" style="color: #b05a65">document-type</span><span class="filter" start="25" pair-end="43" select="quick" style="color: #295f94">[</span><span class="axis" start="26" style="color: #566874">@</span><span class="qname" start="27" select="quick" style="color: #b05a65">name</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" start="32" style="color: #ddad60">eq</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="variable" start="35" select="quick" style="color: #ad95af">$doctype</span><span class="filter" start="43" style="color: #295f94">]</span><span class="step" start="44" style="color: #ddad60">/</span><span class="qname" start="45" select="quick" style="color: #b05a65">highlight-names</span><span class="step" start="60" style="color: #ddad60">/</span><span class="qname" start="61" select="quick" style="color: #b05a65">*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
  signature:
      f:render(xml-content, is-xml, root-prefix)
  
  description:
      Converts the xml content string to a sequence of span elements. with each
      containing a class attribute used for coloring with CSS. 
  
  params:
      xml-content: string containing well-balanced XML extract - namespace and prefix
                   declarations not required
      is-xsl:      boolean specifying whether coloring is for XSLT, if this is false
                   then XSD 1.1 coloring scheme is used instead
      root-prefix: string prefix used for elements requiring special coloring for XSLT
                   or XSD 1.1 - often 'xsl' and 'xs' respectively
  </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:render</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">xmlText</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">doctype</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">root-prefix-a</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">root-prefix</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="25" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$root-prefix-a</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">eq</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="23" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="25" style="color: #295f94">)</span><span class="whitespace" start="26" style="color: #ddad60"> 
                          </span><span class="op" start="28" style="color: #ddad60">then</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="33" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="35" style="color: #ddad60">
                          </span><span class="op" start="36" style="color: #ddad60">else</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="function" start="41" pair-end="67" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="48" select="quick" style="color: #ad95af">$root-prefix-a</span><span class="op" start="62" style="color: #ddad60">,</span><span class="whitespace" start="63" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="64" style="color: #585858">:</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="67" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tokens-a</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="26" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="10" select="quick" style="color: #ad95af">$xmlText</span><span class="op" start="18" style="color: #ddad60">,</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="20" style="color: #585858">&amp;lt;</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="26" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:message</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:text</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">rendering </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:text</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="36" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="8" pair-end="31" select="quick" style="color: #885d3b">string</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="15" pair-end="30" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="21" select="quick" style="color: #ad95af">$tokens-a</span><span class="parenthesis" start="30" style="color: #295f94">)</span><span class="parenthesis" start="31" style="color: #295f94">)</span><span class="op" start="32" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="33" style="color: #585858"> </span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="36" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$doctype</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:text</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"> tokens ...</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:text</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:message</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="40" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="33" select="quick" style="color: #885d3b">normalize-space</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="21" select="quick" style="color: #ad95af">$tokens-a</span><span class="filter" start="30" pair-end="32" select="quick" style="color: #295f94">[</span><span class="numeric" start="31" style="color: #566874">1</span><span class="filter" start="32" style="color: #295f94">]</span><span class="parenthesis" start="33" style="color: #295f94">)</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" start="35" style="color: #ddad60">eq</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="38" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="40" style="color: #295f94">)</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="op" start="42" style="color: #ddad60">then</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="function" start="47" pair-end="71" select="quick" style="color: #885d3b">subsequence</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="59" select="quick" style="color: #ad95af">$tokens-a</span><span class="op" start="68" style="color: #ddad60">,</span><span class="whitespace" start="69" style="color: #ddad60"> </span><span class="numeric" start="70" style="color: #566874">2</span><span class="parenthesis" start="71" style="color: #295f94">)</span><span class="whitespace" start="72" style="color: #ddad60"> </span><span class="op" start="73" style="color: #ddad60">else</span><span class="whitespace" start="77" style="color: #ddad60"> </span><span class="variable" start="78" select="quick" style="color: #ad95af">$tokens-a</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="62" select="quick" style="color: #885d3b">f:iterateTokens</span><span class="parenthesis" style="color: #295f94">(</span><span class="numeric" start="17" style="color: #566874">0</span><span class="op" start="18" style="color: #ddad60">,</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="variable" start="20" select="quick" style="color: #ad95af">$tokens</span><span class="op" start="27" style="color: #ddad60">,</span><span class="numeric" start="28" style="color: #566874">1</span><span class="op" start="29" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="30" style="color: #585858">n</span><span class="op" style="color: #ddad60">'</span><span class="op" start="33" style="color: #ddad60">,</span><span class="numeric" start="34" style="color: #566874">0</span><span class="op" start="35" style="color: #ddad60">,</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="numeric" start="37" style="color: #566874">0</span><span class="op" start="38" style="color: #ddad60">,</span><span class="whitespace" start="39" style="color: #ddad60"> </span><span class="variable" start="40" select="quick" style="color: #ad95af">$doctype</span><span class="op" start="48" style="color: #ddad60">,</span><span class="whitespace" start="49" style="color: #ddad60"> </span><span class="variable" start="50" select="quick" style="color: #ad95af">$root-prefix</span><span class="parenthesis" start="62" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$css-inline</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" start="13" style="color: #ddad60">eq</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858">no</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$spans</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #885d3b">f:style-spans</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$spans</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> 
  signature:
      f:indent(spans, char-width)
  
  description
      
      Adds space characters for indentation to spans from XML-text processed with f:render. 
      XML contents is indented in the conventional way, multi-line attribute names and values
      are aligned vertically
  
  parameters:
      spans:          Sequence of 'span' element nodes created by f:render
      char-width:     integer: Number of characters for each indent level
      auto-trim:      boolean: Trims any leading whitespace before indentation
  
  
   </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:indent</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">char-width</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">auto-trim</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:call-template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tcall" style="color: #b05a65">indentSpans</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="numeric" start="1" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="numeric" start="1" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">margin</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$char-width</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">an-offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="numeric" start="1" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">av-offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="numeric" start="1" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">multi-line</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="7" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="7" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">auto-trim</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$auto-trim</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">mixed-level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="numeric" start="1" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:call-template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tname" style="color: #ab2525">indentSpans</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">margin</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">an-offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">av-offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">multi-line</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">auto-trim</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">mixed-level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">span</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$spans</span><span class="filter" start="7" pair-end="14" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="filter" start="14" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$span</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">class</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">nextClass</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$spans</span><span class="filter" start="7" pair-end="18" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">+</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="numeric" start="17" style="color: #566874">1</span><span class="filter" start="18" style="color: #295f94">]</span><span class="step" start="19" style="color: #ddad60">/</span><span class="axis" start="20" style="color: #566874">@</span><span class="qname" start="21" select="quick" style="color: #b05a65">class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prevClass</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$spans</span><span class="filter" start="7" pair-end="18" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">-</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="numeric" start="17" style="color: #566874">1</span><span class="filter" start="18" style="color: #295f94">]</span><span class="step" start="19" style="color: #ddad60">/</span><span class="axis" start="20" style="color: #566874">@</span><span class="qname" start="21" select="quick" style="color: #b05a65">class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">level2</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="20" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">eq</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">scx</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">then</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="variable" start="27" select="quick" style="color: #ad95af">$level</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="op" start="34" style="color: #ddad60">+</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="numeric" start="36" style="color: #566874">1</span><span class="whitespace" start="37" style="color: #ddad60">
                                        </span><span class="op" start="38" style="color: #ddad60">else</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="if" start="43" style="color: #ddad60">if</span><span class="whitespace" start="45" style="color: #ddad60"> </span><span class="parenthesis" start="46" pair-end="61" select="quick" style="color: #295f94">(</span><span class="variable" start="47" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="53" style="color: #ddad60"> </span><span class="op" start="54" style="color: #ddad60">eq</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="57" style="color: #585858">ez</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="61" style="color: #295f94">)</span><span class="whitespace" start="62" style="color: #ddad60"> </span><span class="op" start="63" style="color: #ddad60">then</span><span class="whitespace" start="67" style="color: #ddad60"> </span><span class="variable" start="68" select="quick" style="color: #ad95af">$level</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="op" start="75" style="color: #ddad60">-</span><span class="whitespace" start="76" style="color: #ddad60"> </span><span class="numeric" start="77" style="color: #566874">1</span><span class="whitespace" start="78" style="color: #ddad60">
                                        </span><span class="op" start="79" style="color: #ddad60">else</span><span class="whitespace" start="83" style="color: #ddad60"> </span><span class="variable" start="84" select="quick" style="color: #ad95af">$level</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">mixed-level2</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="22" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$mixed-level</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" start="18" style="color: #ddad60">eq</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="numeric" start="21" style="color: #566874">0</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="op" start="24" style="color: #ddad60">then</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="numeric" start="29" style="color: #566874">0</span><span class="whitespace" start="30" style="color: #ddad60">
                                              </span><span class="op" start="31" style="color: #ddad60">else</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="if" start="36" style="color: #ddad60">if</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="parenthesis" start="39" pair-end="55" select="quick" style="color: #295f94">(</span><span class="variable" start="40" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="op" start="47" style="color: #ddad60">eq</span><span class="whitespace" start="49" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="50" style="color: #585858">scx</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="55" style="color: #295f94">)</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="op" start="57" style="color: #ddad60">then</span><span class="whitespace" start="61" style="color: #ddad60"> </span><span class="variable" start="62" select="quick" style="color: #ad95af">$mixed-level</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="op" start="75" style="color: #ddad60">+</span><span class="whitespace" start="76" style="color: #ddad60"> </span><span class="numeric" start="77" style="color: #566874">1</span><span class="whitespace" start="78" style="color: #ddad60">
                                              </span><span class="op" start="79" style="color: #ddad60">else</span><span class="whitespace" start="83" style="color: #ddad60"> </span><span class="if" start="84" style="color: #ddad60">if</span><span class="whitespace" start="86" style="color: #ddad60"> </span><span class="parenthesis" start="87" pair-end="102" select="quick" style="color: #295f94">(</span><span class="variable" start="88" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="94" style="color: #ddad60"> </span><span class="op" start="95" style="color: #ddad60">eq</span><span class="whitespace" start="97" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="98" style="color: #585858">ez</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="102" style="color: #295f94">)</span><span class="whitespace" start="103" style="color: #ddad60"> </span><span class="op" start="104" style="color: #ddad60">then</span><span class="whitespace" start="108" style="color: #ddad60"> </span><span class="variable" start="109" select="quick" style="color: #ad95af">$mixed-level</span><span class="whitespace" start="121" style="color: #ddad60"> </span><span class="op" start="122" style="color: #ddad60">-</span><span class="whitespace" start="123" style="color: #ddad60"> </span><span class="numeric" start="124" style="color: #566874">1</span><span class="whitespace" start="125" style="color: #ddad60">
                                              </span><span class="op" start="126" style="color: #ddad60">else</span><span class="whitespace" start="130" style="color: #ddad60"> </span><span class="variable" start="131" select="quick" style="color: #ad95af">$mixed-level</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">outdent</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="28" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">lt</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="function" start="15" pair-end="27" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="21" select="quick" style="color: #ad95af">$spans</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" start="30" style="color: #ddad60">then</span><span class="whitespace" start="34" style="color: #ddad60">
                          </span><span class="variable" start="35" select="quick" style="color: #ad95af">$spans</span><span class="filter" start="41" pair-end="52" select="quick" style="color: #295f94">[</span><span class="variable" start="42" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="48" style="color: #ddad60"> </span><span class="op" start="49" style="color: #ddad60">+</span><span class="whitespace" start="50" style="color: #ddad60"> </span><span class="numeric" start="51" style="color: #566874">1</span><span class="filter" start="52" style="color: #295f94">]</span><span class="step" start="53" style="color: #ddad60">/</span><span class="axis" start="54" style="color: #566874">@</span><span class="qname" start="55" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="60" style="color: #ddad60"> </span><span class="op" start="61" style="color: #ddad60">eq</span><span class="whitespace" start="63" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="64" style="color: #585858">ez</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="68" style="color: #ddad60">
                          </span><span class="op" start="69" style="color: #ddad60">else</span><span class="whitespace" start="73" style="color: #ddad60"> </span><span class="function" start="74" pair-end="80" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="80" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="13" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$span</span><span class="parenthesis" start="13" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">indentOutput</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="140" select="quick" style="color: #885d3b">f:indentTextSpan</span><span class="parenthesis" style="color: #295f94">(</span><span class="whitespace" start="18" style="color: #ddad60">
                                                </span><span class="variable" start="19" select="quick" style="color: #ad95af">$span</span><span class="op" start="24" style="color: #ddad60">,</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="variable" start="26" select="quick" style="color: #ad95af">$level</span><span class="op" start="32" style="color: #ddad60">,</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="variable" start="34" select="quick" style="color: #ad95af">$margin</span><span class="op" start="41" style="color: #ddad60">,</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="variable" start="43" select="quick" style="color: #ad95af">$an-offset</span><span class="op" start="53" style="color: #ddad60">,</span><span class="whitespace" start="54" style="color: #ddad60"> </span><span class="variable" start="55" select="quick" style="color: #ad95af">$av-offset</span><span class="op" start="65" style="color: #ddad60">,</span><span class="whitespace" start="66" style="color: #ddad60"> </span><span class="variable" start="67" select="quick" style="color: #ad95af">$outdent</span><span class="op" start="75" style="color: #ddad60">,</span><span class="whitespace" start="76" style="color: #ddad60">
                                                </span><span class="variable" start="77" select="quick" style="color: #ad95af">$nextClass</span><span class="op" start="87" style="color: #ddad60">,</span><span class="whitespace" start="88" style="color: #ddad60"> </span><span class="variable" start="89" select="quick" style="color: #ad95af">$prevClass</span><span class="op" start="99" style="color: #ddad60">,</span><span class="whitespace" start="100" style="color: #ddad60"> </span><span class="variable" start="101" select="quick" style="color: #ad95af">$multi-line</span><span class="op" start="112" style="color: #ddad60">,</span><span class="whitespace" start="113" style="color: #ddad60"> </span><span class="variable" start="114" select="quick" style="color: #ad95af">$auto-trim</span><span class="op" start="124" style="color: #ddad60">,</span><span class="whitespace" start="125" style="color: #ddad60"> </span><span class="variable" start="126" select="quick" style="color: #ad95af">$mixed-level2</span><span class="whitespace" start="139" style="color: #ddad60">
                                                </span><span class="parenthesis" start="140" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$indentOutput</span><span class="step" start="14" style="color: #ddad60">/</span><span class="qname" start="15" select="quick" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">lt</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="function" start="11" pair-end="23" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="17" select="quick" style="color: #ad95af">$spans</span><span class="parenthesis" start="23" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:call-template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tcall" style="color: #b05a65">indentSpans</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="numeric" start="10" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$level2</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">margin</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$margin</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">an-offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$indentOutput</span><span class="step" start="14" style="color: #ddad60">/</span><span class="qname" start="15" select="quick" style="color: #b05a65">an-offset</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">av-offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$indentOutput</span><span class="step" start="14" style="color: #ddad60">/</span><span class="qname" start="15" select="quick" style="color: #b05a65">av-offset</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">multi-line</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$indentOutput</span><span class="step" start="14" style="color: #ddad60">/</span><span class="qname" start="15" select="quick" style="color: #b05a65">multi-line</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">auto-trim</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$auto-trim</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">mixed-level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="37" select="quick" style="color: #885d3b">xs:integer</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="12" select="quick" style="color: #ad95af">$indentOutput</span><span class="step" start="25" style="color: #ddad60">/</span><span class="qname" start="26" select="quick" style="color: #b05a65">mixed-level</span><span class="parenthesis" start="37" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:call-template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:clark-name</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">xmlns</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">name</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prefix</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="28" select="quick" style="color: #885d3b">substring-before</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$name</span><span class="op" start="23" style="color: #ddad60">,</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="25" style="color: #585858">:</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prefix-length</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="18" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$prefix</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" start="13" style="color: #ddad60">eq</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">then</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="numeric" start="25" style="color: #566874">1</span><span class="whitespace" start="26" style="color: #ddad60">
                          </span><span class="op" start="27" style="color: #ddad60">else</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="function" start="32" pair-end="53" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="46" select="quick" style="color: #ad95af">$prefix</span><span class="parenthesis" start="53" style="color: #295f94">)</span><span class="whitespace" start="54" style="color: #ddad60"> </span><span class="op" start="55" style="color: #ddad60">+</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="numeric" start="57" style="color: #566874">2</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">local-name</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="32" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$name</span><span class="op" start="16" style="color: #ddad60">,</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="variable" start="18" select="quick" style="color: #ad95af">$prefix-length</span><span class="parenthesis" start="32" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf">
        </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="18" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$prefix</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" start="13" style="color: #ddad60">eq</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">then</span><span class="whitespace" start="24" style="color: #ddad60">
                </span><span class="variable" start="25" select="quick" style="color: #ad95af">$local-name</span><span class="whitespace" start="36" style="color: #ddad60">
                </span><span class="op" start="37" style="color: #ddad60">else</span><span class="whitespace" start="41" style="color: #ddad60">
                </span><span class="function" start="42" pair-end="106" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="49" style="color: #585858">{</span><span class="op" style="color: #ddad60">'</span><span class="op" start="52" style="color: #ddad60">,</span><span class="whitespace" start="53" style="color: #ddad60">
                </span><span class="variable" start="54" select="quick" style="color: #ad95af">$xmlns</span><span class="step" start="60" style="color: #ddad60">/</span><span class="qname" start="61" select="quick" style="color: #b05a65">ns</span><span class="filter" start="63" pair-end="82" select="quick" style="color: #295f94">[</span><span class="axis" start="64" style="color: #566874">@</span><span class="qname" start="65" select="quick" style="color: #b05a65">prefix</span><span class="whitespace" start="71" style="color: #ddad60"> </span><span class="op" start="72" style="color: #ddad60">eq</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="variable" start="75" select="quick" style="color: #ad95af">$prefix</span><span class="filter" start="82" style="color: #295f94">]</span><span class="step" start="83" style="color: #ddad60">/</span><span class="axis" start="84" style="color: #566874">@</span><span class="qname" start="85" select="quick" style="color: #b05a65">uri</span><span class="op" start="88" style="color: #ddad60">,</span><span class="whitespace" start="89" style="color: #ddad60">
                </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="90" style="color: #585858">}</span><span class="op" style="color: #ddad60">'</span><span class="op" start="93" style="color: #ddad60">,</span><span class="whitespace" start="94" style="color: #ddad60">
                </span><span class="variable" start="95" select="quick" style="color: #ad95af">$local-name</span><span class="parenthesis" start="106" style="color: #295f94">)</span><span class="whitespace" start="107" style="color: #ddad60">
                </span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:gen-id</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">type-prefix</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">clark-name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">char</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="27" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$type-prefix</span><span class="op" start="23" style="color: #ddad60">,</span><span class="numeric" start="24" style="color: #566874">1</span><span class="op" start="25" style="color: #ddad60">,</span><span class="numeric" start="26" style="color: #566874">1</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="30" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$char</span><span class="op" start="13" style="color: #ddad60">,</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">?</span><span class="op" style="color: #ddad60">'</span><span class="op" start="18" style="color: #ddad60">,</span><span class="variable" start="19" select="quick" style="color: #ad95af">$clark-name</span><span class="parenthesis" start="30" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> 
  description
      XSLT Template
      Adds ids and hrefs to span elements for global-variables, named-templates and functions
  
  parameters:
      xmlns:          declared prefixes/namespaces on root-element for current document
      globals:        clark-notation names for all globally declared items that may be
                      referenced.
   </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">match</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="qname" start="1" select="quick" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">mode</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">markup</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">xmlns</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">globals</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">path-length</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">ref-name</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="25" select="quick" style="color: #295f94">(</span><span class="axis" start="5" style="color: #566874">@</span><span class="qname" start="6" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">eq</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">variable</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="25" style="color: #295f94">)</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" start="27" style="color: #ddad60">then</span><span class="whitespace" start="31" style="color: #ddad60">
                          </span><span class="function" start="32" pair-end="46" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="42" style="color: #566874">.</span><span class="op" start="43" style="color: #ddad60">,</span><span class="whitespace" start="44" style="color: #ddad60"> </span><span class="numeric" start="45" style="color: #566874">2</span><span class="parenthesis" start="46" style="color: #295f94">)</span><span class="whitespace" start="47" style="color: #ddad60">
                          </span><span class="op" start="48" style="color: #ddad60">else</span><span class="whitespace" start="52" style="color: #ddad60"> </span><span class="context" start="53" style="color: #566874">.</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">clark-name</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="31" select="quick" style="color: #885d3b">f:clark-name</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="14" select="quick" style="color: #ad95af">$xmlns</span><span class="op" start="20" style="color: #ddad60">,</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="variable" start="22" select="quick" style="color: #ad95af">$ref-name</span><span class="parenthesis" start="31" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">id</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="29" select="quick" style="color: #885d3b">f:gen-id</span><span class="parenthesis" style="color: #295f94">(</span><span class="axis" start="10" style="color: #566874">@</span><span class="qname" start="11" select="quick" style="color: #b05a65">class</span><span class="op" start="16" style="color: #ddad60">,</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="variable" start="18" select="quick" style="color: #ad95af">$clark-name</span><span class="parenthesis" start="29" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">=</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="parenthesis" start="10" pair-end="36" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">fname</span><span class="op" style="color: #ddad60">'</span><span class="op" start="18" style="color: #ddad60">,</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="20" style="color: #585858">tname</span><span class="op" style="color: #ddad60">'</span><span class="op" start="27" style="color: #ddad60">,</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="29" style="color: #585858">vname</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="36" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">id</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$id</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$ref-name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:copy</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">=</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="10" style="color: #585858">enxsl</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="17" style="color: #ddad60">
                      </span><span class="op" start="18" style="color: #ddad60">and</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="parenthesis" start="22" pair-end="83" select="quick" style="color: #295f94">(</span><span class="function" start="23" pair-end="48" select="quick" style="color: #885d3b">ends-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="33" style="color: #566874">.</span><span class="op" start="34" style="color: #ddad60">,</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="36" style="color: #585858">stylesheet</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="48" style="color: #295f94">)</span><span class="whitespace" start="49" style="color: #ddad60">
                       </span><span class="op" start="51" style="color: #ddad60">or</span><span class="whitespace" start="53" style="color: #ddad60">  </span><span class="function" start="55" pair-end="79" select="quick" style="color: #885d3b">ends-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="65" style="color: #566874">.</span><span class="op" start="66" style="color: #ddad60">,</span><span class="whitespace" start="67" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="68" style="color: #585858">transform</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="79" style="color: #295f94">)</span><span class="whitespace" start="80" style="color: #ddad60">
                        </span><span class="parenthesis" start="83" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">a</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">solar</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">href</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="function" start="1" pair-end="34" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$path-length</span><span class="op" start="20" style="color: #ddad60">,</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="22" style="color: #585858">index.html</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="34" style="color: #295f94">)</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">id</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$id</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$ref-name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:copy</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">a</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">=</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="parenthesis" start="10" pair-end="48" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">variable</span><span class="op" style="color: #ddad60">'</span><span class="op" start="21" style="color: #ddad60">,</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="23" style="color: #585858">href</span><span class="op" style="color: #ddad60">'</span><span class="op" start="29" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="30" style="color: #585858">tcall</span><span class="op" style="color: #ddad60">'</span><span class="op" start="37" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="38" style="color: #585858">function</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="48" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">global-refs</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                      </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="25" select="quick" style="color: #295f94">(</span><span class="axis" start="5" style="color: #566874">@</span><span class="qname" start="6" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">eq</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">variable</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="25" style="color: #295f94">)</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" start="27" style="color: #ddad60">then</span><span class="whitespace" start="31" style="color: #ddad60">
                                  </span><span class="variable" start="36" select="quick" style="color: #ad95af">$globals</span><span class="step" start="44" style="color: #ddad60">/</span><span class="qname" start="45" select="quick" style="color: #b05a65">file</span><span class="step" start="49" style="color: #ddad60">/</span><span class="qname" start="50" select="quick" style="color: #b05a65">variables</span><span class="whitespace" start="59" style="color: #ddad60">
                              </span><span class="op" start="60" style="color: #ddad60">else</span><span class="whitespace" start="64" style="color: #ddad60"> </span><span class="if" start="65" style="color: #ddad60">if</span><span class="whitespace" start="67" style="color: #ddad60"> </span><span class="parenthesis" start="68" pair-end="86" select="quick" style="color: #295f94">(</span><span class="axis" start="69" style="color: #566874">@</span><span class="qname" start="70" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="75" style="color: #ddad60"> </span><span class="op" start="76" style="color: #ddad60">eq</span><span class="whitespace" start="78" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="79" style="color: #585858">tcall</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="86" style="color: #295f94">)</span><span class="whitespace" start="87" style="color: #ddad60"> </span><span class="op" start="88" style="color: #ddad60">then</span><span class="whitespace" start="92" style="color: #ddad60">
                                  </span><span class="variable" start="97" select="quick" style="color: #ad95af">$globals</span><span class="step" start="105" style="color: #ddad60">/</span><span class="qname" start="106" select="quick" style="color: #b05a65">file</span><span class="step" start="110" style="color: #ddad60">/</span><span class="qname" start="111" select="quick" style="color: #b05a65">templates</span><span class="whitespace" start="120" style="color: #ddad60">
                              </span><span class="op" start="121" style="color: #ddad60">else</span><span class="whitespace" start="125" style="color: #ddad60"> </span><span class="if" start="126" style="color: #ddad60">if</span><span class="whitespace" start="128" style="color: #ddad60"> </span><span class="parenthesis" start="129" pair-end="150" select="quick" style="color: #295f94">(</span><span class="axis" start="130" style="color: #566874">@</span><span class="qname" start="131" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="136" style="color: #ddad60"> </span><span class="op" start="137" style="color: #ddad60">eq</span><span class="whitespace" start="139" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="140" style="color: #585858">function</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="150" style="color: #295f94">)</span><span class="whitespace" start="151" style="color: #ddad60"> </span><span class="op" start="152" style="color: #ddad60">then</span><span class="whitespace" start="156" style="color: #ddad60">
                                  </span><span class="variable" start="161" select="quick" style="color: #ad95af">$globals</span><span class="step" start="169" style="color: #ddad60">/</span><span class="qname" start="170" select="quick" style="color: #b05a65">file</span><span class="step" start="174" style="color: #ddad60">/</span><span class="qname" start="175" select="quick" style="color: #b05a65">functions</span><span class="whitespace" start="184" style="color: #ddad60">
                              </span><span class="op" start="185" style="color: #ddad60">else</span><span class="whitespace" start="189" style="color: #ddad60"> </span><span class="parenthesis" start="190" pair-end="191" select="quick" style="color: #295f94">(</span><span class="parenthesis" start="191" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">resolved-ref</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                      </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="25" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="24" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="12" select="quick" style="color: #ad95af">$global-refs</span><span class="parenthesis" start="24" style="color: #295f94">)</span><span class="parenthesis" start="25" style="color: #295f94">)</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" start="27" style="color: #ddad60">then</span><span class="whitespace" start="31" style="color: #ddad60">
                                  </span><span class="parenthesis" start="36" pair-end="80" select="quick" style="color: #295f94">(</span><span class="variable" start="37" select="quick" style="color: #ad95af">$global-refs</span><span class="step" start="49" style="color: #ddad60">/</span><span class="qname" start="50" select="quick" style="color: #b05a65">item</span><span class="filter" start="54" pair-end="79" select="quick" style="color: #295f94">[</span><span class="function" start="55" pair-end="63" select="quick" style="color: #885d3b">string</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="62" style="color: #566874">.</span><span class="parenthesis" start="63" style="color: #295f94">)</span><span class="whitespace" start="64" style="color: #ddad60"> </span><span class="op" start="65" style="color: #ddad60">eq</span><span class="whitespace" start="67" style="color: #ddad60"> </span><span class="variable" start="68" select="quick" style="color: #ad95af">$clark-name</span><span class="filter" start="79" style="color: #295f94">]</span><span class="parenthesis" start="80" style="color: #295f94">)</span><span class="filter" start="81" pair-end="83" select="quick" style="color: #295f94">[</span><span class="numeric" start="82" style="color: #566874">1</span><span class="filter" start="83" style="color: #295f94">]</span><span class="step" start="84" style="color: #ddad60">/</span><span class="context" start="85" style="color: #566874">..</span><span class="step" start="87" style="color: #ddad60">/</span><span class="axis" start="88" style="color: #566874">parent::</span><span class="qname" start="96" select="quick" style="color: #b05a65">file</span><span class="step" start="100" style="color: #ddad60">/</span><span class="axis" start="101" style="color: #566874">@</span><span class="qname" start="102" select="quick" style="color: #b05a65">path</span><span class="whitespace" start="106" style="color: #ddad60">
                              </span><span class="op" start="107" style="color: #ddad60">else</span><span class="whitespace" start="111" style="color: #ddad60"> </span><span class="parenthesis" start="112" pair-end="113" select="quick" style="color: #295f94">(</span><span class="parenthesis" start="113" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">href</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                      </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="21" select="quick" style="color: #295f94">(</span><span class="axis" start="5" style="color: #566874">@</span><span class="qname" start="6" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">eq</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">href</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" start="23" style="color: #ddad60">then</span><span class="whitespace" start="27" style="color: #ddad60">
                                  </span><span class="function" start="32" pair-end="49" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="39" style="color: #566874">.</span><span class="op" start="40" style="color: #ddad60">,</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="42" style="color: #585858">.html</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="49" style="color: #295f94">)</span><span class="whitespace" start="50" style="color: #ddad60">
                              </span><span class="op" start="51" style="color: #ddad60">else</span><span class="whitespace" start="55" style="color: #ddad60"> </span><span class="if" start="56" style="color: #ddad60">if</span><span class="whitespace" start="58" style="color: #ddad60"> </span><span class="parenthesis" start="59" pair-end="106" select="quick" style="color: #295f94">(</span><span class="axis" start="60" style="color: #566874">@</span><span class="qname" start="61" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="66" style="color: #ddad60"> </span><span class="op" start="67" style="color: #ddad60">eq</span><span class="whitespace" start="69" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="70" style="color: #585858">function</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="80" style="color: #ddad60"> </span><span class="op" start="81" style="color: #ddad60">and</span><span class="whitespace" start="84" style="color: #ddad60"> </span><span class="function" start="85" pair-end="105" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="89" pair-end="104" select="quick" style="color: #885d3b">contains</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="98" style="color: #566874">.</span><span class="op" start="99" style="color: #ddad60">,</span><span class="whitespace" start="100" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="101" style="color: #585858">:</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="104" style="color: #295f94">)</span><span class="parenthesis" start="105" style="color: #295f94">)</span><span class="parenthesis" start="106" style="color: #295f94">)</span><span class="whitespace" start="107" style="color: #ddad60"> </span><span class="op" start="108" style="color: #ddad60">then</span><span class="whitespace" start="112" style="color: #ddad60">
                                  </span><span class="function" start="117" pair-end="173" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="124" select="quick" style="color: #ad95af">$w3c-xpath-functions-uri</span><span class="op" start="148" style="color: #ddad60">,</span><span class="whitespace" start="149" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="150" style="color: #585858">#</span><span class="op" style="color: #ddad60">'</span><span class="op" start="153" style="color: #ddad60">,</span><span class="whitespace" start="154" style="color: #ddad60"> </span><span class="function" start="155" pair-end="172" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="162" style="color: #585858">func-</span><span class="op" style="color: #ddad60">'</span><span class="op" start="169" style="color: #ddad60">,</span><span class="whitespace" start="170" style="color: #ddad60"> </span><span class="context" start="171" style="color: #566874">.</span><span class="parenthesis" start="172" style="color: #295f94">)</span><span class="parenthesis" start="173" style="color: #295f94">)</span><span class="whitespace" start="174" style="color: #ddad60">
                              </span><span class="op" start="175" style="color: #ddad60">else</span><span class="whitespace" start="179" style="color: #ddad60"> </span><span class="if" start="180" style="color: #ddad60">if</span><span class="whitespace" start="182" style="color: #ddad60"> </span><span class="parenthesis" start="183" pair-end="205" select="quick" style="color: #295f94">(</span><span class="function" start="184" pair-end="204" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="191" select="quick" style="color: #ad95af">$resolved-ref</span><span class="parenthesis" start="204" style="color: #295f94">)</span><span class="parenthesis" start="205" style="color: #295f94">)</span><span class="whitespace" start="206" style="color: #ddad60"> </span><span class="op" start="207" style="color: #ddad60">then</span><span class="whitespace" start="211" style="color: #ddad60">
                                  </span><span class="function" start="216" pair-end="282" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="whitespace" start="223" style="color: #ddad60">
                                  </span><span class="variable" start="228" select="quick" style="color: #ad95af">$path-length</span><span class="op" start="240" style="color: #ddad60">,</span><span class="whitespace" start="241" style="color: #ddad60">
                                  </span><span class="variable" start="246" select="quick" style="color: #ad95af">$resolved-ref</span><span class="op" start="259" style="color: #ddad60">,</span><span class="whitespace" start="260" style="color: #ddad60">
                                  </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="265" style="color: #585858">.html</span><span class="op" style="color: #ddad60">'</span><span class="op" start="272" style="color: #ddad60">,</span><span class="whitespace" start="273" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="274" style="color: #585858">#</span><span class="op" style="color: #ddad60">'</span><span class="op" start="277" style="color: #ddad60">,</span><span class="whitespace" start="278" style="color: #ddad60"> </span><span class="variable" start="279" select="quick" style="color: #ad95af">$id</span><span class="parenthesis" start="282" style="color: #295f94">)</span><span class="whitespace" start="283" style="color: #ddad60">
                              </span><span class="op" start="284" style="color: #ddad60">else</span><span class="whitespace" start="288" style="color: #ddad60"> </span><span class="parenthesis" start="289" pair-end="290" select="quick" style="color: #295f94">(</span><span class="parenthesis" start="290" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="13" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$href</span><span class="parenthesis" start="13" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">a</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">href</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="variable" start="1" select="quick" style="color: #ad95af">$href</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">solar</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$css-inline</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" start="13" style="color: #ddad60">ne</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858">no</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">style</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">text-decoration:none</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="context" start="1" style="color: #566874">.</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">a</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="context" start="1" style="color: #566874">.</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="context" start="1" style="color: #566874">.</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:get-xmlns</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">p-spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">p</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:call-template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tcall" style="color: #b05a65">get-root-spans</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                           </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="numeric" start="1" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:call-template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">p</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">xmlns</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:for-each</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$p-spans</span><span class="step" start="9" style="color: #ddad60">/</span><span class="qname" start="10" select="quick" style="color: #b05a65">span</span><span class="filter" start="14" pair-end="30" select="quick" style="color: #295f94">[</span><span class="axis" start="15" style="color: #566874">@</span><span class="qname" start="16" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">eq</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="25" style="color: #585858">atn</span><span class="op" style="color: #ddad60">'</span><span class="filter" start="30" style="color: #295f94">]</span><span class="filter" start="31" pair-end="55" select="quick" style="color: #295f94">[</span><span class="function" start="32" pair-end="54" select="quick" style="color: #885d3b">starts-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="44" style="color: #566874">.</span><span class="op" start="45" style="color: #ddad60">,</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="47" style="color: #585858">xmlns</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="54" style="color: #295f94">)</span><span class="filter" start="55" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">att-value</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:call-template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tcall" style="color: #b05a65">get-next-class</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="27" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="axis" start="7" style="color: #566874">preceding-sibling::</span><span class="qname" start="26" select="quick" style="color: #b05a65">*</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">av</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:call-template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"> 
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">ns</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">prefix</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="function" start="1" pair-end="23" select="quick" style="color: #885d3b">substring-after</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="17" style="color: #566874">.</span><span class="op" start="18" style="color: #ddad60">,</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="20" style="color: #585858">:</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="23" style="color: #295f94">)</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
            </span><span class="atn" style="color: #566874">uri</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="context" start="1" style="color: #566874">.</span><span class="step" start="2" style="color: #ddad60">/</span><span class="axis" start="3" style="color: #566874">following-sibling::</span><span class="qname" start="22" select="quick" style="color: #b05a65">*</span><span class="filter" start="23" pair-end="39" select="quick" style="color: #295f94">[</span><span class="function" start="24" pair-end="33" select="quick" style="color: #885d3b">position</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="33" style="color: #295f94">)</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" start="35" style="color: #ddad60">lt</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="numeric" start="38" style="color: #566874">5</span><span class="filter" start="39" style="color: #295f94">]</span><span class="filter" start="40" pair-end="55" select="quick" style="color: #295f94">[</span><span class="axis" start="41" style="color: #566874">@</span><span class="qname" start="42" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="op" start="48" style="color: #ddad60">eq</span><span class="whitespace" start="50" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="51" style="color: #585858">av</span><span class="op" style="color: #ddad60">'</span><span class="filter" start="55" style="color: #295f94">]</span><span class="filter" start="56" pair-end="58" select="quick" style="color: #295f94">[</span><span class="numeric" start="57" style="color: #566874">1</span><span class="filter" start="58" style="color: #295f94">]</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:for-each</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">xmlns</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tname" style="color: #ab2525">get-root-spans</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">span</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$spans</span><span class="filter" start="7" pair-end="14" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="filter" start="14" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="numeric" start="10" style="color: #566874">1</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">lt</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="function" start="15" pair-end="27" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="21" select="quick" style="color: #ad95af">$spans</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="whitespace" start="28" style="color: #ddad60">
                  </span><span class="op" start="29" style="color: #ddad60">and</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="variable" start="33" select="quick" style="color: #ad95af">$span</span><span class="step" start="38" style="color: #ddad60">/</span><span class="axis" start="39" style="color: #566874">@</span><span class="qname" start="40" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="45" style="color: #ddad60"> </span><span class="op" start="46" style="color: #ddad60">ne</span><span class="whitespace" start="48" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="49" style="color: #585858">scx</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$span</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:call-template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tcall" style="color: #b05a65">get-root-spans</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="numeric" start="10" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:call-template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tname" style="color: #ab2525">get-next-class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()?</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">span</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$spans</span><span class="filter" start="7" pair-end="14" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="filter" start="14" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$span</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" start="14" style="color: #ddad60">eq</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="variable" start="17" select="quick" style="color: #ad95af">$class</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$span</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="numeric" start="10" style="color: #566874">1</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">lt</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="function" start="15" pair-end="27" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="21" select="quick" style="color: #ad95af">$spans</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:call-template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tcall" style="color: #b05a65">get-root-spans</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="numeric" start="10" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:call-template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:indentTextSpan</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">span</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">margin</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">an-offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">av-offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">outdent</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">nextClass</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prevClass</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">multi-line</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">auto-trim</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">mixed-level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$span</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">class</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">is-mixed</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$mixed-level</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" start="14" style="color: #ddad60">gt</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="numeric" start="17" style="color: #566874">0</span><span class="whitespace" start="18" style="color: #ddad60">
                          </span><span class="op" start="19" style="color: #ddad60">or</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="parenthesis" start="22" pair-end="104" select="quick" style="color: #295f94">(</span><span class="whitespace" start="23" style="color: #ddad60">
                              </span><span class="variable" start="28" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" start="35" style="color: #ddad60">eq</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="38" style="color: #585858">txt</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="op" start="44" style="color: #ddad60">and</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="variable" start="48" select="quick" style="color: #ad95af">$nextClass</span><span class="whitespace" start="58" style="color: #ddad60"> </span><span class="op" start="59" style="color: #ddad60">=</span><span class="whitespace" start="60" style="color: #ddad60"> </span><span class="parenthesis" start="61" pair-end="72" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="62" style="color: #585858">es</span><span class="op" style="color: #ddad60">'</span><span class="op" start="66" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="67" style="color: #585858">esx</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="72" style="color: #295f94">)</span><span class="whitespace" start="73" style="color: #ddad60"> </span><span class="op" start="74" style="color: #ddad60">and</span><span class="whitespace" start="77" style="color: #ddad60"> </span><span class="function" start="78" pair-end="97" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="92" select="quick" style="color: #ad95af">$span</span><span class="parenthesis" start="97" style="color: #295f94">)</span><span class="whitespace" start="98" style="color: #ddad60"> </span><span class="op" start="99" style="color: #ddad60">gt</span><span class="whitespace" start="101" style="color: #ddad60"> </span><span class="numeric" start="102" style="color: #566874">0</span><span class="whitespace" start="103" style="color: #ddad60">
                          </span><span class="parenthesis" start="104" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">new-mixed-level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="36" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$mixed-level</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" start="18" style="color: #ddad60">eq</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="numeric" start="21" style="color: #566874">0</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" start="23" style="color: #ddad60">and</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="variable" start="27" select="quick" style="color: #ad95af">$is-mixed</span><span class="parenthesis" start="36" style="color: #295f94">)</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" start="38" style="color: #ddad60">then</span><span class="whitespace" start="42" style="color: #ddad60">
                          </span><span class="numeric" start="43" style="color: #566874">1</span><span class="whitespace" start="44" style="color: #ddad60"> </span><span class="op" start="45" style="color: #ddad60">else</span><span class="whitespace" start="49" style="color: #ddad60"> </span><span class="variable" start="50" select="quick" style="color: #ad95af">$mixed-level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">line-parts</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$insert-newlines</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> check to see if newline must be inserted after text content (even if empty) </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">eq</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">z</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">and</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="variable" start="19" select="quick" style="color: #ad95af">$nextClass</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" start="30" style="color: #ddad60">eq</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="33" style="color: #585858">atn</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="op" start="39" style="color: #ddad60">and</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="variable" start="43" select="quick" style="color: #ad95af">$level</span><span class="whitespace" start="49" style="color: #ddad60"> </span><span class="op" start="50" style="color: #ddad60">eq</span><span class="whitespace" start="52" style="color: #ddad60"> </span><span class="numeric" start="53" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">tt</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">nl</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">eq</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">txt</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">tt</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$span</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">tt</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> must somehow avoid inserting newlines within mixed content
                   but string-length($span) eq 0 will not be good test </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> ez = '&lt;/' starg of a close tag: &lt;/close&gt; 
                      ec = '&gt;' at end of a close tag: &lt;/close&gt;
                      example &lt;open&gt;this day&lt;/open&gt; </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
              
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> if next tag is open tag (es/esx) and it is preceded by text-content
                     don't add a new line, eg &lt;p&gt;my name&lt;p&gt; </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$is-mixed</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> add new line after text-content if:
                     1. next tag is not a close tag
                     2. next tag *is* a close tag and prev tag was a close tag also
                      </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$nextClass</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">ne</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">ez</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="19" style="color: #ddad60">
                                </span><span class="op" start="20" style="color: #ddad60">or</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="variable" start="23" select="quick" style="color: #ad95af">$prevClass</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="op" start="34" style="color: #ddad60">eq</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="37" style="color: #585858">ec</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">nl</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">tt</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$span</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">tt</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:analyze-string</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$span</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">regex</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">(\r?)\n.*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:matching-substring</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">r-length</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="29" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="15" pair-end="28" select="quick" style="color: #885d3b">regex-group</span><span class="parenthesis" style="color: #295f94">(</span><span class="numeric" start="27" style="color: #566874">1</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="parenthesis" start="29" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">nl</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">text</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="27" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="11" style="color: #566874">.</span><span class="op" start="12" style="color: #ddad60">,</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="numeric" start="14" style="color: #566874">2</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">+</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="variable" start="18" select="quick" style="color: #ad95af">$r-length</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="15" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$auto-trim</span><span class="parenthesis" start="15" style="color: #295f94">)</span><span class="whitespace" start="16" style="color: #ddad60">
                                      </span><span class="op" start="17" style="color: #ddad60">then</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="function" start="22" pair-end="39" select="quick" style="color: #885d3b">f:left-trim</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="34" select="quick" style="color: #ad95af">$text</span><span class="parenthesis" start="39" style="color: #295f94">)</span><span class="whitespace" start="40" style="color: #ddad60">
                                      </span><span class="op" start="41" style="color: #ddad60">else</span><span class="whitespace" start="45" style="color: #ddad60"> </span><span class="variable" start="46" select="quick" style="color: #ad95af">$text</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">nl</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:matching-substring</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:non-matching-substring</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">tt</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="context" start="1" style="color: #566874">.</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">tt</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:non-matching-substring</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:analyze-string</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">firstLine</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$line-parts</span><span class="filter" start="12" pair-end="14" select="quick" style="color: #295f94">[</span><span class="numeric" start="13" style="color: #566874">1</span><span class="filter" start="14" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">indented-lines</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="higher" start="1" style="color: #ddad60">for</span><span class="whitespace" start="4" style="color: #ddad60"> </span><span id="rng-$a" class="variable" start="5" select="quick" style="color: #ad95af">$a</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">in</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="variable" start="11" select="quick" style="color: #ad95af">$line-parts</span><span class="filter" start="22" pair-end="38" select="quick" style="color: #295f94">[</span><span class="function" start="23" pair-end="29" select="quick" style="color: #885d3b">name</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="28" style="color: #566874">.</span><span class="parenthesis" start="29" style="color: #295f94">)</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="op" start="31" style="color: #ddad60">eq</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="34" style="color: #585858">nl</span><span class="op" style="color: #ddad60">'</span><span class="filter" start="38" style="color: #295f94">]</span><span class="whitespace" start="39" style="color: #ddad60"> </span><span class="op" start="40" style="color: #ddad60">return</span><span class="whitespace" start="46" style="color: #ddad60">
                            </span><span class="function" start="47" pair-end="56" select="quick" style="color: #885d3b">string</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="54" select="quick" style="color: #ad95af">$a</span><span class="parenthesis" start="56" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">flat-part</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$line-parts</span><span class="filter" start="12" pair-end="28" select="quick" style="color: #295f94">[</span><span class="function" start="13" pair-end="19" select="quick" style="color: #885d3b">name</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="18" style="color: #566874">.</span><span class="parenthesis" start="19" style="color: #295f94">)</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="op" start="21" style="color: #ddad60">eq</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="24" style="color: #585858">tt</span><span class="op" style="color: #ddad60">'</span><span class="filter" start="28" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    
    </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> should be max of 1 </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">flat-line</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="15" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$flat-part</span><span class="parenthesis" start="15" style="color: #295f94">)</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" start="17" style="color: #ddad60">then</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="variable" start="22" select="quick" style="color: #ad95af">$flat-part</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" start="33" style="color: #ddad60">else</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="38" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    
    
    </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> constant indent when first attribute is on a new line </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">compact</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="numeric" start="1" style="color: #566874">4</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">lineOffset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="23" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="22" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="12" select="quick" style="color: #ad95af">$firstLine</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="parenthesis" start="23" style="color: #295f94">)</span><span class="whitespace" start="24" style="color: #ddad60">
                              </span><span class="op" start="29" style="color: #ddad60">then</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="function" start="34" pair-end="58" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="48" select="quick" style="color: #ad95af">$firstLine</span><span class="parenthesis" start="58" style="color: #295f94">)</span><span class="whitespace" start="59" style="color: #ddad60">
                          </span><span class="op" start="60" style="color: #ddad60">else</span><span class="whitespace" start="64" style="color: #ddad60"> </span><span class="numeric" start="65" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">an-outOffset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="28" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">=</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="parenthesis" start="14" pair-end="27" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">en</span><span class="op" style="color: #ddad60">'</span><span class="op" start="19" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="20" style="color: #585858">enxsl</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="whitespace" start="29" style="color: #ddad60">
                              </span><span class="op" start="34" style="color: #ddad60">then</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="variable" start="39" select="quick" style="color: #ad95af">$lineOffset</span><span class="whitespace" start="50" style="color: #ddad60"> </span><span class="op" start="51" style="color: #ddad60">+</span><span class="whitespace" start="52" style="color: #ddad60"> </span><span class="numeric" start="53" style="color: #566874">1</span><span class="whitespace" start="54" style="color: #ddad60">
                          </span><span class="op" start="55" style="color: #ddad60">else</span><span class="whitespace" start="59" style="color: #ddad60"> </span><span class="if" start="60" style="color: #ddad60">if</span><span class="whitespace" start="62" style="color: #ddad60"> </span><span class="parenthesis" start="63" pair-end="91" select="quick" style="color: #295f94">(</span><span class="variable" start="64" select="quick" style="color: #ad95af">$prevClass</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="op" start="75" style="color: #ddad60">=</span><span class="whitespace" start="76" style="color: #ddad60"> </span><span class="parenthesis" start="77" pair-end="90" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="78" style="color: #585858">en</span><span class="op" style="color: #ddad60">'</span><span class="op" start="82" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="83" style="color: #585858">enxsl</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="90" style="color: #295f94">)</span><span class="parenthesis" start="91" style="color: #295f94">)</span><span class="whitespace" start="92" style="color: #ddad60">
                              </span><span class="op" start="97" style="color: #ddad60">then</span><span class="whitespace" start="101" style="color: #ddad60">
                          </span><span class="if" start="102" style="color: #ddad60">if</span><span class="whitespace" start="104" style="color: #ddad60"> </span><span class="parenthesis" start="105" pair-end="129" select="quick" style="color: #295f94">(</span><span class="function" start="106" pair-end="128" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="113" select="quick" style="color: #ad95af">$indented-lines</span><span class="parenthesis" start="128" style="color: #295f94">)</span><span class="parenthesis" start="129" style="color: #295f94">)</span><span class="whitespace" start="130" style="color: #ddad60"> </span><span class="op" start="131" style="color: #ddad60">then</span><span class="whitespace" start="135" style="color: #ddad60"> 
                              </span><span class="variable" start="141" select="quick" style="color: #ad95af">$compact</span><span class="whitespace" start="149" style="color: #ddad60">
                              </span><span class="op" start="154" style="color: #ddad60">else</span><span class="whitespace" start="158" style="color: #ddad60"> </span><span class="variable" start="159" select="quick" style="color: #ad95af">$an-offset</span><span class="whitespace" start="169" style="color: #ddad60"> </span><span class="op" start="170" style="color: #ddad60">+</span><span class="whitespace" start="171" style="color: #ddad60"> </span><span class="variable" start="172" select="quick" style="color: #ad95af">$lineOffset</span><span class="whitespace" start="183" style="color: #ddad60">
                          </span><span class="op" start="184" style="color: #ddad60">else</span><span class="whitespace" start="188" style="color: #ddad60"> </span><span class="variable" start="189" select="quick" style="color: #ad95af">$an-offset</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">av-outOffset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="32" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$prevClass</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">=</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="parenthesis" start="18" pair-end="31" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="19" style="color: #585858">en</span><span class="op" style="color: #ddad60">'</span><span class="op" start="23" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="24" style="color: #585858">enxsl</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="31" style="color: #295f94">)</span><span class="parenthesis" start="32" style="color: #295f94">)</span><span class="whitespace" start="33" style="color: #ddad60">
                              </span><span class="op" start="38" style="color: #ddad60">then</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="numeric" start="43" style="color: #566874">0</span><span class="whitespace" start="44" style="color: #ddad60">
                          </span><span class="op" start="45" style="color: #ddad60">else</span><span class="whitespace" start="49" style="color: #ddad60"> </span><span class="if" start="50" style="color: #ddad60">if</span><span class="whitespace" start="52" style="color: #ddad60"> </span><span class="parenthesis" start="53" pair-end="85" select="quick" style="color: #295f94">(</span><span class="variable" start="54" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="60" style="color: #ddad60"> </span><span class="op" start="61" style="color: #ddad60">eq</span><span class="whitespace" start="63" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="64" style="color: #585858">atn</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="69" style="color: #ddad60"> </span><span class="op" start="70" style="color: #ddad60">and</span><span class="whitespace" start="73" style="color: #ddad60"> </span><span class="variable" start="74" select="quick" style="color: #ad95af">$multi-line</span><span class="parenthesis" start="85" style="color: #295f94">)</span><span class="whitespace" start="86" style="color: #ddad60">
                              </span><span class="op" start="91" style="color: #ddad60">then</span><span class="whitespace" start="95" style="color: #ddad60"> </span><span class="variable" start="96" select="quick" style="color: #ad95af">$lineOffset</span><span class="whitespace" start="107" style="color: #ddad60"> 
                          </span><span class="op" start="109" style="color: #ddad60">else</span><span class="whitespace" start="113" style="color: #ddad60"> </span><span class="if" start="114" style="color: #ddad60">if</span><span class="whitespace" start="116" style="color: #ddad60"> </span><span class="parenthesis" start="117" pair-end="300" select="quick" style="color: #295f94">(</span><span class="variable" start="118" select="quick" style="color: #ad95af">$prevClass</span><span class="whitespace" start="128" style="color: #ddad60"> </span><span class="op" start="129" style="color: #ddad60">eq</span><span class="whitespace" start="131" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="132" style="color: #585858">atneq</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="139" style="color: #ddad60"> </span><span class="op" start="140" style="color: #ddad60">or</span><span class="whitespace" start="142" style="color: #ddad60"> </span><span class="variable" start="143" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="149" style="color: #ddad60"> </span><span class="op" start="150" style="color: #ddad60">=</span><span class="whitespace" start="151" style="color: #ddad60"> </span><span class="parenthesis" start="152" pair-end="179" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="153" style="color: #585858">atneq</span><span class="op" style="color: #ddad60">'</span><span class="op" start="160" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="161" style="color: #585858">atn</span><span class="op" style="color: #ddad60">'</span><span class="op" start="166" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="167" style="color: #585858">vname</span><span class="op" style="color: #ddad60">'</span><span class="op" start="174" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="175" style="color: #585858">av</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="179" style="color: #295f94">)</span><span class="whitespace" start="180" style="color: #ddad60">
                              </span><span class="op" start="185" style="color: #ddad60">or</span><span class="whitespace" start="187" style="color: #ddad60"> </span><span class="parenthesis" start="188" pair-end="248" select="quick" style="color: #295f94">(</span><span class="variable" start="189" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="195" style="color: #ddad60"> </span><span class="op" start="196" style="color: #ddad60">eq</span><span class="whitespace" start="198" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="199" style="color: #585858">z</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="202" style="color: #ddad60"> </span><span class="op" start="203" style="color: #ddad60">and</span><span class="whitespace" start="206" style="color: #ddad60"> </span><span class="variable" start="207" select="quick" style="color: #ad95af">$nextClass</span><span class="whitespace" start="217" style="color: #ddad60"> </span><span class="op" start="218" style="color: #ddad60">=</span><span class="whitespace" start="219" style="color: #ddad60"> </span><span class="parenthesis" start="220" pair-end="247" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="221" style="color: #585858">atneq</span><span class="op" style="color: #ddad60">'</span><span class="op" start="228" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="229" style="color: #585858">atn</span><span class="op" style="color: #ddad60">'</span><span class="op" start="234" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="235" style="color: #585858">vname</span><span class="op" style="color: #ddad60">'</span><span class="op" start="242" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="243" style="color: #585858">av</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="247" style="color: #295f94">)</span><span class="parenthesis" start="248" style="color: #295f94">)</span><span class="whitespace" start="249" style="color: #ddad60">
                          </span><span class="op" start="250" style="color: #ddad60">or</span><span class="whitespace" start="252" style="color: #ddad60"> </span><span class="parenthesis" start="253" pair-end="299" select="quick" style="color: #295f94">(</span><span class="variable" start="254" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="260" style="color: #ddad60"> </span><span class="op" start="261" style="color: #ddad60">eq</span><span class="whitespace" start="263" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="264" style="color: #585858">z</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="267" style="color: #ddad60"> </span><span class="op" start="268" style="color: #ddad60">and</span><span class="whitespace" start="271" style="color: #ddad60"> </span><span class="variable" start="272" select="quick" style="color: #ad95af">$prevClass</span><span class="whitespace" start="282" style="color: #ddad60"> </span><span class="op" start="283" style="color: #ddad60">=</span><span class="whitespace" start="284" style="color: #ddad60"> </span><span class="parenthesis" start="285" pair-end="298" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="286" style="color: #585858">vname</span><span class="op" style="color: #ddad60">'</span><span class="op" start="293" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="294" style="color: #585858">av</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="298" style="color: #295f94">)</span><span class="parenthesis" start="299" style="color: #295f94">)</span><span class="parenthesis" start="300" style="color: #295f94">)</span><span class="whitespace" start="301" style="color: #ddad60">
                              </span><span class="op" start="306" style="color: #ddad60">then</span><span class="whitespace" start="310" style="color: #ddad60"> </span><span class="variable" start="311" select="quick" style="color: #ad95af">$av-offset</span><span class="whitespace" start="321" style="color: #ddad60"> </span><span class="op" start="322" style="color: #ddad60">+</span><span class="whitespace" start="323" style="color: #ddad60"> </span><span class="variable" start="324" select="quick" style="color: #ad95af">$lineOffset</span><span class="whitespace" start="335" style="color: #ddad60">
                          </span><span class="op" start="336" style="color: #ddad60">else</span><span class="whitespace" start="340" style="color: #ddad60"> </span><span class="variable" start="341" select="quick" style="color: #ad95af">$av-offset</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="32" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$prevClass</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">=</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="parenthesis" start="18" pair-end="31" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="19" style="color: #585858">en</span><span class="op" style="color: #ddad60">'</span><span class="op" start="23" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="24" style="color: #585858">enxsl</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="31" style="color: #295f94">)</span><span class="parenthesis" start="32" style="color: #295f94">)</span><span class="whitespace" start="33" style="color: #ddad60">
                              </span><span class="op" start="38" style="color: #ddad60">then</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="variable" start="43" select="quick" style="color: #ad95af">$compact</span><span class="whitespace" start="51" style="color: #ddad60">
                          </span><span class="op" start="52" style="color: #ddad60">else</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="if" start="57" style="color: #ddad60">if</span><span class="whitespace" start="59" style="color: #ddad60"> </span><span class="parenthesis" start="60" pair-end="80" select="quick" style="color: #295f94">(</span><span class="variable" start="61" select="quick" style="color: #ad95af">$nextClass</span><span class="whitespace" start="71" style="color: #ddad60"> </span><span class="op" start="72" style="color: #ddad60">eq</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="75" style="color: #585858">atn</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="80" style="color: #295f94">)</span><span class="whitespace" start="81" style="color: #ddad60"> 
                              </span><span class="op" start="87" style="color: #ddad60">then</span><span class="whitespace" start="91" style="color: #ddad60"> </span><span class="variable" start="92" select="quick" style="color: #ad95af">$an-outOffset</span><span class="whitespace" start="105" style="color: #ddad60">
                          </span><span class="op" start="106" style="color: #ddad60">else</span><span class="whitespace" start="110" style="color: #ddad60"> </span><span class="if" start="111" style="color: #ddad60">if</span><span class="whitespace" start="113" style="color: #ddad60"> </span><span class="parenthesis" start="114" pair-end="158" select="quick" style="color: #295f94">(</span><span class="variable" start="115" select="quick" style="color: #ad95af">$nextClass</span><span class="whitespace" start="125" style="color: #ddad60"> </span><span class="op" start="126" style="color: #ddad60">=</span><span class="whitespace" start="127" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="128" style="color: #585858">av</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="132" style="color: #ddad60"> </span><span class="op" start="133" style="color: #ddad60">or</span><span class="whitespace" start="135" style="color: #ddad60"> </span><span class="variable" start="136" select="quick" style="color: #ad95af">$class</span><span class="whitespace" start="142" style="color: #ddad60"> </span><span class="op" start="143" style="color: #ddad60">eq</span><span class="whitespace" start="145" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="146" style="color: #585858">whitespace</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="158" style="color: #295f94">)</span><span class="whitespace" start="159" style="color: #ddad60">
                              </span><span class="op" start="164" style="color: #ddad60">then</span><span class="whitespace" start="168" style="color: #ddad60"> </span><span class="variable" start="169" select="quick" style="color: #ad95af">$an-outOffset</span><span class="whitespace" start="182" style="color: #ddad60"> </span><span class="op" start="183" style="color: #ddad60">+</span><span class="whitespace" start="184" style="color: #ddad60"> </span><span class="variable" start="185" select="quick" style="color: #ad95af">$av-outOffset</span><span class="whitespace" start="198" style="color: #ddad60">
                          </span><span class="op" start="199" style="color: #ddad60">else</span><span class="whitespace" start="203" style="color: #ddad60"> </span><span class="numeric" start="204" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">indent</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="44" select="quick" style="color: #885d3b">f:createIndent</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="16" pair-end="33" select="quick" style="color: #295f94">(</span><span class="variable" start="17" select="quick" style="color: #ad95af">$level</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="op" start="24" style="color: #ddad60">*</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="variable" start="26" select="quick" style="color: #ad95af">$margin</span><span class="parenthesis" start="33" style="color: #295f94">)</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" start="35" style="color: #ddad60">+</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="variable" start="37" select="quick" style="color: #ad95af">$offset</span><span class="parenthesis" start="44" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">last-level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="13" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$outdent</span><span class="parenthesis" start="13" style="color: #295f94">)</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">then</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="variable" start="20" select="quick" style="color: #ad95af">$level</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" start="27" style="color: #ddad60">-</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="numeric" start="29" style="color: #566874">1</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="op" start="31" style="color: #ddad60">else</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="variable" start="36" select="quick" style="color: #ad95af">$level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">last-indent</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="49" select="quick" style="color: #885d3b">f:createIndent</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="16" pair-end="38" select="quick" style="color: #295f94">(</span><span class="variable" start="17" select="quick" style="color: #ad95af">$last-level</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="op" start="29" style="color: #ddad60">*</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="variable" start="31" select="quick" style="color: #ad95af">$margin</span><span class="parenthesis" start="38" style="color: #295f94">)</span><span class="whitespace" start="39" style="color: #ddad60"> </span><span class="op" start="40" style="color: #ddad60">+</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="variable" start="42" select="quick" style="color: #ad95af">$offset</span><span class="parenthesis" start="49" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">line-count</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="22" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="7" select="quick" style="color: #ad95af">$indented-lines</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">span-text</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="28" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="27" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="12" select="quick" style="color: #ad95af">$indented-lines</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="whitespace" start="29" style="color: #ddad60">
                          </span><span class="op" start="30" style="color: #ddad60">then</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="function" start="35" pair-end="216" select="quick" style="color: #885d3b">string-join</span><span class="parenthesis" style="color: #295f94">(</span><span class="whitespace" start="47" style="color: #ddad60">
                          </span><span class="parenthesis" start="48" pair-end="211" select="quick" style="color: #295f94">(</span><span class="variable" start="49" select="quick" style="color: #ad95af">$flat-line</span><span class="op" start="59" style="color: #ddad60">,</span><span class="whitespace" start="60" style="color: #ddad60">
                          </span><span class="higher" start="61" style="color: #ddad60">for</span><span class="whitespace" start="64" style="color: #ddad60"> </span><span id="rng-$num" class="variable" start="65" select="quick" style="color: #ad95af">$num</span><span class="whitespace" start="69" style="color: #ddad60"> </span><span class="op" start="70" style="color: #ddad60">in</span><span class="whitespace" start="72" style="color: #ddad60"> </span><span class="numeric" start="73" style="color: #566874">1</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="op" start="75" style="color: #ddad60">to</span><span class="whitespace" start="77" style="color: #ddad60"> </span><span class="variable" start="78" select="quick" style="color: #ad95af">$line-count</span><span class="whitespace" start="89" style="color: #ddad60"> </span><span class="op" start="90" style="color: #ddad60">-</span><span class="whitespace" start="91" style="color: #ddad60"> </span><span class="numeric" start="92" style="color: #566874">1</span><span class="whitespace" start="93" style="color: #ddad60"> </span><span class="op" start="94" style="color: #ddad60">return</span><span class="whitespace" start="100" style="color: #ddad60">
                          </span><span class="function" start="101" pair-end="147" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="108" style="color: #585858">&amp;#10;</span><span class="op" style="color: #ddad60">'</span><span class="op" start="115" style="color: #ddad60">,</span><span class="whitespace" start="116" style="color: #ddad60"> </span><span class="variable" start="117" select="quick" style="color: #ad95af">$indent</span><span class="op" start="124" style="color: #ddad60">,</span><span class="whitespace" start="125" style="color: #ddad60"> </span><span class="variable" start="126" select="quick" style="color: #ad95af">$indented-lines</span><span class="filter" start="141" pair-end="146" select="quick" style="color: #295f94">[</span><span class="variable" start="142" select="quick" style="color: #ad95af">$num</span><span class="filter" start="146" style="color: #295f94">]</span><span class="parenthesis" start="147" style="color: #295f94">)</span><span class="op" start="148" style="color: #ddad60">,</span><span class="whitespace" start="149" style="color: #ddad60">
                          </span><span class="function" start="150" pair-end="208" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="157" style="color: #585858">&amp;#10;</span><span class="op" style="color: #ddad60">'</span><span class="op" start="164" style="color: #ddad60">,</span><span class="whitespace" start="165" style="color: #ddad60"> </span><span class="variable" start="166" select="quick" style="color: #ad95af">$last-indent</span><span class="op" start="178" style="color: #ddad60">,</span><span class="whitespace" start="179" style="color: #ddad60"> </span><span class="variable" start="180" select="quick" style="color: #ad95af">$indented-lines</span><span class="filter" start="195" pair-end="207" select="quick" style="color: #295f94">[</span><span class="variable" start="196" select="quick" style="color: #ad95af">$line-count</span><span class="filter" start="207" style="color: #295f94">]</span><span class="parenthesis" start="208" style="color: #295f94">)</span><span class="whitespace" start="209" style="color: #ddad60"> 
                          </span><span class="parenthesis" start="211" style="color: #295f94">)</span><span class="op" start="212" style="color: #ddad60">,</span><span class="whitespace" start="213" style="color: #ddad60">
                          </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="214" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="216" style="color: #295f94">)</span><span class="whitespace" start="217" style="color: #ddad60">
                          </span><span class="op" start="218" style="color: #ddad60">else</span><span class="whitespace" start="222" style="color: #ddad60"> </span><span class="if" start="223" style="color: #ddad60">if</span><span class="whitespace" start="225" style="color: #ddad60"> </span><span class="parenthesis" start="226" pair-end="255" select="quick" style="color: #295f94">(</span><span class="variable" start="227" select="quick" style="color: #ad95af">$multi-line</span><span class="whitespace" start="238" style="color: #ddad60"> </span><span class="op" start="239" style="color: #ddad60">and</span><span class="whitespace" start="242" style="color: #ddad60"> </span><span class="variable" start="243" select="quick" style="color: #ad95af">$offset</span><span class="whitespace" start="250" style="color: #ddad60"> </span><span class="op" start="251" style="color: #ddad60">gt</span><span class="whitespace" start="253" style="color: #ddad60"> </span><span class="numeric" start="254" style="color: #566874">0</span><span class="parenthesis" start="255" style="color: #295f94">)</span><span class="whitespace" start="256" style="color: #ddad60"> </span><span class="op" start="257" style="color: #ddad60">then</span><span class="whitespace" start="261" style="color: #ddad60">
                          </span><span class="function" start="262" pair-end="300" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="269" select="quick" style="color: #ad95af">$indent</span><span class="op" start="276" style="color: #ddad60">,</span><span class="whitespace" start="277" style="color: #ddad60"> </span><span class="function" start="278" pair-end="299" select="quick" style="color: #885d3b">string</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="285" select="quick" style="color: #ad95af">$line-parts</span><span class="filter" start="296" pair-end="298" select="quick" style="color: #295f94">[</span><span class="numeric" start="297" style="color: #566874">1</span><span class="filter" start="298" style="color: #295f94">]</span><span class="parenthesis" start="299" style="color: #295f94">)</span><span class="parenthesis" start="300" style="color: #295f94">)</span><span class="whitespace" start="301" style="color: #ddad60">
                          </span><span class="op" start="302" style="color: #ddad60">else</span><span class="whitespace" start="306" style="color: #ddad60"> </span><span class="function" start="307" pair-end="328" select="quick" style="color: #885d3b">string</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="314" select="quick" style="color: #ad95af">$line-parts</span><span class="filter" start="325" pair-end="327" select="quick" style="color: #295f94">[</span><span class="numeric" start="326" style="color: #566874">1</span><span class="filter" start="327" style="color: #295f94">]</span><span class="parenthesis" start="328" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">output</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$span</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$span-text</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">an-offset</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$an-outOffset</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">an-offset</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">av-offset</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$av-outOffset</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">av-offset</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">multi-line</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="23" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$indented-lines</span><span class="parenthesis" start="23" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">multi-line</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">mixed-level</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$new-mixed-level</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">mixed-level</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">output</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:left-trim</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">text</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="26" select="quick" style="color: #885d3b">replace</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="9" select="quick" style="color: #ad95af">$text</span><span class="op" start="14" style="color: #ddad60">,</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858">^\s+</span><span class="op" style="color: #ddad60">'</span><span class="op" start="22" style="color: #ddad60">,</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="24" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="26" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:createIndent</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">padCount</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$padCount</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">ge</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="numeric" start="14" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="52" select="quick" style="color: #885d3b">string-join</span><span class="parenthesis" style="color: #295f94">(</span><span class="higher" start="13" style="color: #ddad60">for</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span id="rng-$i" class="variable" start="17" select="quick" style="color: #ad95af">$i</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">in</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="numeric" start="23" style="color: #566874">1</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="op" start="25" style="color: #ddad60">to</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="variable" start="28" select="quick" style="color: #ad95af">$padCount</span><span class="whitespace" start="37" style="color: #ddad60"> 
                            </span><span class="op" start="39" style="color: #ddad60">return</span><span class="whitespace" start="45" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="46" style="color: #585858"> </span><span class="op" style="color: #ddad60">'</span><span class="op" start="49" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="50" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="52" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
  XSLT function signature: 
      f:get-css()
  
  description:
  
      Generates a CSS file used to colorise span elements generates by the previous 2 functions
      The colors generated depend on the theme specified with the color-theme
      parameter. The color theme uses the 'Solarized' color points specified at: http://ethanschoonover.com/solarized
  
  params:
      color-theme: xs:string - name of color theme to use 
  
  </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:get-theme</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">input-theme</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="28" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$input-theme</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" start="18" style="color: #ddad60">eq</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="21" style="color: #585858">light</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" start="30" style="color: #ddad60">then</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="35" style="color: #585858">solarized-light</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="52" style="color: #ddad60">
                          </span><span class="op" start="53" style="color: #ddad60">else</span><span class="whitespace" start="57" style="color: #ddad60"> </span><span class="if" start="58" style="color: #ddad60">if</span><span class="whitespace" start="60" style="color: #ddad60"> </span><span class="parenthesis" start="61" pair-end="84" select="quick" style="color: #295f94">(</span><span class="variable" start="62" select="quick" style="color: #ad95af">$input-theme</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="op" start="75" style="color: #ddad60">eq</span><span class="whitespace" start="77" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="78" style="color: #585858">dark</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="84" style="color: #295f94">)</span><span class="whitespace" start="85" style="color: #ddad60"> </span><span class="op" start="86" style="color: #ddad60">then</span><span class="whitespace" start="90" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="91" style="color: #585858">solarized-dark</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="107" style="color: #ddad60">
                          </span><span class="op" start="108" style="color: #ddad60">else</span><span class="whitespace" start="112" style="color: #ddad60"> </span><span class="variable" start="113" select="quick" style="color: #ad95af">$input-theme</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:get-css</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:apply-templates</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$css-doc</span><span class="step" start="9" style="color: #ddad60">/</span><span class="qname" start="10" select="quick" style="color: #b05a65">c:themes</span><span class="step" start="18" style="color: #ddad60">/</span><span class="qname" start="19" select="quick" style="color: #b05a65">css:boiler-plate</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">mode</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">css</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:prefixed-name</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prefix</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">name</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string+</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:for-each</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$name</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="18" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$prefix</span><span class="op" start="15" style="color: #ddad60">,</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="context" start="17" style="color: #566874">.</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:for-each</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:get-xsd-element-names</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prefix</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">doctype</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:for-each</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="27" select="quick" style="color: #885d3b">f:xsd-xpath-names</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="19" select="quick" style="color: #ad95af">$doctype</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="step" start="28" style="color: #ddad60">/</span><span class="qname" start="29" select="quick" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">name</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="22" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$prefix</span><span class="op" start="15" style="color: #ddad60">,</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="axis" start="17" style="color: #566874">@</span><span class="qname" start="18" select="quick" style="color: #b05a65">name</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="qname" start="1" select="quick" style="color: #b05a65">*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:copy</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:for-each</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:get-xsd-attribute-names</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prefix</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">doctype</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:for-each</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="27" select="quick" style="color: #885d3b">f:xsd-xpath-names</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="19" select="quick" style="color: #ad95af">$doctype</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="step" start="28" style="color: #ddad60">/</span><span class="qname" start="29" select="quick" style="color: #b05a65">attribute</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">name</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="22" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$prefix</span><span class="op" start="15" style="color: #ddad60">,</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="axis" start="17" style="color: #566874">@</span><span class="qname" start="18" select="quick" style="color: #b05a65">name</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="qname" start="1" select="quick" style="color: #b05a65">*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:copy</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:for-each</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:get-xsd-fnames</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prefix</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">doctype</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:for-each</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="31" select="quick" style="color: #885d3b">f:xsd-highlight-names</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="23" select="quick" style="color: #ad95af">$doctype</span><span class="parenthesis" start="31" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="function" start="1" pair-end="22" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$prefix</span><span class="op" start="15" style="color: #ddad60">,</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="axis" start="17" style="color: #566874">@</span><span class="qname" start="18" select="quick" style="color: #b05a65">name</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">attribute</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">attribute</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:for-each</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:is-xsd-fname</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prefix</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">doctype</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">element</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">attribute</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">fnames</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="35" select="quick" style="color: #885d3b">f:get-xsd-fnames</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$prefix</span><span class="op" start="25" style="color: #ddad60">,</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="variable" start="27" select="quick" style="color: #ad95af">$doctype</span><span class="parenthesis" start="35" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="61" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$fnames</span><span class="filter" start="15" pair-end="60" select="quick" style="color: #295f94">[</span><span class="axis" start="16" style="color: #566874">@</span><span class="qname" start="17" select="quick" style="color: #b05a65">name</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">=</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="variable" start="24" select="quick" style="color: #ad95af">$element</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" start="33" style="color: #ddad60">and</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="axis" start="37" style="color: #566874">@</span><span class="qname" start="38" select="quick" style="color: #b05a65">attribute</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="op" start="48" style="color: #ddad60">=</span><span class="whitespace" start="49" style="color: #ddad60"> </span><span class="variable" start="50" select="quick" style="color: #ad95af">$attribute</span><span class="filter" start="60" style="color: #295f94">]</span><span class="parenthesis" start="61" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:inline-css-main</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">css-text</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:apply-templates</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$css-doc</span><span class="step" start="9" style="color: #ddad60">/</span><span class="qname" start="10" select="quick" style="color: #b05a65">c:themes</span><span class="step" start="18" style="color: #ddad60">/</span><span class="qname" start="19" select="quick" style="color: #b05a65">css:boiler-plate</span><span class="step" start="35" style="color: #ddad60">/</span><span class="qname" start="36" select="quick" style="color: #b05a65">css:main</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">mode</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">css</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="26" select="quick" style="color: #885d3b">string-join</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="13" select="quick" style="color: #ad95af">$css-text</span><span class="op" start="22" style="color: #ddad60">,</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="24" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="26" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:inline-css-toc</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">css-text</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:apply-templates</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$css-doc</span><span class="step" start="9" style="color: #ddad60">/</span><span class="qname" start="10" select="quick" style="color: #b05a65">c:themes</span><span class="step" start="18" style="color: #ddad60">/</span><span class="qname" start="19" select="quick" style="color: #b05a65">css:boiler-plate</span><span class="step" start="35" style="color: #ddad60">/</span><span class="qname" start="36" select="quick" style="color: #b05a65">css:toc</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">mode</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">css</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="26" select="quick" style="color: #885d3b">string-join</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="13" select="quick" style="color: #ad95af">$css-text</span><span class="op" start="22" style="color: #ddad60">,</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="24" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="26" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">match</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="qname" start="1" select="quick" style="color: #b05a65">css:font</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">mode</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">css</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="24" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$font-name</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">eq</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="19" style="color: #585858">scp</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="24" style="color: #295f94">)</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="op" start="26" style="color: #ddad60">then</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="axis" start="31" style="color: #566874">@</span><span class="qname" start="32" select="quick" style="color: #b05a65">scp</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="op" start="36" style="color: #ddad60">else</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="41" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">match</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="qname" start="1" select="quick" style="color: #b05a65">css:map</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">mode</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">css</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">element</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">element</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:for-each</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$color-theme-data</span><span class="step" start="18" style="color: #ddad60">/</span><span class="qname" start="19" select="quick" style="color: #b05a65">c:color</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color-value</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">value</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color-selectors</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element(c:color)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                    </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$color-theme-data</span><span class="step" start="18" style="color: #ddad60">/</span><span class="context" start="19" style="color: #566874">..</span><span class="step" start="21" style="color: #ddad60">/</span><span class="qname" start="22" select="quick" style="color: #b05a65">c:color-map</span><span class="step" start="33" style="color: #ddad60">/</span><span class="qname" start="34" select="quick" style="color: #b05a65">c:color</span><span class="filter" start="41" pair-end="57" select="quick" style="color: #295f94">[</span><span class="axis" start="42" style="color: #566874">@</span><span class="qname" start="43" select="quick" style="color: #b05a65">name</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="op" start="48" style="color: #ddad60">eq</span><span class="whitespace" start="50" style="color: #ddad60"> </span><span class="variable" start="51" select="quick" style="color: #ad95af">$color</span><span class="filter" start="57" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">css-prop</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="parenthesis" start="1" pair-end="37" select="quick" style="color: #295f94">(</span><span class="variable" start="2" select="quick" style="color: #ad95af">$color-selectors</span><span class="step" start="18" style="color: #ddad60">/</span><span class="axis" start="19" style="color: #566874">@</span><span class="qname" start="20" select="quick" style="color: #b05a65">property</span><span class="op" start="28" style="color: #ddad60">,</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="30" style="color: #585858">color</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="37" style="color: #295f94">)</span><span class="filter" start="38" pair-end="40" select="quick" style="color: #295f94">[</span><span class="numeric" start="39" style="color: #566874">1</span><span class="filter" start="40" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">selectors</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="33" select="quick" style="color: #885d3b">normalize-space</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="17" select="quick" style="color: #ad95af">$color-selectors</span><span class="parenthesis" start="33" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">selector-tokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="26" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="10" select="quick" style="color: #ad95af">$selectors</span><span class="op" start="20" style="color: #ddad60">,</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="22" style="color: #585858">\s</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="26" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string+</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">qselector-tokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="higher" start="1" style="color: #ddad60">for</span><span class="whitespace" start="4" style="color: #ddad60"> </span><span id="rng-$s" class="variable" start="5" select="quick" style="color: #ad95af">$s</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">in</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="variable" start="11" select="quick" style="color: #ad95af">$selector-tokens</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="op" start="28" style="color: #ddad60">return</span><span class="whitespace" start="34" style="color: #ddad60">
                                                    </span><span class="function" start="35" pair-end="59" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="42" select="quick" style="color: #ad95af">$element</span><span class="op" start="50" style="color: #ddad60">,</span><span class="whitespace" start="51" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="52" style="color: #585858">.</span><span class="op" style="color: #ddad60">'</span><span class="op" start="55" style="color: #ddad60">,</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="variable" start="57" select="quick" style="color: #ad95af">$s</span><span class="parenthesis" start="59" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">selector-string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="36" select="quick" style="color: #885d3b">string-join</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="13" select="quick" style="color: #ad95af">$qselector-tokens</span><span class="op" start="30" style="color: #ddad60">,</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="32" style="color: #585858">, </span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="36" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="71" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="whitespace" start="8" style="color: #ddad60">
                            </span><span class="variable" start="9" select="quick" style="color: #ad95af">$selector-string</span><span class="op" start="25" style="color: #ddad60">,</span><span class="whitespace" start="26" style="color: #ddad60">
                            </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="27" style="color: #585858"> {</span><span class="op" style="color: #ddad60">'</span><span class="op" start="31" style="color: #ddad60">,</span><span class="whitespace" start="32" style="color: #ddad60">
                            </span><span class="variable" start="33" select="quick" style="color: #ad95af">$css-prop</span><span class="op" start="42" style="color: #ddad60">,</span><span class="whitespace" start="43" style="color: #ddad60">
                            </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="44" style="color: #585858">: #</span><span class="op" style="color: #ddad60">'</span><span class="op" start="49" style="color: #ddad60">,</span><span class="whitespace" start="50" style="color: #ddad60">
                            </span><span class="variable" start="51" select="quick" style="color: #ad95af">$color-value</span><span class="op" start="63" style="color: #ddad60">,</span><span class="whitespace" start="64" style="color: #ddad60">
                            </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="65" style="color: #585858">; }</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="70" style="color: #ddad60">
                            </span><span class="parenthesis" start="71" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:for-each</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
  Sample output:
  &lt;colors&gt;
  &lt;color name="yellow" value="b58900" property="background-color"&gt;
  &lt;class&gt;yellow&lt;/class&gt;
  &lt;class&gt;op&lt;/class&gt;
  &lt;class&gt;type-op&lt;/class&gt;
  &lt;/color&gt;
  ...
  &lt;/colors&gt;
  
  </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:get-inline-colors</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element(colors)+</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">theme</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element(c:theme)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color-map</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$theme</span><span class="step" start="7" style="color: #ddad60">/</span><span class="context" start="8" style="color: #566874">..</span><span class="step" start="10" style="color: #ddad60">/</span><span class="qname" start="11" select="quick" style="color: #b05a65">c:color-map</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element(c:color-map)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">colors</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:for-each</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$theme</span><span class="step" start="7" style="color: #ddad60">/</span><span class="qname" start="8" select="quick" style="color: #b05a65">c:color</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">color</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color-key</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element(c:color)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                        </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$color-map</span><span class="step" start="11" style="color: #ddad60">/</span><span class="qname" start="12" select="quick" style="color: #b05a65">c:color</span><span class="filter" start="19" pair-end="39" select="quick" style="color: #295f94">[</span><span class="axis" start="20" style="color: #566874">@</span><span class="qname" start="21" select="quick" style="color: #b05a65">name</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="op" start="26" style="color: #ddad60">eq</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="variable" start="29" select="quick" style="color: #ad95af">$color-key</span><span class="filter" start="39" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$color</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">property</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">property</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$color</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">property</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:for-each</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="40" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="10" pair-end="32" select="quick" style="color: #885d3b">normalize-space</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="26" select="quick" style="color: #ad95af">$color</span><span class="parenthesis" start="32" style="color: #295f94">)</span><span class="op" start="33" style="color: #ddad60">,</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="35" style="color: #585858">\s+</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="40" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">class</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="context" start="1" style="color: #566874">.</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">class</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:for-each</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">color</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:for-each</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">colors</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">match</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="qname" start="1" select="quick" style="color: #b05a65">css:color</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">mode</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">css</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="62" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="8" style="color: #585858">#</span><span class="op" style="color: #ddad60">'</span><span class="op" start="11" style="color: #ddad60">,</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="variable" start="13" select="quick" style="color: #ad95af">$color-theme-data</span><span class="step" start="30" style="color: #ddad60">/</span><span class="qname" start="31" select="quick" style="color: #b05a65">c:color</span><span class="filter" start="38" pair-end="54" select="quick" style="color: #295f94">[</span><span class="axis" start="39" style="color: #566874">@</span><span class="qname" start="40" select="quick" style="color: #b05a65">name</span><span class="whitespace" start="44" style="color: #ddad60"> </span><span class="op" start="45" style="color: #ddad60">eq</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="variable" start="48" select="quick" style="color: #ad95af">$color</span><span class="filter" start="54" style="color: #295f94">]</span><span class="step" start="55" style="color: #ddad60">/</span><span class="axis" start="56" style="color: #566874">@</span><span class="qname" start="57" select="quick" style="color: #b05a65">value</span><span class="parenthesis" start="62" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:getTagType</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">token</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">t</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">t1</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="17" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$t</span><span class="op" start="13" style="color: #ddad60">,</span><span class="numeric" start="14" style="color: #566874">1</span><span class="op" start="15" style="color: #ddad60">,</span><span class="numeric" start="16" style="color: #566874">1</span><span class="parenthesis" start="17" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">t2</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="17" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$t</span><span class="op" start="13" style="color: #ddad60">,</span><span class="numeric" start="14" style="color: #566874">2</span><span class="op" start="15" style="color: #ddad60">,</span><span class="numeric" start="16" style="color: #566874">1</span><span class="parenthesis" start="17" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$t1</span><span class="whitespace" start="4" style="color: #ddad60"> </span><span class="op" start="5" style="color: #ddad60">eq</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="8" style="color: #585858">?</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">pi</span><span class="op" style="color: #ddad60">'</span><span class="op" start="5" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="6" style="color: #585858">?</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$t1</span><span class="whitespace" start="4" style="color: #ddad60"> </span><span class="op" start="5" style="color: #ddad60">eq</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="8" style="color: #585858">!</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">and</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="variable" start="16" select="quick" style="color: #ad95af">$t2</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">eq</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="23" style="color: #585858">-</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">cm</span><span class="op" style="color: #ddad60">'</span><span class="op" start="5" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="6" style="color: #585858">!--</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$t1</span><span class="whitespace" start="4" style="color: #ddad60"> </span><span class="op" start="5" style="color: #ddad60">eq</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="8" style="color: #585858">!</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">and</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="variable" start="16" select="quick" style="color: #ad95af">$t2</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">eq</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="23" style="color: #585858">[</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">cd</span><span class="op" style="color: #ddad60">'</span><span class="op" start="5" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="6" style="color: #585858">![CDATA[</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$t1</span><span class="whitespace" start="4" style="color: #ddad60"> </span><span class="op" start="5" style="color: #ddad60">eq</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="8" style="color: #585858">!</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">dt</span><span class="op" style="color: #ddad60">'</span><span class="op" start="5" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="6" style="color: #585858">!</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$t1</span><span class="whitespace" start="4" style="color: #ddad60"> </span><span class="op" start="5" style="color: #ddad60">eq</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="8" style="color: #585858">/</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">cl</span><span class="op" style="color: #ddad60">'</span><span class="op" start="5" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="6" style="color: #585858">/</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> open tag (may be  self-closing) </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">tg</span><span class="op" style="color: #ddad60">'</span><span class="op" start="5" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="6" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:expected-offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">in</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="19" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$in</span><span class="whitespace" start="8" style="color: #ddad60"> </span><span class="op" start="9" style="color: #ddad60">eq</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="12" style="color: #585858">?&amp;gt;</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="19" style="color: #295f94">)</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="op" start="21" style="color: #ddad60">then</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="numeric" start="26" style="color: #566874">2</span><span class="whitespace" start="27" style="color: #ddad60">
                          </span><span class="op" start="28" style="color: #ddad60">else</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="if" start="33" style="color: #ddad60">if</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="parenthesis" start="36" pair-end="52" select="quick" style="color: #295f94">(</span><span class="variable" start="37" select="quick" style="color: #ad95af">$in</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="op" start="41" style="color: #ddad60">eq</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="44" style="color: #585858">--&amp;gt;</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="52" style="color: #295f94">)</span><span class="whitespace" start="53" style="color: #ddad60"> </span><span class="op" start="54" style="color: #ddad60">then</span><span class="whitespace" start="58" style="color: #ddad60"> </span><span class="numeric" start="59" style="color: #566874">3</span><span class="whitespace" start="60" style="color: #ddad60">
                          </span><span class="op" start="61" style="color: #ddad60">else</span><span class="whitespace" start="65" style="color: #ddad60"> </span><span class="if" start="66" style="color: #ddad60">if</span><span class="whitespace" start="68" style="color: #ddad60"> </span><span class="parenthesis" start="69" pair-end="82" select="quick" style="color: #295f94">(</span><span class="variable" start="70" select="quick" style="color: #ad95af">$in</span><span class="whitespace" start="73" style="color: #ddad60"> </span><span class="op" start="74" style="color: #ddad60">eq</span><span class="whitespace" start="76" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="77" style="color: #585858">]]&gt;</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="82" style="color: #295f94">)</span><span class="whitespace" start="83" style="color: #ddad60"> </span><span class="op" start="84" style="color: #ddad60">then</span><span class="whitespace" start="88" style="color: #ddad60"> </span><span class="numeric" start="89" style="color: #566874">9</span><span class="whitespace" start="90" style="color: #ddad60">
                          </span><span class="op" start="91" style="color: #ddad60">else</span><span class="whitespace" start="95" style="color: #ddad60"> </span><span class="numeric" start="96" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:iterateTokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">counter</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">expected</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">beganAt</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">doctype</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">root-prefix</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">is-xsl</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$doctype</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="op" start="10" style="color: #ddad60">eq</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="13" style="color: #585858">xslt</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">is-xsd</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="12" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$is-xsl</span><span class="parenthesis" start="12" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">token</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tokens</span><span class="filter" start="8" pair-end="15" select="quick" style="color: #295f94">[</span><span class="variable" start="9" select="quick" style="color: #ad95af">$index</span><span class="filter" start="15" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prevToken</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tokens</span><span class="filter" start="8" pair-end="19" select="quick" style="color: #295f94">[</span><span class="variable" start="9" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">+</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="numeric" start="18" style="color: #566874">1</span><span class="filter" start="19" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">nextToken</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tokens</span><span class="filter" start="8" pair-end="19" select="quick" style="color: #295f94">[</span><span class="variable" start="9" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">-</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="numeric" start="18" style="color: #566874">1</span><span class="filter" start="19" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">awaiting</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$expected</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">ne</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="14" style="color: #585858">n</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    
    </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
    &lt;trace&gt;
    token: &lt;xsl:value-of select="$token"/&gt;
    expected: &lt;xsl:value-of select="$expected"/&gt;
    index: &lt;xsl:value-of select="$index"/&gt;
    &lt;/trace&gt;
    
    </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">expectedOutput</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">  looking to close an open tag </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> consider: &lt;!DOCTYPE person [&lt;!ELEMENT ... ]&gt; as well as reference only </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">beforeFind</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="35" select="quick" style="color: #885d3b">substring-before</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$token</span><span class="op" start="24" style="color: #ddad60">,</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="variable" start="26" select="quick" style="color: #ad95af">$expected</span><span class="parenthesis" start="35" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">found</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                      </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="36" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="30" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="19" select="quick" style="color: #ad95af">$beforeFind</span><span class="parenthesis" start="30" style="color: #295f94">)</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" start="32" style="color: #ddad60">gt</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="numeric" start="35" style="color: #566874">0</span><span class="parenthesis" start="36" style="color: #295f94">)</span><span class="whitespace" start="37" style="color: #ddad60">
                              </span><span class="op" start="38" style="color: #ddad60">then</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="function" start="43" pair-end="48" select="quick" style="color: #885d3b">true</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="48" style="color: #295f94">)</span><span class="whitespace" start="49" style="color: #ddad60"> 
                              </span><span class="op" start="51" style="color: #ddad60">else</span><span class="whitespace" start="55" style="color: #ddad60"> </span><span class="function" start="56" pair-end="90" select="quick" style="color: #885d3b">starts-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="68" select="quick" style="color: #ad95af">$beforeFind</span><span class="op" start="79" style="color: #ddad60">,</span><span class="whitespace" start="80" style="color: #ddad60"> </span><span class="variable" start="81" select="quick" style="color: #ad95af">$expected</span><span class="parenthesis" start="90" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$found</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="28" select="quick" style="color: #885d3b">f:expected-offset</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="19" select="quick" style="color: #ad95af">$expected</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">begin-token</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tokens</span><span class="filter" start="8" pair-end="17" select="quick" style="color: #295f94">[</span><span class="variable" start="9" select="quick" style="color: #ad95af">$beganAt</span><span class="filter" start="17" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">z</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="50" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="8" style="color: #585858">&amp;lt;</span><span class="op" style="color: #ddad60">'</span><span class="op" start="14" style="color: #ddad60">,</span><span class="function" start="15" pair-end="49" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="25" select="quick" style="color: #ad95af">$begin-token</span><span class="op" start="37" style="color: #ddad60">,</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="numeric" start="39" style="color: #566874">1</span><span class="op" start="40" style="color: #ddad60">,</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="variable" start="42" select="quick" style="color: #ad95af">$offset</span><span class="parenthesis" start="49" style="color: #295f94">)</span><span class="parenthesis" start="50" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">part-token</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="36" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$begin-token</span><span class="op" start="23" style="color: #ddad60">,</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="variable" start="25" select="quick" style="color: #ad95af">$offset</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" start="33" style="color: #ddad60">+</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="numeric" start="35" style="color: #566874">1</span><span class="parenthesis" start="36" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="31" select="quick" style="color: #885d3b">f:getTagType</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="14" select="quick" style="color: #ad95af">$tokens</span><span class="filter" start="21" pair-end="30" select="quick" style="color: #295f94">[</span><span class="variable" start="22" select="quick" style="color: #ad95af">$beganAt</span><span class="filter" start="30" style="color: #295f94">]</span><span class="parenthesis" start="31" style="color: #295f94">)</span><span class="filter" start="32" pair-end="34" select="quick" style="color: #295f94">[</span><span class="numeric" start="33" style="color: #566874">1</span><span class="filter" start="34" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> 
                </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="126" select="quick" style="color: #885d3b">string-join</span><span class="parenthesis" style="color: #295f94">(</span><span class="whitespace" start="13" style="color: #ddad60">
                        </span><span class="parenthesis" start="14" pair-end="120" select="quick" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$part-token</span><span class="op" start="26" style="color: #ddad60">,</span><span class="whitespace" start="27" style="color: #ddad60">
                        </span><span class="higher" start="28" style="color: #ddad60">for</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span id="rng-$x" class="variable" start="32" select="quick" style="color: #ad95af">$x</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" start="35" style="color: #ddad60">in</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="variable" start="38" select="quick" style="color: #ad95af">$beganAt</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="op" start="47" style="color: #ddad60">+</span><span class="whitespace" start="48" style="color: #ddad60"> </span><span class="numeric" start="49" style="color: #566874">1</span><span class="whitespace" start="50" style="color: #ddad60"> </span><span class="op" start="51" style="color: #ddad60">to</span><span class="whitespace" start="53" style="color: #ddad60"> </span><span class="parenthesis" start="54" pair-end="64" select="quick" style="color: #295f94">(</span><span class="variable" start="55" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="61" style="color: #ddad60"> </span><span class="numeric" start="62" style="color: #566874">-1</span><span class="parenthesis" start="64" style="color: #295f94">)</span><span class="whitespace" start="65" style="color: #ddad60"> </span><span class="op" start="66" style="color: #ddad60">return</span><span class="whitespace" start="72" style="color: #ddad60">
                        </span><span class="function" start="73" pair-end="99" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="80" style="color: #585858">&amp;lt;</span><span class="op" style="color: #ddad60">'</span><span class="op" start="86" style="color: #ddad60">,</span><span class="whitespace" start="87" style="color: #ddad60"> </span><span class="variable" start="88" select="quick" style="color: #ad95af">$tokens</span><span class="filter" start="95" pair-end="98" select="quick" style="color: #295f94">[</span><span class="variable" start="96" select="quick" style="color: #ad95af">$x</span><span class="filter" start="98" style="color: #295f94">]</span><span class="parenthesis" start="99" style="color: #295f94">)</span><span class="op" start="100" style="color: #ddad60">,</span><span class="whitespace" start="101" style="color: #ddad60">
                        </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="102" style="color: #585858">&amp;lt;</span><span class="op" style="color: #ddad60">'</span><span class="op" start="108" style="color: #ddad60">,</span><span class="variable" start="109" select="quick" style="color: #ad95af">$beforeFind</span><span class="parenthesis" start="120" style="color: #295f94">)</span><span class="whitespace" start="121" style="color: #ddad60">
                        </span><span class="op" start="122" style="color: #ddad60">,</span><span class="whitespace" start="123" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="124" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="126" style="color: #295f94">)</span><span class="whitespace" start="127" style="color: #ddad60">
                        </span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">z</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$expected</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">txt</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
            id="{js:getStackIndex()}"&gt;
            </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="76" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$token</span><span class="op" start="17" style="color: #ddad60">,</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="function" start="19" pair-end="44" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="33" select="quick" style="color: #ad95af">$beforeFind</span><span class="parenthesis" start="44" style="color: #295f94">)</span><span class="whitespace" start="45" style="color: #ddad60"> </span><span class="op" start="46" style="color: #ddad60">+</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="function" start="48" pair-end="71" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="62" select="quick" style="color: #ad95af">$expected</span><span class="parenthesis" start="71" style="color: #295f94">)</span><span class="whitespace" start="72" style="color: #ddad60"> </span><span class="op" start="73" style="color: #ddad60">+</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="numeric" start="75" style="color: #566874">1</span><span class="parenthesis" start="76" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">char1</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$token</span><span class="op" start="17" style="color: #ddad60">,</span><span class="numeric" start="18" style="color: #566874">1</span><span class="op" start="19" style="color: #ddad60">,</span><span class="numeric" start="20" style="color: #566874">1</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">is-element-start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="14" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$awaiting</span><span class="parenthesis" start="14" style="color: #295f94">)</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">and</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="function" start="20" pair-end="46" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="24" select="quick" style="color: #ad95af">$char1</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="op" start="31" style="color: #ddad60">=</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="parenthesis" start="33" pair-end="45" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="34" style="color: #585858">?</span><span class="op" style="color: #ddad60">'</span><span class="op" start="37" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="38" style="color: #585858">!</span><span class="op" style="color: #ddad60">'</span><span class="op" start="41" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="42" style="color: #585858">/</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="45" style="color: #295f94">)</span><span class="parenthesis" start="46" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">is-root-element</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$counter</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="op" start="10" style="color: #ddad60">eq</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="numeric" start="13" style="color: #566874">0</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">and</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="variable" start="19" select="quick" style="color: #ad95af">$is-element-start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> if root-prefix not initially supplied, get this from the first element name </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">new-root-prefix</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="21" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$is-root-element</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="whitespace" start="22" style="color: #ddad60">
                          </span><span class="op" start="23" style="color: #ddad60">then</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="if" start="28" style="color: #ddad60">if</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="parenthesis" start="31" pair-end="50" select="quick" style="color: #295f94">(</span><span class="variable" start="32" select="quick" style="color: #ad95af">$root-prefix</span><span class="whitespace" start="44" style="color: #ddad60"> </span><span class="op" start="45" style="color: #ddad60">eq</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="48" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="50" style="color: #295f94">)</span><span class="whitespace" start="51" style="color: #ddad60">
                              </span><span class="op" start="56" style="color: #ddad60">then</span><span class="whitespace" start="60" style="color: #ddad60">
                                  </span><span class="higher" start="69" style="color: #ddad60">for</span><span class="whitespace" start="72" style="color: #ddad60"> </span><span id="rng-$x" class="variable" start="73" select="quick" style="color: #ad95af">$x</span><span class="whitespace" start="75" style="color: #ddad60"> </span><span class="op" start="76" style="color: #ddad60">in</span><span class="whitespace" start="78" style="color: #ddad60"> </span><span class="function" start="79" pair-end="101" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="88" select="quick" style="color: #ad95af">$token</span><span class="op" start="94" style="color: #ddad60">,</span><span class="whitespace" start="95" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="96" style="color: #585858">\s+</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="101" style="color: #295f94">)</span><span class="filter" start="102" pair-end="104" select="quick" style="color: #295f94">[</span><span class="numeric" start="103" style="color: #566874">1</span><span class="filter" start="104" style="color: #295f94">]</span><span class="whitespace" start="105" style="color: #ddad60"> </span><span class="op" start="106" style="color: #ddad60">return</span><span class="whitespace" start="112" style="color: #ddad60"> 
                                  </span><span class="higher" start="122" style="color: #ddad60">for</span><span class="whitespace" start="125" style="color: #ddad60"> </span><span id="rng-$s" class="variable" start="126" select="quick" style="color: #ad95af">$s</span><span class="whitespace" start="128" style="color: #ddad60"> </span><span class="op" start="129" style="color: #ddad60">in</span><span class="whitespace" start="131" style="color: #ddad60"> </span><span class="function" start="132" pair-end="156" select="quick" style="color: #885d3b">substring-before</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="149" select="quick" style="color: #ad95af">$x</span><span class="op" start="151" style="color: #ddad60">,</span><span class="whitespace" start="152" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="153" style="color: #585858">:</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="156" style="color: #295f94">)</span><span class="whitespace" start="157" style="color: #ddad60"> </span><span class="op" start="158" style="color: #ddad60">return</span><span class="whitespace" start="164" style="color: #ddad60">
                                      </span><span class="if" start="177" style="color: #ddad60">if</span><span class="whitespace" start="179" style="color: #ddad60"> </span><span class="parenthesis" start="180" pair-end="189" select="quick" style="color: #295f94">(</span><span class="variable" start="181" select="quick" style="color: #ad95af">$s</span><span class="whitespace" start="183" style="color: #ddad60"> </span><span class="op" start="184" style="color: #ddad60">eq</span><span class="whitespace" start="186" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="187" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="189" style="color: #295f94">)</span><span class="whitespace" start="190" style="color: #ddad60"> </span><span class="op" start="191" style="color: #ddad60">then</span><span class="whitespace" start="195" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="196" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="198" style="color: #ddad60"> </span><span class="op" start="199" style="color: #ddad60">else</span><span class="whitespace" start="203" style="color: #ddad60"> </span><span class="function" start="204" pair-end="218" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="211" select="quick" style="color: #ad95af">$s</span><span class="op" start="213" style="color: #ddad60">,</span><span class="whitespace" start="214" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="215" style="color: #585858">:</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="218" style="color: #295f94">)</span><span class="whitespace" start="219" style="color: #ddad60">
                              </span><span class="op" start="224" style="color: #ddad60">else</span><span class="whitespace" start="228" style="color: #ddad60"> </span><span class="variable" start="229" select="quick" style="color: #ad95af">$root-prefix</span><span class="whitespace" start="241" style="color: #ddad60">
                          </span><span class="op" start="242" style="color: #ddad60">else</span><span class="whitespace" start="246" style="color: #ddad60"> </span><span class="variable" start="247" select="quick" style="color: #ad95af">$root-prefix</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    
    </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> return 2 strings if required close found - that befoe and that after (even if empty string)
     if no required close found - just return the required close</span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">parseStrings</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="14" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$awaiting</span><span class="parenthesis" start="14" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">requiredClose</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">char2</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$token</span><span class="op" start="17" style="color: #ddad60">,</span><span class="numeric" start="18" style="color: #566874">2</span><span class="op" start="19" style="color: #ddad60">,</span><span class="numeric" start="20" style="color: #566874">1</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$char1</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">eq</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">?</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">?&amp;gt;</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$char1</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">eq</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">!</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">and</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="variable" start="19" select="quick" style="color: #ad95af">$char2</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="op" start="26" style="color: #ddad60">eq</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="29" style="color: #585858">-</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">--&amp;gt;</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$char1</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">eq</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">!</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">and</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="variable" start="19" select="quick" style="color: #ad95af">$char2</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="op" start="26" style="color: #ddad60">eq</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="29" style="color: #585858">[</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">]]&amp;gt;</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"> </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> assume cdata: &lt;![CDATA[]]&gt; </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$char1</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">eq</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">!</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="25" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="24" select="quick" style="color: #885d3b">contains</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="14" select="quick" style="color: #ad95af">$token</span><span class="op" start="20" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="21" style="color: #585858">[</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="24" style="color: #295f94">)</span><span class="parenthesis" start="25" style="color: #295f94">)</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" start="27" style="color: #ddad60">then</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="32" style="color: #585858">]&gt;</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="op" start="37" style="color: #ddad60">else</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="42" style="color: #585858">&gt;</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">&amp;gt;</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">beforeClose</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="40" select="quick" style="color: #885d3b">substring-before</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$token</span><span class="op" start="24" style="color: #ddad60">,</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="variable" start="26" select="quick" style="color: #ad95af">$requiredClose</span><span class="parenthesis" start="40" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$token</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" start="23" style="color: #ddad60">eq</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="numeric" start="26" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
            &lt;x/&gt;
            </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="22" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$is-element-start</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> cdata, dtd, pi, comment, or close-tag </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">foundClose</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                          </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="37" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="31" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="19" select="quick" style="color: #ad95af">$beforeClose</span><span class="parenthesis" start="31" style="color: #295f94">)</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" start="33" style="color: #ddad60">gt</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="numeric" start="36" style="color: #566874">0</span><span class="parenthesis" start="37" style="color: #295f94">)</span><span class="whitespace" start="38" style="color: #ddad60">
                                  </span><span class="op" start="39" style="color: #ddad60">then</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="function" start="44" pair-end="49" select="quick" style="color: #885d3b">true</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="49" style="color: #295f94">)</span><span class="whitespace" start="50" style="color: #ddad60"> 
                                  </span><span class="op" start="52" style="color: #ddad60">else</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="function" start="57" pair-end="97" select="quick" style="color: #885d3b">starts-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="69" select="quick" style="color: #ad95af">$beforeClose</span><span class="op" start="81" style="color: #ddad60">,</span><span class="whitespace" start="82" style="color: #ddad60"> </span><span class="variable" start="83" select="quick" style="color: #ad95af">$requiredClose</span><span class="parenthesis" start="97" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                          </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$foundClose</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tagType</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="20" select="quick" style="color: #885d3b">f:getTagType</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="14" select="quick" style="color: #ad95af">$token</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string+</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tagStart</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tagType</span><span class="filter" start="9" pair-end="11" select="quick" style="color: #295f94">[</span><span class="numeric" start="10" style="color: #566874">2</span><span class="filter" start="11" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isElementClose</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$char1</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">eq</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">/</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="20" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$isElementClose</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">then</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="27" style="color: #585858">ez</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" start="32" style="color: #ddad60">else</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="37" style="color: #585858">z</span><span class="op" style="color: #ddad60">'</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="24" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="8" style="color: #585858">&amp;lt;</span><span class="op" style="color: #ddad60">'</span><span class="op" start="14" style="color: #ddad60">,</span><span class="variable" start="15" select="quick" style="color: #ad95af">$tagStart</span><span class="parenthesis" start="24" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tagContent</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="53" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$beforeClose</span><span class="op" start="23" style="color: #ddad60">,</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="function" start="25" pair-end="48" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="39" select="quick" style="color: #ad95af">$tagStart</span><span class="parenthesis" start="48" style="color: #295f94">)</span><span class="whitespace" start="49" style="color: #ddad60"> </span><span class="op" start="50" style="color: #ddad60">+</span><span class="whitespace" start="51" style="color: #ddad60"> </span><span class="numeric" start="52" style="color: #566874">1</span><span class="parenthesis" start="53" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">with-prefix</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="38" select="quick" style="color: #885d3b">starts-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="13" select="quick" style="color: #ad95af">$tagContent</span><span class="op" start="24" style="color: #ddad60">,</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="variable" start="26" select="quick" style="color: #ad95af">$root-prefix</span><span class="parenthesis" start="38" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isElementClose</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="29" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$is-xsl</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" start="13" style="color: #ddad60">and</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="variable" start="17" select="quick" style="color: #ad95af">$with-prefix</span><span class="parenthesis" start="29" style="color: #295f94">)</span><span class="whitespace" start="30" style="color: #ddad60">
                                 </span><span class="op" start="31" style="color: #ddad60">then</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="36" style="color: #585858">clxsl</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="43" style="color: #ddad60">
                                 </span><span class="op" start="44" style="color: #ddad60">else</span><span class="whitespace" start="48" style="color: #ddad60"> </span><span class="if" start="49" style="color: #ddad60">if</span><span class="whitespace" start="51" style="color: #ddad60"> </span><span class="parenthesis" start="52" pair-end="166" select="quick" style="color: #295f94">(</span><span class="variable" start="53" select="quick" style="color: #ad95af">$is-xsd</span><span class="whitespace" start="60" style="color: #ddad60">
                                          </span><span class="op" start="70" style="color: #ddad60">and</span><span class="whitespace" start="73" style="color: #ddad60"> </span><span class="parenthesis" start="74" pair-end="165" select="quick" style="color: #295f94">(</span><span class="variable" start="75" select="quick" style="color: #ad95af">$tagContent</span><span class="whitespace" start="86" style="color: #ddad60"> </span><span class="op" start="87" style="color: #ddad60">=</span><span class="whitespace" start="88" style="color: #ddad60"> </span><span class="function" start="89" pair-end="128" select="quick" style="color: #885d3b">f:get-xsd-fnames</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="106" select="quick" style="color: #ad95af">$root-prefix</span><span class="op" start="118" style="color: #ddad60">,</span><span class="whitespace" start="119" style="color: #ddad60"> </span><span class="variable" start="120" select="quick" style="color: #ad95af">$doctype</span><span class="parenthesis" start="128" style="color: #295f94">)</span><span class="step" start="129" style="color: #ddad60">/</span><span class="axis" start="130" style="color: #566874">@</span><span class="qname" start="131" select="quick" style="color: #b05a65">name</span><span class="whitespace" start="135" style="color: #ddad60">
                                          </span><span class="op" start="145" style="color: #ddad60">or</span><span class="whitespace" start="147" style="color: #ddad60"> </span><span class="function" start="148" pair-end="164" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="152" select="quick" style="color: #ad95af">$with-prefix</span><span class="parenthesis" start="164" style="color: #295f94">)</span><span class="parenthesis" start="165" style="color: #295f94">)</span><span class="parenthesis" start="166" style="color: #295f94">)</span><span class="whitespace" start="167" style="color: #ddad60"> 
                                 </span><span class="op" start="169" style="color: #ddad60">then</span><span class="whitespace" start="173" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="174" style="color: #585858">clxsl</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="181" style="color: #ddad60">
                                 </span><span class="op" start="182" style="color: #ddad60">else</span><span class="whitespace" start="186" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="187" style="color: #585858">cl</span><span class="op" style="color: #ddad60">'</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tagContent</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tagType</span><span class="filter" start="9" pair-end="11" select="quick" style="color: #295f94">[</span><span class="numeric" start="10" style="color: #566874">1</span><span class="filter" start="11" style="color: #295f94">]</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tagContent</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="20" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$isElementClose</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">then</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="27" style="color: #585858">ec</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" start="32" style="color: #ddad60">else</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="37" style="color: #585858">z</span><span class="op" style="color: #ddad60">'</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isElementClose</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                    </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
                    &lt;xsl:attribute name="id" select="js:stackPop()"/&gt;
                    </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$requiredClose</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">txt</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isElementClose</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                    </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
                    &lt;xsl:attribute name="id" select="js:getStackIndex()"/&gt;
                    </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="82" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$token</span><span class="op" start="17" style="color: #ddad60">,</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="function" start="19" pair-end="45" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="33" select="quick" style="color: #ad95af">$beforeClose</span><span class="parenthesis" start="45" style="color: #295f94">)</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="op" start="47" style="color: #ddad60">+</span><span class="whitespace" start="48" style="color: #ddad60"> </span><span class="function" start="49" pair-end="77" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="63" select="quick" style="color: #ad95af">$requiredClose</span><span class="parenthesis" start="77" style="color: #295f94">)</span><span class="whitespace" start="78" style="color: #ddad60"> </span><span class="op" start="79" style="color: #ddad60">+</span><span class="whitespace" start="80" style="color: #ddad60"> </span><span class="numeric" start="81" style="color: #566874">1</span><span class="parenthesis" start="82" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">required</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$requiredClose</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">required</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">parts</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:analyze-string</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">regex</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">&amp;quot;.*?&amp;quot;|'.*?'|[^'&amp;quot;]+|['&amp;quot;]</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">flags</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">s</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:matching-substring</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="context" start="1" style="color: #566874">.</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:matching-substring</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:non-matching-substring</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="context" start="1" style="color: #566874">.</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:non-matching-substring</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:analyze-string</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="69" select="quick" style="color: #885d3b">f:getAttributes</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="17" select="quick" style="color: #ad95af">$token</span><span class="op" start="23" style="color: #ddad60">,</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="numeric" start="25" style="color: #566874">0</span><span class="op" start="26" style="color: #ddad60">,</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="variable" start="28" select="quick" style="color: #ad95af">$parts</span><span class="op" start="34" style="color: #ddad60">,</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="numeric" start="36" style="color: #566874">1</span><span class="op" start="37" style="color: #ddad60">,</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="variable" start="39" select="quick" style="color: #ad95af">$doctype</span><span class="op" start="47" style="color: #ddad60">,</span><span class="whitespace" start="48" style="color: #ddad60"> </span><span class="variable" start="49" select="quick" style="color: #ad95af">$new-root-prefix</span><span class="op" start="65" style="color: #ddad60">,</span><span class="whitespace" start="66" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="67" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="69" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            
            </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> must be an open tag, so check for attributes </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
            
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">newLevel</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="numeric" start="1" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">newCounter</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="22" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$is-element-start</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="whitespace" start="23" style="color: #ddad60">
                                            </span><span class="op" start="24" style="color: #ddad60">then</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="variable" start="29" select="quick" style="color: #ad95af">$counter</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" start="38" style="color: #ddad60">+</span><span class="whitespace" start="39" style="color: #ddad60"> </span><span class="numeric" start="40" style="color: #566874">1</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="op" start="42" style="color: #ddad60">else</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="variable" start="47" select="quick" style="color: #ad95af">$counter</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">stillAwaiting</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">and</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="function" start="15" pair-end="36" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="21" select="quick" style="color: #ad95af">$expectedOutput</span><span class="parenthesis" start="36" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="41" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="5" pair-end="26" select="quick" style="color: #885d3b">name</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="10" select="quick" style="color: #ad95af">$parseStrings</span><span class="filter" start="23" pair-end="25" select="quick" style="color: #295f94">[</span><span class="numeric" start="24" style="color: #566874">1</span><span class="filter" start="25" style="color: #295f94">]</span><span class="parenthesis" start="26" style="color: #295f94">)</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="op" start="28" style="color: #ddad60">eq</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="31" style="color: #585858">required</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="41" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$parseStrings</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$expectedOutput</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">newExpected</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="16" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">eq</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="numeric" start="15" style="color: #566874">1</span><span class="parenthesis" start="16" style="color: #295f94">)</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" start="18" style="color: #ddad60">then</span><span class="whitespace" start="22" style="color: #ddad60">
                          </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="23" style="color: #585858">n</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="26" style="color: #ddad60">
                          </span><span class="op" start="27" style="color: #ddad60">else</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="if" start="32" style="color: #ddad60">if</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="parenthesis" start="35" pair-end="50" select="quick" style="color: #295f94">(</span><span class="variable" start="36" select="quick" style="color: #ad95af">$stillAwaiting</span><span class="parenthesis" start="50" style="color: #295f94">)</span><span class="whitespace" start="51" style="color: #ddad60">
                          </span><span class="op" start="52" style="color: #ddad60">then</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="variable" start="57" select="quick" style="color: #ad95af">$expected</span><span class="whitespace" start="66" style="color: #ddad60">
                          </span><span class="op" start="67" style="color: #ddad60">else</span><span class="whitespace" start="71" style="color: #ddad60"> </span><span class="if" start="72" style="color: #ddad60">if</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="parenthesis" start="75" pair-end="101" select="quick" style="color: #295f94">(</span><span class="function" start="76" pair-end="95" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="82" select="quick" style="color: #ad95af">$parseStrings</span><span class="parenthesis" start="95" style="color: #295f94">)</span><span class="whitespace" start="96" style="color: #ddad60"> </span><span class="op" start="97" style="color: #ddad60">eq</span><span class="whitespace" start="99" style="color: #ddad60"> </span><span class="numeric" start="100" style="color: #566874">1</span><span class="parenthesis" start="101" style="color: #295f94">)</span><span class="whitespace" start="102" style="color: #ddad60">
                          </span><span class="op" start="103" style="color: #ddad60">then</span><span class="whitespace" start="107" style="color: #ddad60"> </span><span class="variable" start="108" select="quick" style="color: #ad95af">$parseStrings</span><span class="whitespace" start="121" style="color: #ddad60">
                          </span><span class="op" start="122" style="color: #ddad60">else</span><span class="whitespace" start="126" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="127" style="color: #585858">n</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">newBeganAt</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="19" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$stillAwaiting</span><span class="parenthesis" start="19" style="color: #295f94">)</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="op" start="21" style="color: #ddad60">then</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="variable" start="26" select="quick" style="color: #ad95af">$beganAt</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" start="35" style="color: #ddad60">else</span><span class="whitespace" start="39" style="color: #ddad60"> </span><span class="variable" start="40" select="quick" style="color: #ad95af">$index</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">le</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="function" start="11" pair-end="24" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="17" select="quick" style="color: #ad95af">$tokens</span><span class="parenthesis" start="24" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="115" select="quick" style="color: #885d3b">f:iterateTokens</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="17" select="quick" style="color: #ad95af">$newCounter</span><span class="op" start="28" style="color: #ddad60">,</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="variable" start="30" select="quick" style="color: #ad95af">$tokens</span><span class="op" start="37" style="color: #ddad60">,</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="variable" start="39" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="45" style="color: #ddad60"> </span><span class="op" start="46" style="color: #ddad60">+</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="numeric" start="48" style="color: #566874">1</span><span class="op" start="49" style="color: #ddad60">,</span><span class="whitespace" start="50" style="color: #ddad60">
                            </span><span class="variable" start="51" select="quick" style="color: #ad95af">$newExpected</span><span class="op" start="63" style="color: #ddad60">,</span><span class="whitespace" start="64" style="color: #ddad60"> </span><span class="variable" start="65" select="quick" style="color: #ad95af">$newBeganAt</span><span class="op" start="76" style="color: #ddad60">,</span><span class="whitespace" start="77" style="color: #ddad60"> </span><span class="variable" start="78" select="quick" style="color: #ad95af">$newLevel</span><span class="op" start="87" style="color: #ddad60">,</span><span class="whitespace" start="88" style="color: #ddad60"> </span><span class="variable" start="89" select="quick" style="color: #ad95af">$doctype</span><span class="op" start="97" style="color: #ddad60">,</span><span class="whitespace" start="98" style="color: #ddad60"> </span><span class="variable" start="99" select="quick" style="color: #ad95af">$new-root-prefix</span><span class="parenthesis" start="115" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:getAttributes</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">item()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">attToken</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">offset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">parts</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">doctype</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">root-prefix</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">ename</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">is-xsl</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$doctype</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="op" start="10" style="color: #ddad60">eq</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="13" style="color: #585858">xslt</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">is-xsd</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="12" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$is-xsl</span><span class="parenthesis" start="12" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">part1</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$parts</span><span class="filter" start="7" pair-end="14" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="filter" start="14" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">part2</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$parts</span><span class="filter" start="7" pair-end="18" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">+</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="numeric" start="17" style="color: #566874">1</span><span class="filter" start="18" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">elementName</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="17" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$ename</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">eq</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="17" style="color: #295f94">)</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="op" start="19" style="color: #ddad60">then</span><span class="whitespace" start="23" style="color: #ddad60">
                          </span><span class="function" start="24" pair-end="50" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="33" select="quick" style="color: #ad95af">$part1</span><span class="op" start="39" style="color: #ddad60">,</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="41" style="color: #585858">&gt;|\s+|/</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="50" style="color: #295f94">)</span><span class="filter" start="51" pair-end="53" select="quick" style="color: #295f94">[</span><span class="numeric" start="52" style="color: #566874">1</span><span class="filter" start="53" style="color: #295f94">]</span><span class="whitespace" start="54" style="color: #ddad60">
                          </span><span class="op" start="55" style="color: #ddad60">else</span><span class="whitespace" start="59" style="color: #ddad60"> </span><span class="variable" start="60" select="quick" style="color: #ad95af">$ename</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">with-prefix</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="39" select="quick" style="color: #885d3b">starts-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="13" select="quick" style="color: #ad95af">$elementName</span><span class="op" start="25" style="color: #ddad60">,</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="variable" start="27" select="quick" style="color: #ad95af">$root-prefix</span><span class="parenthesis" start="39" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">is-xsl-element</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$is-xsl</span><span class="whitespace" start="8" style="color: #ddad60"> </span><span class="op" start="9" style="color: #ddad60">and</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="variable" start="13" select="quick" style="color: #ad95af">$with-prefix</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">eq</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="numeric" start="11" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">es</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">&amp;lt;</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="20" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$is-xsl-element</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="whitespace" start="21" style="color: #ddad60">
                   </span><span class="op" start="22" style="color: #ddad60">then</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="27" style="color: #585858">enxsl</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="34" style="color: #ddad60">
                   </span><span class="op" start="35" style="color: #ddad60">else</span><span class="whitespace" start="39" style="color: #ddad60"> </span><span class="if" start="40" style="color: #ddad60">if</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="parenthesis" start="43" pair-end="73" select="quick" style="color: #295f94">(</span><span class="variable" start="44" select="quick" style="color: #ad95af">$is-xsl</span><span class="whitespace" start="51" style="color: #ddad60"> </span><span class="op" start="52" style="color: #ddad60">and</span><span class="whitespace" start="55" style="color: #ddad60"> </span><span class="function" start="56" pair-end="72" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="60" select="quick" style="color: #ad95af">$with-prefix</span><span class="parenthesis" start="72" style="color: #295f94">)</span><span class="parenthesis" start="73" style="color: #295f94">)</span><span class="whitespace" start="74" style="color: #ddad60">
                   </span><span class="op" start="75" style="color: #ddad60">then</span><span class="whitespace" start="79" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="80" style="color: #585858">en</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="84" style="color: #ddad60">
                   </span><span class="op" start="85" style="color: #ddad60">else</span><span class="whitespace" start="89" style="color: #ddad60"> </span><span class="if" start="90" style="color: #ddad60">if</span><span class="whitespace" start="92" style="color: #ddad60"> </span><span class="parenthesis" start="93" pair-end="123" select="quick" style="color: #295f94">(</span><span class="variable" start="94" select="quick" style="color: #ad95af">$is-xsd</span><span class="whitespace" start="101" style="color: #ddad60"> </span><span class="op" start="102" style="color: #ddad60">and</span><span class="whitespace" start="105" style="color: #ddad60"> </span><span class="function" start="106" pair-end="122" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="110" select="quick" style="color: #ad95af">$with-prefix</span><span class="parenthesis" start="122" style="color: #295f94">)</span><span class="parenthesis" start="123" style="color: #295f94">)</span><span class="whitespace" start="124" style="color: #ddad60">
                   </span><span class="op" start="125" style="color: #ddad60">then</span><span class="whitespace" start="129" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="130" style="color: #585858">enxsl</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="137" style="color: #ddad60">
                   </span><span class="op" start="138" style="color: #ddad60">else</span><span class="whitespace" start="142" style="color: #ddad60"> </span><span class="if" start="143" style="color: #ddad60">if</span><span class="whitespace" start="145" style="color: #ddad60"> </span><span class="parenthesis" start="146" pair-end="220" select="quick" style="color: #295f94">(</span><span class="variable" start="147" select="quick" style="color: #ad95af">$is-xsd</span><span class="whitespace" start="154" style="color: #ddad60"> </span><span class="op" start="155" style="color: #ddad60">and</span><span class="whitespace" start="158" style="color: #ddad60"> </span><span class="variable" start="159" select="quick" style="color: #ad95af">$elementName</span><span class="whitespace" start="171" style="color: #ddad60"> </span><span class="op" start="172" style="color: #ddad60">=</span><span class="whitespace" start="173" style="color: #ddad60"> </span><span class="function" start="174" pair-end="213" select="quick" style="color: #885d3b">f:get-xsd-fnames</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="191" select="quick" style="color: #ad95af">$root-prefix</span><span class="op" start="203" style="color: #ddad60">,</span><span class="whitespace" start="204" style="color: #ddad60"> </span><span class="variable" start="205" select="quick" style="color: #ad95af">$doctype</span><span class="parenthesis" start="213" style="color: #295f94">)</span><span class="step" start="214" style="color: #ddad60">/</span><span class="axis" start="215" style="color: #566874">@</span><span class="qname" start="216" select="quick" style="color: #b05a65">name</span><span class="parenthesis" start="220" style="color: #295f94">)</span><span class="whitespace" start="221" style="color: #ddad60"> </span><span class="op" start="222" style="color: #ddad60">then</span><span class="whitespace" start="226" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="227" style="color: #585858">enxsl</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="234" style="color: #ddad60"> 
                   </span><span class="op" start="236" style="color: #ddad60">else</span><span class="whitespace" start="240" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="241" style="color: #585858">en</span><span class="op" style="color: #ddad60">'</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
        id="{js:stackPush($elementName)}"&gt;
        </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$elementName</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">pre-close</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="29" select="quick" style="color: #885d3b">substring-before</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$part1</span><span class="op" start="24" style="color: #ddad60">,</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="26" style="color: #585858">&gt;</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="29" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"> 
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isFinalPart</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="numeric" start="10" style="color: #566874">2</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">gt</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="function" start="15" pair-end="27" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="21" select="quick" style="color: #ad95af">$parts</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="whitespace" start="28" style="color: #ddad60">
                                             </span><span class="op" start="29" style="color: #ddad60">or</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="function" start="32" pair-end="56" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="46" select="quick" style="color: #ad95af">$pre-close</span><span class="parenthesis" start="56" style="color: #295f94">)</span><span class="whitespace" start="57" style="color: #ddad60"> </span><span class="op" start="58" style="color: #ddad60">gt</span><span class="whitespace" start="60" style="color: #ddad60"> </span><span class="numeric" start="61" style="color: #566874">0</span><span class="whitespace" start="62" style="color: #ddad60">
                                             </span><span class="op" start="63" style="color: #ddad60">or</span><span class="whitespace" start="65" style="color: #ddad60"> </span><span class="function" start="66" pair-end="88" select="quick" style="color: #885d3b">starts-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="78" select="quick" style="color: #ad95af">$part1</span><span class="op" start="84" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="85" style="color: #585858">&gt;</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="88" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isFinalPart</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">  use sc class value to mark end of self-closed element </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isSelfClosed</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="25" select="quick" style="color: #885d3b">ends-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$pre-close</span><span class="op" start="21" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="22" style="color: #585858">/</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="25" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="18" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$isSelfClosed</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">then</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="25" style="color: #585858">sc</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" start="30" style="color: #ddad60">else</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="35" style="color: #585858">scx</span><span class="op" style="color: #ddad60">'</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isSelfClosed</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
            &lt;xsl:attribute name="id" select="js:stackPop()"/&gt;
            </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="18" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$isSelfClosed</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">then</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="25" style="color: #585858">/</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="op" start="29" style="color: #ddad60">else</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="34" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">&amp;gt;</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">txt</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isSelfClosed</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
            &lt;xsl:attribute name="id" select="js:getStackIndex()"/&gt;
            </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="61" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$attToken</span><span class="op" start="20" style="color: #ddad60">,</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="function" start="22" pair-end="46" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="36" select="quick" style="color: #ad95af">$pre-close</span><span class="parenthesis" start="46" style="color: #295f94">)</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="op" start="48" style="color: #ddad60">+</span><span class="whitespace" start="49" style="color: #ddad60"> </span><span class="variable" start="50" select="quick" style="color: #ad95af">$offset</span><span class="whitespace" start="57" style="color: #ddad60"> </span><span class="op" start="58" style="color: #ddad60">+</span><span class="whitespace" start="59" style="color: #ddad60"> </span><span class="numeric" start="60" style="color: #566874">2</span><span class="parenthesis" start="61" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="14" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$part2</span><span class="parenthesis" start="14" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> attribute must exist and name occurs before value, so get this first </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">left</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                      </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="16" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">eq</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="numeric" start="15" style="color: #566874">1</span><span class="parenthesis" start="16" style="color: #295f94">)</span><span class="whitespace" start="17" style="color: #ddad60">
                              </span><span class="op" start="18" style="color: #ddad60">then</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="function" start="23" pair-end="72" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="33" select="quick" style="color: #ad95af">$part1</span><span class="op" start="39" style="color: #ddad60">,</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="function" start="41" pair-end="67" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="55" select="quick" style="color: #ad95af">$elementName</span><span class="parenthesis" start="67" style="color: #295f94">)</span><span class="whitespace" start="68" style="color: #ddad60"> </span><span class="op" start="69" style="color: #ddad60">+</span><span class="whitespace" start="70" style="color: #ddad60"> </span><span class="numeric" start="71" style="color: #566874">1</span><span class="parenthesis" start="72" style="color: #295f94">)</span><span class="whitespace" start="73" style="color: #ddad60">
                              </span><span class="op" start="74" style="color: #ddad60">else</span><span class="whitespace" start="78" style="color: #ddad60"> </span><span class="variable" start="79" select="quick" style="color: #ad95af">$part1</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">pre</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="27" select="quick" style="color: #885d3b">substring-before</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$left</span><span class="op" start="23" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="24" style="color: #585858">=</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
        &lt;xsl:variable name="tokens" select="tokenize($pre, '\s+')"/&gt;
        </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="26" select="quick" style="color: #885d3b">f:splitAttributeName</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="22" select="quick" style="color: #ad95af">$pre</span><span class="parenthesis" start="26" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">attSpans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:for-each</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tokens</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                          </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="20" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="19" select="quick" style="color: #885d3b">matches</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="13" style="color: #566874">.</span><span class="op" start="14" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">\S</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="19" style="color: #295f94">)</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="whitespace" start="21" style="color: #ddad60"> 
                                  </span><span class="op" start="23" style="color: #ddad60">then</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="28" style="color: #585858">atn</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="33" style="color: #ddad60">
                                  </span><span class="op" start="34" style="color: #ddad60">else</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="39" style="color: #585858">z</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="variable" start="1" select="quick" style="color: #ad95af">$class</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="context" start="1" style="color: #566874">.</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:for-each</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">att-name</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$attSpans</span><span class="filter" start="10" pair-end="26" select="quick" style="color: #295f94">[</span><span class="axis" start="11" style="color: #566874">@</span><span class="qname" start="12" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" start="18" style="color: #ddad60">eq</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="21" style="color: #585858">atn</span><span class="op" style="color: #ddad60">'</span><span class="filter" start="26" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">xsd-xpath-elements</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="47" select="quick" style="color: #885d3b">f:get-xsd-element-names</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="25" select="quick" style="color: #ad95af">$root-prefix</span><span class="op" start="37" style="color: #ddad60">,</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="variable" start="39" select="quick" style="color: #ad95af">$doctype</span><span class="parenthesis" start="47" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">xsd-xpath-attributes</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="49" select="quick" style="color: #885d3b">f:get-xsd-attribute-names</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="27" select="quick" style="color: #ad95af">$root-prefix</span><span class="op" start="39" style="color: #ddad60">,</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="variable" start="41" select="quick" style="color: #ad95af">$doctype</span><span class="parenthesis" start="49" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$attSpans</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isXPath</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                      </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="20" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$is-xsl-element</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="whitespace" start="21" style="color: #ddad60">
                              </span><span class="op" start="22" style="color: #ddad60">then</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="variable" start="27" select="quick" style="color: #ad95af">$att-name</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="op" start="37" style="color: #ddad60">=</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="parenthesis" start="39" pair-end="64" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="40" style="color: #585858">select</span><span class="op" style="color: #ddad60">'</span><span class="op" start="48" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="49" style="color: #585858">test</span><span class="op" style="color: #ddad60">'</span><span class="op" start="55" style="color: #ddad60">,</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="57" style="color: #585858">match</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="64" style="color: #295f94">)</span><span class="whitespace" start="65" style="color: #ddad60">
                              
                              </span><span class="op" start="67" style="color: #ddad60">else</span><span class="whitespace" start="71" style="color: #ddad60"> </span><span class="if" start="72" style="color: #ddad60">if</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="parenthesis" start="75" pair-end="105" select="quick" style="color: #295f94">(</span><span class="function" start="76" pair-end="104" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="83" select="quick" style="color: #ad95af">$xsd-xpath-attributes</span><span class="parenthesis" start="104" style="color: #295f94">)</span><span class="parenthesis" start="105" style="color: #295f94">)</span><span class="whitespace" start="106" style="color: #ddad60"> </span><span class="op" start="107" style="color: #ddad60">then</span><span class="whitespace" start="111" style="color: #ddad60">
                              
                              </span><span class="parenthesis" start="113" pair-end="176" select="quick" style="color: #295f94">(</span><span class="variable" start="114" select="quick" style="color: #ad95af">$is-xsd</span><span class="whitespace" start="121" style="color: #ddad60"> </span><span class="op" start="122" style="color: #ddad60">and</span><span class="whitespace" start="125" style="color: #ddad60"> </span><span class="function" start="126" pair-end="175" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="whitespace" start="133" style="color: #ddad60"> 
                              </span><span class="variable" start="135" select="quick" style="color: #ad95af">$xsd-xpath-attributes</span><span class="filter" start="156" pair-end="174" select="quick" style="color: #295f94">[</span><span class="axis" start="157" style="color: #566874">@</span><span class="qname" start="158" select="quick" style="color: #b05a65">name</span><span class="whitespace" start="162" style="color: #ddad60"> </span><span class="op" start="163" style="color: #ddad60">=</span><span class="whitespace" start="164" style="color: #ddad60"> </span><span class="variable" start="165" select="quick" style="color: #ad95af">$att-name</span><span class="filter" start="174" style="color: #295f94">]</span><span class="parenthesis" start="175" style="color: #295f94">)</span><span class="parenthesis" start="176" style="color: #295f94">)</span><span class="whitespace" start="177" style="color: #ddad60"> 
                              
                              </span><span class="op" start="180" style="color: #ddad60">else</span><span class="whitespace" start="184" style="color: #ddad60">
                              
                              </span><span class="parenthesis" start="186" pair-end="272" select="quick" style="color: #295f94">(</span><span class="variable" start="187" select="quick" style="color: #ad95af">$is-xsd</span><span class="whitespace" start="194" style="color: #ddad60"> </span><span class="op" start="195" style="color: #ddad60">and</span><span class="whitespace" start="198" style="color: #ddad60"> </span><span class="function" start="199" pair-end="271" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="whitespace" start="206" style="color: #ddad60"> 
                              </span><span class="variable" start="208" select="quick" style="color: #ad95af">$xsd-xpath-elements</span><span class="filter" start="227" pair-end="270" select="quick" style="color: #295f94">[</span><span class="axis" start="228" style="color: #566874">@</span><span class="qname" start="229" select="quick" style="color: #b05a65">name</span><span class="whitespace" start="233" style="color: #ddad60"> </span><span class="op" start="234" style="color: #ddad60">=</span><span class="whitespace" start="235" style="color: #ddad60"> </span><span class="variable" start="236" select="quick" style="color: #ad95af">$elementName</span><span class="whitespace" start="248" style="color: #ddad60"> </span><span class="op" start="249" style="color: #ddad60">and</span><span class="whitespace" start="252" style="color: #ddad60"> </span><span class="context" start="253" style="color: #566874">.</span><span class="step" start="254" style="color: #ddad60">/</span><span class="qname" start="255" select="quick" style="color: #b05a65">att</span><span class="whitespace" start="258" style="color: #ddad60"> </span><span class="op" start="259" style="color: #ddad60">=</span><span class="whitespace" start="260" style="color: #ddad60"> </span><span class="variable" start="261" select="quick" style="color: #ad95af">$att-name</span><span class="filter" start="270" style="color: #295f94">]</span><span class="parenthesis" start="271" style="color: #295f94">)</span><span class="parenthesis" start="272" style="color: #295f94">)</span><span class="whitespace" start="273" style="color: #ddad60"> 
                              </span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> for coloring attribute values that are referenced from XPath </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">metaXPathName</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                      </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="105" select="quick" style="color: #885d3b">f:get-av-class</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="16" select="quick" style="color: #ad95af">$is-xsl-element</span><span class="op" start="31" style="color: #ddad60">,</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="variable" start="33" select="quick" style="color: #ad95af">$doctype</span><span class="op" start="41" style="color: #ddad60">,</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="variable" start="43" select="quick" style="color: #ad95af">$is-xsd</span><span class="op" start="50" style="color: #ddad60">,</span><span class="whitespace" start="51" style="color: #ddad60"> 
                                             </span><span class="variable" start="68" select="quick" style="color: #ad95af">$elementName</span><span class="op" start="80" style="color: #ddad60">,</span><span class="whitespace" start="81" style="color: #ddad60"> </span><span class="variable" start="82" select="quick" style="color: #ad95af">$att-name</span><span class="op" start="91" style="color: #ddad60">,</span><span class="whitespace" start="92" style="color: #ddad60"> </span><span class="variable" start="93" select="quick" style="color: #ad95af">$root-prefix</span><span class="parenthesis" start="105" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">atneq</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="40" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$left</span><span class="op" start="16" style="color: #ddad60">,</span><span class="function" start="17" pair-end="35" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="31" select="quick" style="color: #ad95af">$pre</span><span class="parenthesis" start="35" style="color: #295f94">)</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="op" start="37" style="color: #ddad60">+</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="numeric" start="39" style="color: #566874">1</span><span class="parenthesis" start="40" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">sl</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$part2</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:double</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">z</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$part2</span><span class="op" start="17" style="color: #ddad60">,</span><span class="numeric" start="18" style="color: #566874">1</span><span class="op" start="19" style="color: #ddad60">,</span><span class="numeric" start="20" style="color: #566874">1</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">attValue</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="29" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$part2</span><span class="op" start="17" style="color: #ddad60">,</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="numeric" start="19" style="color: #566874">2</span><span class="op" start="20" style="color: #ddad60">,</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="variable" start="22" select="quick" style="color: #ad95af">$sl</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="op" start="26" style="color: #ddad60">-</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="numeric" start="28" style="color: #566874">2</span><span class="parenthesis" start="29" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isXPath</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="24" select="quick" style="color: #885d3b">loc:showXPath</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$attValue</span><span class="parenthesis" start="24" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$is-xsl</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="39" select="quick" style="color: #885d3b">f:processAVT</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="14" select="quick" style="color: #ad95af">$attValue</span><span class="op" start="23" style="color: #ddad60">,</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="variable" start="25" select="quick" style="color: #ad95af">$metaXPathName</span><span class="parenthesis" start="39" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="variable" start="1" select="quick" style="color: #ad95af">$metaXPathName</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$attValue</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">z</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="22" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$part2</span><span class="op" start="17" style="color: #ddad60">,</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="variable" start="19" select="quick" style="color: #ad95af">$sl</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">newOffset</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$part1</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" start="23" style="color: #ddad60">+</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="function" start="25" pair-end="45" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="39" select="quick" style="color: #ad95af">$part2</span><span class="parenthesis" start="45" style="color: #295f94">)</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="op" start="47" style="color: #ddad60">+</span><span class="whitespace" start="48" style="color: #ddad60"> </span><span class="variable" start="49" select="quick" style="color: #ad95af">$offset</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="17" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$isFinalPart</span><span class="parenthesis" start="17" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="96" select="quick" style="color: #885d3b">f:getAttributes</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="17" select="quick" style="color: #ad95af">$attToken</span><span class="op" start="26" style="color: #ddad60">,</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="variable" start="28" select="quick" style="color: #ad95af">$newOffset</span><span class="op" start="38" style="color: #ddad60">,</span><span class="whitespace" start="39" style="color: #ddad60"> </span><span class="variable" start="40" select="quick" style="color: #ad95af">$parts</span><span class="op" start="46" style="color: #ddad60">,</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="variable" start="48" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="54" style="color: #ddad60"> </span><span class="op" start="55" style="color: #ddad60">+</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="numeric" start="57" style="color: #566874">2</span><span class="op" start="58" style="color: #ddad60">,</span><span class="whitespace" start="59" style="color: #ddad60"> </span><span class="variable" start="60" select="quick" style="color: #ad95af">$doctype</span><span class="op" start="68" style="color: #ddad60">,</span><span class="whitespace" start="69" style="color: #ddad60"> </span><span class="variable" start="70" select="quick" style="color: #ad95af">$root-prefix</span><span class="op" start="82" style="color: #ddad60">,</span><span class="whitespace" start="83" style="color: #ddad60"> </span><span class="variable" start="84" select="quick" style="color: #ad95af">$elementName</span><span class="parenthesis" start="96" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:get-av-class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">is-xsl-element</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">doctype</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">is-xsd</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">elementName</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">att-name</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">root-prefix</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf">
        </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="20" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$is-xsl-element</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">then</span><span class="whitespace" start="26" style="color: #ddad60">
                </span><span class="if" start="27" style="color: #ddad60">if</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="parenthesis" start="30" pair-end="126" select="quick" style="color: #295f94">(</span><span class="variable" start="31" select="quick" style="color: #ad95af">$elementName</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="op" start="44" style="color: #ddad60">=</span><span class="whitespace" start="45" style="color: #ddad60"> </span><span class="function" start="46" pair-end="97" select="quick" style="color: #885d3b">f:prefixed-name</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="62" select="quick" style="color: #ad95af">$root-prefix</span><span class="op" start="74" style="color: #ddad60">,</span><span class="whitespace" start="75" style="color: #ddad60"> </span><span class="parenthesis" start="76" pair-end="96" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="77" style="color: #585858">variable</span><span class="op" style="color: #ddad60">'</span><span class="op" start="87" style="color: #ddad60">,</span><span class="whitespace" start="88" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="89" style="color: #585858">param</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="96" style="color: #295f94">)</span><span class="parenthesis" start="97" style="color: #295f94">)</span><span class="whitespace" start="98" style="color: #ddad60">
                    </span><span class="op" start="103" style="color: #ddad60">and</span><span class="whitespace" start="106" style="color: #ddad60"> </span><span class="variable" start="107" select="quick" style="color: #ad95af">$att-name</span><span class="whitespace" start="116" style="color: #ddad60"> </span><span class="op" start="117" style="color: #ddad60">eq</span><span class="whitespace" start="119" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="120" style="color: #585858">name</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="126" style="color: #295f94">)</span><span class="whitespace" start="127" style="color: #ddad60"> </span><span class="op" start="128" style="color: #ddad60">then</span><span class="whitespace" start="132" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="133" style="color: #585858">vname</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="140" style="color: #ddad60">
                </span><span class="op" start="141" style="color: #ddad60">else</span><span class="whitespace" start="145" style="color: #ddad60"> </span><span class="if" start="146" style="color: #ddad60">if</span><span class="whitespace" start="148" style="color: #ddad60"> </span><span class="parenthesis" start="149" pair-end="245" select="quick" style="color: #295f94">(</span><span class="variable" start="150" select="quick" style="color: #ad95af">$elementName</span><span class="whitespace" start="162" style="color: #ddad60"> </span><span class="op" start="163" style="color: #ddad60">=</span><span class="whitespace" start="164" style="color: #ddad60"> </span><span class="function" start="165" pair-end="216" select="quick" style="color: #885d3b">f:prefixed-name</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="181" select="quick" style="color: #ad95af">$root-prefix</span><span class="op" start="193" style="color: #ddad60">,</span><span class="whitespace" start="194" style="color: #ddad60"> </span><span class="parenthesis" start="195" pair-end="215" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="196" style="color: #585858">import</span><span class="op" style="color: #ddad60">'</span><span class="op" start="204" style="color: #ddad60">,</span><span class="whitespace" start="205" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="206" style="color: #585858">include</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="215" style="color: #295f94">)</span><span class="parenthesis" start="216" style="color: #295f94">)</span><span class="whitespace" start="217" style="color: #ddad60">
                    </span><span class="op" start="222" style="color: #ddad60">and</span><span class="whitespace" start="225" style="color: #ddad60"> </span><span class="variable" start="226" select="quick" style="color: #ad95af">$att-name</span><span class="whitespace" start="235" style="color: #ddad60"> </span><span class="op" start="236" style="color: #ddad60">eq</span><span class="whitespace" start="238" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="239" style="color: #585858">href</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="245" style="color: #295f94">)</span><span class="whitespace" start="246" style="color: #ddad60"> </span><span class="op" start="247" style="color: #ddad60">then</span><span class="whitespace" start="251" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="252" style="color: #585858">href</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="258" style="color: #ddad60">
                </span><span class="op" start="259" style="color: #ddad60">else</span><span class="whitespace" start="263" style="color: #ddad60"> </span><span class="if" start="264" style="color: #ddad60">if</span><span class="whitespace" start="266" style="color: #ddad60"> </span><span class="parenthesis" start="267" pair-end="359" select="quick" style="color: #295f94">(</span><span class="variable" start="268" select="quick" style="color: #ad95af">$elementName</span><span class="whitespace" start="280" style="color: #ddad60"> </span><span class="op" start="281" style="color: #ddad60">=</span><span class="whitespace" start="282" style="color: #ddad60"> </span><span class="function" start="283" pair-end="330" select="quick" style="color: #885d3b">f:prefixed-name</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="299" select="quick" style="color: #ad95af">$root-prefix</span><span class="op" start="311" style="color: #ddad60">,</span><span class="whitespace" start="312" style="color: #ddad60"> </span><span class="parenthesis" start="313" pair-end="329" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="314" style="color: #585858">call-template</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="329" style="color: #295f94">)</span><span class="parenthesis" start="330" style="color: #295f94">)</span><span class="whitespace" start="331" style="color: #ddad60">
                    </span><span class="op" start="336" style="color: #ddad60">and</span><span class="whitespace" start="339" style="color: #ddad60"> </span><span class="variable" start="340" select="quick" style="color: #ad95af">$att-name</span><span class="whitespace" start="349" style="color: #ddad60"> </span><span class="op" start="350" style="color: #ddad60">eq</span><span class="whitespace" start="352" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="353" style="color: #585858">name</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="359" style="color: #295f94">)</span><span class="whitespace" start="360" style="color: #ddad60"> </span><span class="op" start="361" style="color: #ddad60">then</span><span class="whitespace" start="365" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="366" style="color: #585858">tcall</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="373" style="color: #ddad60">
                </span><span class="op" start="374" style="color: #ddad60">else</span><span class="whitespace" start="378" style="color: #ddad60"> </span><span class="if" start="379" style="color: #ddad60">if</span><span class="whitespace" start="381" style="color: #ddad60"> </span><span class="parenthesis" start="382" pair-end="468" select="quick" style="color: #295f94">(</span><span class="variable" start="383" select="quick" style="color: #ad95af">$elementName</span><span class="whitespace" start="395" style="color: #ddad60"> </span><span class="op" start="396" style="color: #ddad60">=</span><span class="whitespace" start="397" style="color: #ddad60"> </span><span class="function" start="398" pair-end="438" select="quick" style="color: #885d3b">f:prefixed-name</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="414" select="quick" style="color: #ad95af">$root-prefix</span><span class="op" start="426" style="color: #ddad60">,</span><span class="whitespace" start="427" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="428" style="color: #585858">function</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="438" style="color: #295f94">)</span><span class="whitespace" start="439" style="color: #ddad60"> 
                    </span><span class="op" start="445" style="color: #ddad60">and</span><span class="whitespace" start="448" style="color: #ddad60"> </span><span class="variable" start="449" select="quick" style="color: #ad95af">$att-name</span><span class="whitespace" start="458" style="color: #ddad60"> </span><span class="op" start="459" style="color: #ddad60">eq</span><span class="whitespace" start="461" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="462" style="color: #585858">name</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="468" style="color: #295f94">)</span><span class="whitespace" start="469" style="color: #ddad60"> </span><span class="op" start="470" style="color: #ddad60">then</span><span class="whitespace" start="474" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="475" style="color: #585858">fname</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="482" style="color: #ddad60">
                </span><span class="op" start="483" style="color: #ddad60">else</span><span class="whitespace" start="487" style="color: #ddad60"> </span><span class="if" start="488" style="color: #ddad60">if</span><span class="whitespace" start="490" style="color: #ddad60"> </span><span class="parenthesis" start="491" pair-end="577" select="quick" style="color: #295f94">(</span><span class="variable" start="492" select="quick" style="color: #ad95af">$elementName</span><span class="whitespace" start="504" style="color: #ddad60"> </span><span class="op" start="505" style="color: #ddad60">=</span><span class="whitespace" start="506" style="color: #ddad60"> </span><span class="function" start="507" pair-end="547" select="quick" style="color: #885d3b">f:prefixed-name</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="523" select="quick" style="color: #ad95af">$root-prefix</span><span class="op" start="535" style="color: #ddad60">,</span><span class="whitespace" start="536" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="537" style="color: #585858">template</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="547" style="color: #295f94">)</span><span class="whitespace" start="548" style="color: #ddad60"> 
                    </span><span class="op" start="554" style="color: #ddad60">and</span><span class="whitespace" start="557" style="color: #ddad60"> </span><span class="variable" start="558" select="quick" style="color: #ad95af">$att-name</span><span class="whitespace" start="567" style="color: #ddad60"> </span><span class="op" start="568" style="color: #ddad60">eq</span><span class="whitespace" start="570" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="571" style="color: #585858">name</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="577" style="color: #295f94">)</span><span class="whitespace" start="578" style="color: #ddad60"> </span><span class="op" start="579" style="color: #ddad60">then</span><span class="whitespace" start="583" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="584" style="color: #585858">tname</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="591" style="color: #ddad60">
                </span><span class="op" start="592" style="color: #ddad60">else</span><span class="whitespace" start="596" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="597" style="color: #585858">av</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="601" style="color: #ddad60">
                
                </span><span class="op" start="603" style="color: #ddad60">else</span><span class="whitespace" start="607" style="color: #ddad60"> </span><span class="if" start="608" style="color: #ddad60">if</span><span class="whitespace" start="610" style="color: #ddad60"> </span><span class="parenthesis" start="611" pair-end="697" select="quick" style="color: #295f94">(</span><span class="variable" start="612" select="quick" style="color: #ad95af">$is-xsd</span><span class="whitespace" start="619" style="color: #ddad60"> 
                         </span><span class="op" start="630" style="color: #ddad60">and</span><span class="whitespace" start="633" style="color: #ddad60"> </span><span class="function" start="634" pair-end="696" select="quick" style="color: #885d3b">f:is-xsd-fname</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="649" select="quick" style="color: #ad95af">$root-prefix</span><span class="op" start="661" style="color: #ddad60">,</span><span class="whitespace" start="662" style="color: #ddad60"> </span><span class="variable" start="663" select="quick" style="color: #ad95af">$doctype</span><span class="op" start="671" style="color: #ddad60">,</span><span class="whitespace" start="672" style="color: #ddad60"> </span><span class="variable" start="673" select="quick" style="color: #ad95af">$elementName</span><span class="op" start="685" style="color: #ddad60">,</span><span class="whitespace" start="686" style="color: #ddad60"> </span><span class="variable" start="687" select="quick" style="color: #ad95af">$att-name</span><span class="parenthesis" start="696" style="color: #295f94">)</span><span class="parenthesis" start="697" style="color: #295f94">)</span><span class="whitespace" start="698" style="color: #ddad60">
                </span><span class="op" start="699" style="color: #ddad60">then</span><span class="whitespace" start="703" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="704" style="color: #585858">fname</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="711" style="color: #ddad60"> </span><span class="op" start="712" style="color: #ddad60">else</span><span class="whitespace" start="716" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="717" style="color: #585858">av</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:unescape-p</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">text</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">t1</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="32" select="quick" style="color: #885d3b">replace</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="9" select="quick" style="color: #ad95af">$text</span><span class="op" start="14" style="color: #ddad60">,</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858">&amp;#x0300;</span><span class="op" style="color: #ddad60">'</span><span class="op" start="26" style="color: #ddad60">,</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="28" style="color: #585858">{{</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="32" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="30" select="quick" style="color: #885d3b">replace</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="9" select="quick" style="color: #ad95af">$t1</span><span class="op" start="12" style="color: #ddad60">,</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="14" style="color: #585858">&amp;#x0301;</span><span class="op" style="color: #ddad60">'</span><span class="op" start="24" style="color: #ddad60">,</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="26" style="color: #585858">}}</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="30" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:processAVT</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">attText</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">regex1</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">\{.*?\}</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">regex2</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="qname" start="1" select="quick" style="color: #b05a65">part</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">t1</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="37" select="quick" style="color: #885d3b">replace</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="9" select="quick" style="color: #ad95af">$attText</span><span class="op" start="17" style="color: #ddad60">,</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="19" style="color: #585858">\{\{</span><span class="op" style="color: #ddad60">'</span><span class="op" start="25" style="color: #ddad60">,</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="27" style="color: #585858">&amp;#x0300;</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="37" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">t2</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="32" select="quick" style="color: #885d3b">replace</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="9" select="quick" style="color: #ad95af">$t1</span><span class="op" start="12" style="color: #ddad60">,</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="14" style="color: #585858">\}\}</span><span class="op" style="color: #ddad60">'</span><span class="op" start="20" style="color: #ddad60">,</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="22" style="color: #585858">&amp;#x0301;</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="32" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> flags:s = match . to any char including \n </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:analyze-string</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$t2</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">regex</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="variable" start="1" select="quick" style="color: #ad95af">$regex1</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">flags</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">s</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:matching-substring</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">p</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="51" select="quick" style="color: #885d3b">f:unescape-p</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="14" pair-end="50" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="24" style="color: #566874">.</span><span class="op" start="25" style="color: #ddad60">,</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="numeric" start="27" style="color: #566874">2</span><span class="op" start="28" style="color: #ddad60">,</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="function" start="30" pair-end="45" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="44" style="color: #566874">.</span><span class="parenthesis" start="45" style="color: #295f94">)</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="op" start="47" style="color: #ddad60">-</span><span class="whitespace" start="48" style="color: #ddad60"> </span><span class="numeric" start="49" style="color: #566874">2</span><span class="parenthesis" start="50" style="color: #295f94">)</span><span class="parenthesis" start="51" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">op</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:text</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">{</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:text</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="17" select="quick" style="color: #885d3b">loc:showXPath</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$p</span><span class="parenthesis" start="17" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">op</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:text</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">}</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:text</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:matching-substring</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:non-matching-substring</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">p</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="15" select="quick" style="color: #885d3b">f:unescape-p</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="14" style="color: #566874">.</span><span class="parenthesis" start="15" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="variable" start="1" select="quick" style="color: #ad95af">$class</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$p</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:non-matching-substring</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:analyze-string</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:splitAttributeName</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">text</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:analyze-string</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">regex</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">(\S+)|(\s+)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$text</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:matching-substring</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="context" start="1" style="color: #566874">.</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:matching-substring</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:analyze-string</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> ///////////////////////// xpath-colorer /////////////////////////////////////////////// </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">ops</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">, / = &amp;lt; &amp;gt; + - * ? | != &amp;lt;= &amp;gt;= &amp;lt;&amp;lt; &amp;gt;&amp;gt; // := ! || { }</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">aOps</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">or and eq ne lt le gt ge is to div idiv mod union intersect except in return satisfies then else as map</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">hOps</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">for some every let</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">nodes</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">attribute comment document-node namespace-node element node processing-instruction text</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">types</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">empty-sequence function item node schema-attribute schema-element type</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">ambiguousOps</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="10" select="quick" style="color: #ad95af">$aOps</span><span class="op" start="15" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858">\s+</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">simpleOps</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="20" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="10" select="quick" style="color: #ad95af">$ops</span><span class="op" start="14" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">\s+</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">nodeTests</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="22" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="10" select="quick" style="color: #ad95af">$nodes</span><span class="op" start="16" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="17" style="color: #585858">\s+</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">typeTests</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="22" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="10" select="quick" style="color: #ad95af">$types</span><span class="op" start="16" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="17" style="color: #585858">\s+</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">higherOps</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="10" select="quick" style="color: #ad95af">$hOps</span><span class="op" start="15" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858">\s+</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">bgColor</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">black</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
  signature:
      loc:showXPath(text-content)
  
  description:
  
      Converts the xpath content string to a sequence of span elements. with each
      containing a class attribute used for coloring with CSS. 
  
  params:
     text-content: string containing a single XPath expression
  </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">loc:showXPath</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">chunk</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">chars</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="32" select="quick" style="color: #885d3b">loc:stringToCharSequence</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="26" select="quick" style="color: #ad95af">$chunk</span><span class="parenthesis" start="32" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">blocks</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="46" select="quick" style="color: #885d3b">loc:createBlocks</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$chars</span><span class="op" start="24" style="color: #ddad60">,</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="function" start="26" pair-end="32" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="32" style="color: #295f94">)</span><span class="op" start="33" style="color: #ddad60">,</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="numeric" start="35" style="color: #566874">1</span><span class="op" start="36" style="color: #ddad60">,</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="38" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="op" start="40" style="color: #ddad60">,</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="numeric" start="42" style="color: #566874">0</span><span class="op" start="43" style="color: #ddad60">,</span><span class="whitespace" start="44" style="color: #ddad60"> </span><span class="numeric" start="45" style="color: #566874">0</span><span class="parenthesis" start="46" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">pbPairs</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="72" select="quick" style="color: #885d3b">loc:createPairs</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="17" select="quick" style="color: #ad95af">$blocks</span><span class="filter" start="24" pair-end="71" select="quick" style="color: #295f94">[</span><span class="function" start="25" pair-end="30" select="quick" style="color: #885d3b">name</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="30" style="color: #295f94">)</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" start="32" style="color: #ddad60">=</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="34" style="color: #585858">block</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="op" start="42" style="color: #ddad60">and</span><span class="whitespace" start="45" style="color: #ddad60"> </span><span class="axis" start="46" style="color: #566874">@</span><span class="qname" start="47" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="51" style="color: #ddad60"> </span><span class="op" start="52" style="color: #ddad60">=</span><span class="whitespace" start="53" style="color: #ddad60"> </span><span class="parenthesis" start="54" pair-end="70" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="55" style="color: #585858">[</span><span class="op" style="color: #ddad60">'</span><span class="op" start="58" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="59" style="color: #585858">]</span><span class="op" style="color: #ddad60">'</span><span class="op" start="62" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="63" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="op" start="66" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="67" style="color: #585858">)</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="70" style="color: #295f94">)</span><span class="filter" start="71" style="color: #295f94">]</span><span class="parenthesis" start="72" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">omitPairs</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="parenthesis" start="1" pair-end="41" select="quick" style="color: #295f94">(</span><span class="variable" start="2" select="quick" style="color: #ad95af">$blocks</span><span class="filter" start="9" pair-end="40" select="quick" style="color: #295f94">[</span><span class="function" start="10" pair-end="15" select="quick" style="color: #885d3b">name</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="15" style="color: #295f94">)</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" start="17" style="color: #ddad60">=</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="parenthesis" start="19" pair-end="39" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="20" style="color: #585858">literal</span><span class="op" style="color: #ddad60">'</span><span class="op" start="29" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="30" style="color: #585858">comment</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="39" style="color: #295f94">)</span><span class="filter" start="40" style="color: #295f94">]</span><span class="parenthesis" start="41" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="43" select="quick" style="color: #885d3b">loc:getTokens</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$chunk</span><span class="op" start="21" style="color: #ddad60">,</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="variable" start="23" select="quick" style="color: #ad95af">$omitPairs</span><span class="op" start="33" style="color: #ddad60">,</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="variable" start="35" select="quick" style="color: #ad95af">$pbPairs</span><span class="parenthesis" start="43" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$css-inline</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" start="13" style="color: #ddad60">eq</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858">no</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:call-template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tcall" style="color: #b05a65">plain</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">para</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tokens</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:call-template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">node()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:call-template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tcall" style="color: #b05a65">plain</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">para</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tokens</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:call-template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #885d3b">f:style-spans</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$spans</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:style-spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">node()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">spans</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">node()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:for-each</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$spans</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color-key</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">class</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color-mode1</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element(color)?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                    </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$color-modes</span><span class="step" start="13" style="color: #ddad60">/</span><span class="qname" start="14" select="quick" style="color: #b05a65">color</span><span class="filter" start="19" pair-end="38" select="quick" style="color: #295f94">[</span><span class="qname" start="20" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="op" start="26" style="color: #ddad60">=</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="variable" start="28" select="quick" style="color: #ad95af">$color-key</span><span class="filter" start="38" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> use the yellow color mode if none defined for class </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color-mode2</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element(color)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                    </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="25" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="24" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="12" select="quick" style="color: #ad95af">$color-mode1</span><span class="parenthesis" start="24" style="color: #295f94">)</span><span class="parenthesis" start="25" style="color: #295f94">)</span><span class="whitespace" start="26" style="color: #ddad60">
                            </span><span class="op" start="27" style="color: #ddad60">then</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="variable" start="32" select="quick" style="color: #ad95af">$color-mode1</span><span class="whitespace" start="44" style="color: #ddad60">
                            </span><span class="op" start="45" style="color: #ddad60">else</span><span class="whitespace" start="49" style="color: #ddad60"> </span><span class="variable" start="50" select="quick" style="color: #ad95af">$color-modes</span><span class="step" start="62" style="color: #ddad60">/</span><span class="qname" start="63" select="quick" style="color: #b05a65">color</span><span class="filter" start="68" pair-end="85" select="quick" style="color: #295f94">[</span><span class="axis" start="69" style="color: #566874">@</span><span class="qname" start="70" select="quick" style="color: #b05a65">name</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="op" start="75" style="color: #ddad60">=</span><span class="whitespace" start="76" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="77" style="color: #585858">yellow</span><span class="op" style="color: #ddad60">'</span><span class="filter" start="85" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">property</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="27" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$color-mode2</span><span class="step" start="17" style="color: #ddad60">/</span><span class="axis" start="18" style="color: #566874">@</span><span class="qname" start="19" select="quick" style="color: #b05a65">property</span><span class="parenthesis" start="27" style="color: #295f94">)</span><span class="whitespace" start="28" style="color: #ddad60">
                                            </span><span class="op" start="29" style="color: #ddad60">then</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="variable" start="34" select="quick" style="color: #ad95af">$color-mode2</span><span class="step" start="46" style="color: #ddad60">/</span><span class="axis" start="47" style="color: #566874">@</span><span class="qname" start="48" select="quick" style="color: #b05a65">property</span><span class="whitespace" start="56" style="color: #ddad60">
                                            </span><span class="op" start="57" style="color: #ddad60">else</span><span class="whitespace" start="61" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="62" style="color: #585858">color</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:copy-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">style</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                       </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="45" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$property</span><span class="op" start="17" style="color: #ddad60">,</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="19" style="color: #585858">: #</span><span class="op" style="color: #ddad60">'</span><span class="op" start="24" style="color: #ddad60">,</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="variable" start="26" select="quick" style="color: #ad95af">$color-mode2</span><span class="step" start="38" style="color: #ddad60">/</span><span class="axis" start="39" style="color: #566874">@</span><span class="qname" start="40" select="quick" style="color: #b05a65">value</span><span class="parenthesis" start="45" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="context" start="1" style="color: #566874">.</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:copy</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:for-each</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> //////////////////////////////////////////////////////////////////////////////////////////////// </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> 
   Sample output:
  &lt;block position="3" type="["/&gt;
  &lt;literal type="'" start="54" end="61"/&gt;
  &lt;comment start="65" end="69"/&gt;
  &lt;comment start="76"/&gt; // if not closed
   </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> diagnostic formatting function - not used </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">loc:pad</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">padStringIn</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">fixedWidth</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">padString</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="33" select="quick" style="color: #885d3b">replace</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="9" select="quick" style="color: #ad95af">$padStringIn</span><span class="op" start="21" style="color: #ddad60">,</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="23" style="color: #585858">\n</span><span class="op" style="color: #ddad60">'</span><span class="op" start="27" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="28" style="color: #585858">\\n</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="33" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">stringLength</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="25" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$padString</span><span class="parenthesis" start="25" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">padChar</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="22" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$fixedWidth</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" start="17" style="color: #ddad60">gt</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="numeric" start="20" style="color: #566874">20</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="op" start="24" style="color: #ddad60">then</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="29" style="color: #585858">.</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" start="33" style="color: #ddad60">else</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="38" style="color: #585858"> </span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">padCount</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$fixedWidth</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" start="13" style="color: #ddad60">-</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="variable" start="15" select="quick" style="color: #ad95af">$stringLength</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$padCount</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">ge</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="numeric" start="14" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="77" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$padString</span><span class="op" start="18" style="color: #ddad60">,</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="function" start="20" pair-end="76" select="quick" style="color: #885d3b">string-join</span><span class="parenthesis" style="color: #295f94">(</span><span class="higher" start="32" style="color: #ddad60">for</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span id="rng-$i" class="variable" start="36" select="quick" style="color: #ad95af">$i</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="op" start="39" style="color: #ddad60">in</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="numeric" start="42" style="color: #566874">1</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="op" start="44" style="color: #ddad60">to</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="variable" start="47" select="quick" style="color: #ad95af">$padCount</span><span class="whitespace" start="56" style="color: #ddad60"> 
                            </span><span class="op" start="58" style="color: #ddad60">return</span><span class="whitespace" start="64" style="color: #ddad60"> </span><span class="variable" start="65" select="quick" style="color: #ad95af">$padChar</span><span class="op" start="73" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="74" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="76" style="color: #295f94">)</span><span class="parenthesis" start="77" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$padCount</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">lt</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="numeric" start="14" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="92" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$padString</span><span class="op" start="18" style="color: #ddad60">,</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="20" style="color: #585858">&amp;#10;</span><span class="op" style="color: #ddad60">'</span><span class="op" start="27" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="28" style="color: #585858"> </span><span class="op" style="color: #ddad60">'</span><span class="op" start="31" style="color: #ddad60">,</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="function" start="33" pair-end="91" select="quick" style="color: #885d3b">string-join</span><span class="parenthesis" style="color: #295f94">(</span><span class="higher" start="45" style="color: #ddad60">for</span><span class="whitespace" start="48" style="color: #ddad60"> </span><span id="rng-$i" class="variable" start="49" select="quick" style="color: #ad95af">$i</span><span class="whitespace" start="51" style="color: #ddad60"> </span><span class="op" start="52" style="color: #ddad60">in</span><span class="whitespace" start="54" style="color: #ddad60"> </span><span class="numeric" start="55" style="color: #566874">1</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="op" start="57" style="color: #ddad60">to</span><span class="whitespace" start="59" style="color: #ddad60"> </span><span class="variable" start="60" select="quick" style="color: #ad95af">$fixedWidth</span><span class="whitespace" start="71" style="color: #ddad60"> 
                            </span><span class="op" start="73" style="color: #ddad60">return</span><span class="whitespace" start="79" style="color: #ddad60"> </span><span class="variable" start="80" select="quick" style="color: #ad95af">$padChar</span><span class="op" start="88" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="89" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="91" style="color: #295f94">)</span><span class="parenthesis" start="92" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">f:iterateParas</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">paras</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">init-color</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">total</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="13" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="7" select="quick" style="color: #ad95af">$paras</span><span class="parenthesis" start="13" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">para</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$paras</span><span class="filter" start="7" pair-end="14" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="filter" start="14" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()?</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">pValue</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$para</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">value</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">pType</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$para</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">type</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isJoined</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="22" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$pValue</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="op" start="24" style="color: #ddad60">gt</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="numeric" start="27" style="color: #566874">1</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="op" start="29" style="color: #ddad60">and</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="function" start="33" pair-end="55" select="quick" style="color: #885d3b">ends-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="43" select="quick" style="color: #ad95af">$pValue</span><span class="op" start="50" style="color: #ddad60">,</span><span class="whitespace" start="51" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="52" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="55" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isLiteral</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="18" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="17" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$pType</span><span class="parenthesis" start="17" style="color: #295f94">)</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">then</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="function" start="25" pair-end="31" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="31" style="color: #295f94">)</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" start="33" style="color: #ddad60">else</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="variable" start="38" select="quick" style="color: #ad95af">$pType</span><span class="whitespace" start="44" style="color: #ddad60"> </span><span class="op" start="45" style="color: #ddad60">eq</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="48" style="color: #585858">literal</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">literalQuote</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="24" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$pValue</span><span class="op" start="18" style="color: #ddad60">,</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="numeric" start="20" style="color: #566874">1</span><span class="op" start="21" style="color: #ddad60">,</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="numeric" start="23" style="color: #566874">1</span><span class="parenthesis" start="24" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isLiteral</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">op</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$literalQuote</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prev</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$paras</span><span class="filter" start="7" pair-end="18" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">-</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="numeric" start="17" style="color: #566874">1</span><span class="filter" start="18" style="color: #295f94">]</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">toggle-color</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="51" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$document-type</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">eq</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="23" style="color: #585858">deltaxml</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="op" start="34" style="color: #ddad60">and</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="function" start="38" pair-end="50" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="44" select="quick" style="color: #ad95af">$pType</span><span class="parenthesis" start="50" style="color: #295f94">)</span><span class="parenthesis" start="51" style="color: #295f94">)</span><span class="whitespace" start="52" style="color: #ddad60"> </span><span class="op" start="53" style="color: #ddad60">then</span><span class="whitespace" start="57" style="color: #ddad60">
                          </span><span class="parenthesis" start="58" pair-end="95" select="quick" style="color: #295f94">(</span><span class="variable" start="59" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="65" style="color: #ddad60"> </span><span class="op" start="66" style="color: #ddad60">gt</span><span class="whitespace" start="68" style="color: #ddad60"> </span><span class="numeric" start="69" style="color: #566874">1</span><span class="whitespace" start="70" style="color: #ddad60"> </span><span class="op" start="71" style="color: #ddad60">and</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="variable" start="75" select="quick" style="color: #ad95af">$prev</span><span class="step" start="80" style="color: #ddad60">/</span><span class="axis" start="81" style="color: #566874">@</span><span class="qname" start="82" select="quick" style="color: #b05a65">value</span><span class="whitespace" start="87" style="color: #ddad60"> </span><span class="op" start="88" style="color: #ddad60">eq</span><span class="whitespace" start="90" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="91" style="color: #585858">!=</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="95" style="color: #295f94">)</span><span class="whitespace" start="96" style="color: #ddad60">
                          </span><span class="op" start="97" style="color: #ddad60">else</span><span class="whitespace" start="101" style="color: #ddad60"> </span><span class="function" start="102" pair-end="108" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="108" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">color-state</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="18" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$toggle-color</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">then</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="function" start="25" pair-end="40" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="29" select="quick" style="color: #ad95af">$init-color</span><span class="parenthesis" start="40" style="color: #295f94">)</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="op" start="42" style="color: #ddad60">else</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="variable" start="47" select="quick" style="color: #ad95af">$init-color</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pType</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">eq</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">variable</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">and</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="variable" start="26" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" start="33" style="color: #ddad60">+</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="numeric" start="35" style="color: #566874">2</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="op" start="37" style="color: #ddad60">lt</span><span class="whitespace" start="39" style="color: #ddad60"> </span><span class="variable" start="40" select="quick" style="color: #ad95af">$total</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$paras</span><span class="filter" start="7" pair-end="18" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">+</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="numeric" start="17" style="color: #566874">1</span><span class="filter" start="18" style="color: #295f94">]</span><span class="step" start="19" style="color: #ddad60">/</span><span class="axis" start="20" style="color: #566874">@</span><span class="qname" start="21" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="op" start="26" style="color: #ddad60">eq</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="29" style="color: #585858">whitespace</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="op" start="42" style="color: #ddad60">and</span><span class="whitespace" start="45" style="color: #ddad60"> </span><span class="variable" start="46" select="quick" style="color: #ad95af">$paras</span><span class="filter" start="52" pair-end="63" select="quick" style="color: #295f94">[</span><span class="variable" start="53" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="59" style="color: #ddad60"> </span><span class="op" start="60" style="color: #ddad60">+</span><span class="whitespace" start="61" style="color: #ddad60"> </span><span class="numeric" start="62" style="color: #566874">2</span><span class="filter" start="63" style="color: #295f94">]</span><span class="step" start="64" style="color: #ddad60">/</span><span class="axis" start="65" style="color: #566874">@</span><span class="qname" start="66" select="quick" style="color: #b05a65">value</span><span class="whitespace" start="71" style="color: #ddad60"> </span><span class="op" start="72" style="color: #ddad60">eq</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="75" style="color: #585858">in</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">id</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="23" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="8" style="color: #585858">rng-</span><span class="op" style="color: #ddad60">'</span><span class="op" start="14" style="color: #ddad60">,</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="variable" start="16" select="quick" style="color: #ad95af">$pValue</span><span class="parenthesis" start="23" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">className</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$document-type</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">eq</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="19" style="color: #585858">deltaxml</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" start="30" style="color: #ddad60">and</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="function" start="34" pair-end="46" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="40" select="quick" style="color: #ad95af">$pType</span><span class="parenthesis" start="46" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="17" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$color-state</span><span class="parenthesis" start="17" style="color: #295f94">)</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="op" start="19" style="color: #ddad60">then</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="24" style="color: #585858">orange</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" start="33" style="color: #ddad60">else</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="38" style="color: #585858">magenta</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="14" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$pType</span><span class="parenthesis" start="14" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="98" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$pType</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">eq</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">literal</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="op" start="25" style="color: #ddad60">and</span><span class="whitespace" start="28" style="color: #ddad60">
                                  </span><span class="function" start="29" pair-end="97" select="quick" style="color: #885d3b">matches</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="37" select="quick" style="color: #ad95af">$pValue</span><span class="whitespace" start="44" style="color: #ddad60"> </span><span class="op" start="45" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="46" style="color: #585858">select[\s\p{Zs}]*=[\s\p{Zs}]*[&amp;quot;&amp;apos;&amp;apos;]</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="97" style="color: #295f94">)</span><span class="parenthesis" start="98" style="color: #295f94">)</span><span class="whitespace" start="99" style="color: #ddad60">
                                  </span><span class="op" start="100" style="color: #ddad60">then</span><span class="whitespace" start="104" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="105" style="color: #585858">select</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="113" style="color: #ddad60">
                                  </span><span class="op" start="114" style="color: #ddad60">else</span><span class="whitespace" start="118" style="color: #ddad60"> </span><span class="variable" start="119" select="quick" style="color: #ad95af">$pType</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="106" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$prev</span><span class="step" start="10" style="color: #ddad60">/</span><span class="axis" start="11" style="color: #566874">@</span><span class="qname" start="12" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" start="17" style="color: #ddad60">eq</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="20" style="color: #585858">literal</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" start="30" style="color: #ddad60">and</span><span class="whitespace" start="33" style="color: #ddad60">
                                  </span><span class="function" start="34" pair-end="105" select="quick" style="color: #885d3b">matches</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="42" select="quick" style="color: #ad95af">$prev</span><span class="step" start="47" style="color: #ddad60">/</span><span class="axis" start="48" style="color: #566874">@</span><span class="qname" start="49" select="quick" style="color: #b05a65">value</span><span class="whitespace" start="54" style="color: #ddad60"> </span><span class="op" start="55" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="56" style="color: #585858">name[\s\p{Zs}]*=[\s\p{Zs}]*[&amp;quot;&amp;apos;&amp;apos;]</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="105" style="color: #295f94">)</span><span class="parenthesis" start="106" style="color: #295f94">)</span><span class="whitespace" start="107" style="color: #ddad60">
                                  </span><span class="op" start="108" style="color: #ddad60">then</span><span class="whitespace" start="112" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="113" style="color: #585858">external</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="123" style="color: #ddad60">
                                  </span><span class="op" start="124" style="color: #ddad60">else</span><span class="whitespace" start="128" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="129" style="color: #585858">qname</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$className</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$className</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">eq</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">external</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">id</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="23" select="quick" style="color: #885d3b">concat</span><span class="parenthesis" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="8" style="color: #585858">ext-</span><span class="op" style="color: #ddad60">'</span><span class="op" start="14" style="color: #ddad60">,</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="variable" start="16" select="quick" style="color: #ad95af">$pValue</span><span class="parenthesis" start="23" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$para</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="parenthesis" start="1" pair-end="45" select="quick" style="color: #295f94">(</span><span class="variable" start="2" select="quick" style="color: #ad95af">$pValue</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="op" start="10" style="color: #ddad60">=</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="parenthesis" start="12" pair-end="20" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="13" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="op" start="16" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="17" style="color: #585858">[</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">or</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="variable" start="25" select="quick" style="color: #ad95af">$pType</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" start="32" style="color: #ddad60">eq</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="35" style="color: #585858">function</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="45" style="color: #295f94">)</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="op" start="47" style="color: #ddad60">and</span><span class="whitespace" start="50" style="color: #ddad60"> </span><span class="function" start="51" pair-end="70" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="55" select="quick" style="color: #ad95af">$para</span><span class="step" start="60" style="color: #ddad60">/</span><span class="axis" start="61" style="color: #566874">@</span><span class="qname" start="62" select="quick" style="color: #b05a65">pair-end</span><span class="parenthesis" start="70" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">style</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">color: pink;</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$para</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">pair-end</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">pair-end</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$para</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">pair-end</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="11" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$pType</span><span class="parenthesis" start="11" style="color: #295f94">)</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" start="13" style="color: #ddad60">or</span><span class="whitespace" start="15" style="color: #ddad60"> 
                    </span><span class="parenthesis" start="17" pair-end="80" select="quick" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$pType</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="op" start="25" style="color: #ddad60">=</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="parenthesis" start="27" pair-end="79" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="28" style="color: #585858">function</span><span class="op" style="color: #ddad60">'</span><span class="op" start="38" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="39" style="color: #585858">filter</span><span class="op" style="color: #ddad60">'</span><span class="op" start="47" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="48" style="color: #585858">parenthesis</span><span class="op" style="color: #ddad60">'</span><span class="op" start="61" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="62" style="color: #585858">variable</span><span class="op" style="color: #ddad60">'</span><span class="op" start="72" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="73" style="color: #585858">node</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="79" style="color: #295f94">)</span><span class="parenthesis" start="80" style="color: #295f94">)</span><span class="whitespace" start="81" style="color: #ddad60"> </span><span class="op" start="82" style="color: #ddad60">and</span><span class="whitespace" start="85" style="color: #ddad60"> </span><span class="parenthesis" start="86" pair-end="111" select="quick" style="color: #295f94">(</span><span class="function" start="87" pair-end="110" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="91" select="quick" style="color: #ad95af">$pValue</span><span class="whitespace" start="98" style="color: #ddad60"> </span><span class="op" start="99" style="color: #ddad60">=</span><span class="whitespace" start="100" style="color: #ddad60"> </span><span class="parenthesis" start="101" pair-end="109" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="102" style="color: #585858">)</span><span class="op" style="color: #ddad60">'</span><span class="op" start="105" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="106" style="color: #585858">]</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="109" style="color: #295f94">)</span><span class="parenthesis" start="110" style="color: #295f94">)</span><span class="parenthesis" start="111" style="color: #295f94">)</span><span class="whitespace" start="112" style="color: #ddad60"> </span><span class="op" start="113" style="color: #ddad60">or</span><span class="whitespace" start="115" style="color: #ddad60">
                    </span><span class="parenthesis" start="116" pair-end="158" select="quick" style="color: #295f94">(</span><span class="variable" start="117" select="quick" style="color: #ad95af">$pValue</span><span class="whitespace" start="124" style="color: #ddad60"> </span><span class="op" start="125" style="color: #ddad60">eq</span><span class="whitespace" start="127" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="128" style="color: #585858">*</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="131" style="color: #ddad60"> </span><span class="op" start="132" style="color: #ddad60">and</span><span class="whitespace" start="135" style="color: #ddad60"> </span><span class="variable" start="136" select="quick" style="color: #ad95af">$prev</span><span class="step" start="141" style="color: #ddad60">/</span><span class="axis" start="142" style="color: #566874">@</span><span class="qname" start="143" select="quick" style="color: #b05a65">class</span><span class="whitespace" start="148" style="color: #ddad60"> </span><span class="op" start="149" style="color: #ddad60">eq</span><span class="whitespace" start="151" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="152" style="color: #585858">axis</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="158" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">select</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">quick</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
      &lt;xsl:choose&gt;
      &lt;xsl:when test="@type = ('literal','comment')"&gt;
      &lt;xsl:analyze-string 
      select="if ($isLiteral) then substring(@value, 2, string-length(@value) - 2)
      else @value" regex="\n"&gt;
      &lt;xsl:matching-substring&gt;
      &lt;br&gt;&lt;/br&gt;
      &lt;/xsl:matching-substring&gt;
      &lt;xsl:non-matching-substring&gt;
      &lt;xsl:value-of select="."/&gt;
      &lt;/xsl:non-matching-substring&gt;
      &lt;/xsl:analyze-string&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
      &lt;xsl:value-of select="if ($isJoined) then substring(@value, 1, string-length(@value) - 1) else @value"/&gt;
      &lt;/xsl:otherwise&gt;
      &lt;/xsl:choose&gt;
      </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pType</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">=</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="parenthesis" start="10" pair-end="30" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">literal</span><span class="op" style="color: #ddad60">'</span><span class="op" start="20" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="21" style="color: #585858">comment</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="30" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="15" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$isLiteral</span><span class="parenthesis" start="15" style="color: #295f94">)</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" start="17" style="color: #ddad60">then</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="function" start="22" pair-end="70" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="32" select="quick" style="color: #ad95af">$pValue</span><span class="op" start="39" style="color: #ddad60">,</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="numeric" start="41" style="color: #566874">2</span><span class="op" start="42" style="color: #ddad60">,</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="function" start="44" pair-end="65" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="58" select="quick" style="color: #ad95af">$pValue</span><span class="parenthesis" start="65" style="color: #295f94">)</span><span class="whitespace" start="66" style="color: #ddad60"> </span><span class="op" start="67" style="color: #ddad60">-</span><span class="whitespace" start="68" style="color: #ddad60"> </span><span class="numeric" start="69" style="color: #566874">2</span><span class="parenthesis" start="70" style="color: #295f94">)</span><span class="whitespace" start="71" style="color: #ddad60">
                                </span><span class="op" start="72" style="color: #ddad60">else</span><span class="whitespace" start="76" style="color: #ddad60"> </span><span class="variable" start="77" select="quick" style="color: #ad95af">$pValue</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="14" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$isJoined</span><span class="parenthesis" start="14" style="color: #295f94">)</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">then</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="function" start="21" pair-end="69" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="31" select="quick" style="color: #ad95af">$pValue</span><span class="op" start="38" style="color: #ddad60">,</span><span class="whitespace" start="39" style="color: #ddad60"> </span><span class="numeric" start="40" style="color: #566874">1</span><span class="op" start="41" style="color: #ddad60">,</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="function" start="43" pair-end="64" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="57" select="quick" style="color: #ad95af">$pValue</span><span class="parenthesis" start="64" style="color: #295f94">)</span><span class="whitespace" start="65" style="color: #ddad60"> </span><span class="op" start="66" style="color: #ddad60">-</span><span class="whitespace" start="67" style="color: #ddad60"> </span><span class="numeric" start="68" style="color: #566874">1</span><span class="parenthesis" start="69" style="color: #295f94">)</span><span class="whitespace" start="70" style="color: #ddad60"> </span><span class="op" start="71" style="color: #ddad60">else</span><span class="whitespace" start="75" style="color: #ddad60"> </span><span class="variable" start="76" select="quick" style="color: #ad95af">$pValue</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isJoined</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">parenthesis</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:text</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">(</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:text</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isLiteral</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">class</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">op</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$literalQuote</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="numeric" start="10" style="color: #566874">1</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">le</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="variable" start="15" select="quick" style="color: #ad95af">$total</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="48" select="quick" style="color: #885d3b">f:iterateParas</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="16" select="quick" style="color: #ad95af">$paras</span><span class="op" start="22" style="color: #ddad60">,</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="variable" start="24" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="op" start="31" style="color: #ddad60">+</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="numeric" start="33" style="color: #566874">1</span><span class="op" start="34" style="color: #ddad60">,</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="variable" start="36" select="quick" style="color: #ad95af">$color-state</span><span class="parenthesis" start="48" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tname" style="color: #ab2525">plain</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">para</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="32" select="quick" style="color: #885d3b">f:iterateParas</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="16" select="quick" style="color: #ad95af">$para</span><span class="op" start="21" style="color: #ddad60">,</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="numeric" start="23" style="color: #566874">1</span><span class="op" start="24" style="color: #ddad60">,</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="function" start="26" pair-end="31" select="quick" style="color: #885d3b">true</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="31" style="color: #295f94">)</span><span class="parenthesis" start="32" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">match</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="qname" start="1" select="quick" style="color: #b05a65">token</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">mode</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">plainLine</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">span</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">class</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">type</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">revChars</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="37" select="quick" style="color: #885d3b">reverse</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="9" pair-end="36" select="quick" style="color: #885d3b">string-to-codepoints</span><span class="parenthesis" style="color: #295f94">(</span><span class="axis" start="30" style="color: #566874">@</span><span class="qname" start="31" select="quick" style="color: #b05a65">value</span><span class="parenthesis" start="36" style="color: #295f94">)</span><span class="parenthesis" start="37" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">lastLF</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="16" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="7" select="quick" style="color: #ad95af">$revChars</span><span class="parenthesis" start="16" style="color: #295f94">)</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" start="18" style="color: #ddad60">+</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="numeric" start="20" style="color: #566874">1</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">-</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="function" start="24" pair-end="46" select="quick" style="color: #885d3b">index-of</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="33" select="quick" style="color: #ad95af">$revChars</span><span class="op" start="42" style="color: #ddad60">,</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="numeric" start="44" style="color: #566874">10</span><span class="parenthesis" start="46" style="color: #295f94">)</span><span class="filter" start="47" pair-end="49" select="quick" style="color: #295f94">[</span><span class="numeric" start="48" style="color: #566874">1</span><span class="filter" start="49" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="30" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="axis" start="11" style="color: #566874">@</span><span class="qname" start="12" select="quick" style="color: #b05a65">value</span><span class="op" start="17" style="color: #ddad60">,</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="variable" start="19" select="quick" style="color: #ad95af">$lastLF</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" start="27" style="color: #ddad60">+</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="numeric" start="29" style="color: #566874">1</span><span class="parenthesis" start="30" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">span</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">match</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="qname" start="1" select="quick" style="color: #b05a65">token</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">mode</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">dev</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">p</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="cl" style="color: #b05a65">p</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">loc:stringToCharSequence</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="higher" start="1" style="color: #ddad60">for</span><span class="whitespace" start="4" style="color: #ddad60"> </span><span id="rng-$i" class="variable" start="5" select="quick" style="color: #ad95af">$i</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">in</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="numeric" start="11" style="color: #566874">1</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" start="13" style="color: #ddad60">to</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="function" start="16" pair-end="37" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="30" select="quick" style="color: #ad95af">$string</span><span class="parenthesis" start="37" style="color: #295f94">)</span><span class="whitespace" start="38" style="color: #ddad60">
                          </span><span class="op" start="39" style="color: #ddad60">return</span><span class="whitespace" start="45" style="color: #ddad60"> </span><span class="function" start="46" pair-end="70" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="56" select="quick" style="color: #ad95af">$string</span><span class="op" start="63" style="color: #ddad60">,</span><span class="whitespace" start="64" style="color: #ddad60"> </span><span class="variable" start="65" select="quick" style="color: #ad95af">$i</span><span class="op" start="67" style="color: #ddad60">,</span><span class="whitespace" start="68" style="color: #ddad60"> </span><span class="numeric" start="69" style="color: #566874">1</span><span class="parenthesis" start="70" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">loc:createPairs</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">brackets</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">nested</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:call-template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tcall" style="color: #b05a65">getNesting</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">positions</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$brackets</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="numeric" start="1" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="numeric" start="1" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:call-template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">  pair up start and end elements </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">ends</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$nested</span><span class="filter" start="8" pair-end="13" select="quick" style="color: #295f94">[</span><span class="axis" start="9" style="color: #566874">@</span><span class="qname" start="10" select="quick" style="color: #b05a65">end</span><span class="filter" start="13" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:for-each</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$nested</span><span class="filter" start="8" pair-end="15" select="quick" style="color: #295f94">[</span><span class="axis" start="9" style="color: #566874">@</span><span class="qname" start="10" select="quick" style="color: #b05a65">start</span><span class="filter" start="15" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="axis" start="1" style="color: #566874">@</span><span class="qname" start="2" select="quick" style="color: #b05a65">level</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">pair</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="parenthesis" start="1" pair-end="24" select="quick" style="color: #295f94">(</span><span class="variable" start="2" select="quick" style="color: #ad95af">$ends</span><span class="filter" start="7" pair-end="23" select="quick" style="color: #295f94">[</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">level</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">=</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="variable" start="17" select="quick" style="color: #ad95af">$level</span><span class="filter" start="23" style="color: #295f94">]</span><span class="parenthesis" start="24" style="color: #295f94">)</span><span class="filter" start="25" pair-end="47" select="quick" style="color: #295f94">[</span><span class="function" start="26" pair-end="37" select="quick" style="color: #885d3b">number</span><span class="parenthesis" style="color: #295f94">(</span><span class="axis" start="33" style="color: #566874">@</span><span class="qname" start="34" select="quick" style="color: #b05a65">end</span><span class="parenthesis" start="37" style="color: #295f94">)</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="op" start="39" style="color: #ddad60">&gt;</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="variable" start="41" select="quick" style="color: #ad95af">$start</span><span class="filter" start="47" style="color: #295f94">]</span><span class="filter" start="48" pair-end="50" select="quick" style="color: #295f94">[</span><span class="numeric" start="49" style="color: #566874">1</span><span class="filter" start="50" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                    </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="function" start="1" pair-end="7" select="quick" style="color: #885d3b">name</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="6" style="color: #566874">.</span><span class="parenthesis" start="7" style="color: #295f94">)</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$level</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pair</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">end</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pair</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">end</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:for-each</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tname" style="color: #ab2525">getNesting</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">positions</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">tunnel</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">yes</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">pos</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$positions</span><span class="filter" start="11" pair-end="18" select="quick" style="color: #295f94">[</span><span class="variable" start="12" select="quick" style="color: #ad95af">$index</span><span class="filter" start="18" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isOpen</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pos</span><span class="step" start="5" style="color: #ddad60">/</span><span class="axis" start="6" style="color: #566874">@</span><span class="qname" start="7" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">=</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="parenthesis" start="14" pair-end="28" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="op" start="18" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="19" style="color: #585858">[</span><span class="op" style="color: #ddad60">'</span><span class="op" start="22" style="color: #ddad60">,</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="24" style="color: #585858">(:</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isBracket</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pos</span><span class="step" start="5" style="color: #ddad60">/</span><span class="axis" start="6" style="color: #566874">@</span><span class="qname" start="7" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">=</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="parenthesis" start="14" pair-end="22" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="op" start="18" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="19" style="color: #585858">)</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isComment</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pos</span><span class="step" start="5" style="color: #ddad60">/</span><span class="axis" start="6" style="color: #566874">@</span><span class="qname" start="7" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">=</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="parenthesis" start="14" pair-end="24" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">(:</span><span class="op" style="color: #ddad60">'</span><span class="op" start="19" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="20" style="color: #585858">:)</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="24" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">blockType</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" pair-end="14" style="color: #ddad60">if</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="4" select="quick" style="color: #ad95af">$isBracket</span><span class="parenthesis" start="14" style="color: #295f94">)</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">then</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="21" style="color: #585858">bracket</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="30" style="color: #ddad60">
                                           </span><span class="op" start="31" style="color: #ddad60">else</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="if" start="36" pair-end="49" style="color: #ddad60">if</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="39" select="quick" style="color: #ad95af">$isComment</span><span class="parenthesis" start="49" style="color: #295f94">)</span><span class="whitespace" start="50" style="color: #ddad60"> </span><span class="op" start="51" style="color: #ddad60">then</span><span class="whitespace" start="55" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="56" style="color: #585858">comment</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="65" style="color: #ddad60">
                                           </span><span class="op" start="66" style="color: #ddad60">else</span><span class="whitespace" start="70" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="71" style="color: #585858">predicate</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">newLevel</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" pair-end="11" style="color: #ddad60">if</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="4" select="quick" style="color: #ad95af">$isOpen</span><span class="parenthesis" start="11" style="color: #295f94">)</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" start="13" style="color: #ddad60">then</span><span class="whitespace" start="17" style="color: #ddad60">
                                          </span><span class="variable" start="18" select="quick" style="color: #ad95af">$level</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="op" start="25" style="color: #ddad60">+</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="numeric" start="27" style="color: #566874">1</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="op" start="29" style="color: #ddad60">else</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="variable" start="34" select="quick" style="color: #ad95af">$level</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="op" start="41" style="color: #ddad60">-</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="numeric" start="43" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="11" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="7" select="quick" style="color: #ad95af">$pos</span><span class="parenthesis" start="11" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isOpen</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="variable" start="1" select="quick" style="color: #ad95af">$blockType</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pos</span><span class="step" start="5" style="color: #ddad60">/</span><span class="axis" start="6" style="color: #566874">@</span><span class="qname" start="7" select="quick" style="color: #b05a65">position</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$newLevel</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="variable" start="1" select="quick" style="color: #ad95af">$blockType</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">end</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pos</span><span class="step" start="5" style="color: #ddad60">/</span><span class="axis" start="6" style="color: #566874">@</span><span class="qname" start="7" select="quick" style="color: #b05a65">position</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$level</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="numeric" start="10" style="color: #566874">1</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">&gt;</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="function" start="14" pair-end="30" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="20" select="quick" style="color: #ad95af">$positions</span><span class="parenthesis" start="30" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:call-template</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="tcall" style="color: #b05a65">getNesting</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$newLevel</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:with-param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="numeric" start="10" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:call-template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:template</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">loc:createBlocks</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">chars</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">skip</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">awaiting</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">charCount</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="13" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="7" select="quick" style="color: #ad95af">$chars</span><span class="parenthesis" start="13" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">char</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$chars</span><span class="filter" start="7" pair-end="14" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="filter" start="14" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">nChar</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$chars</span><span class="filter" start="7" pair-end="18" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">+</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="numeric" start="17" style="color: #566874">1</span><span class="filter" start="18" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">pChar</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$chars</span><span class="filter" start="7" pair-end="18" select="quick" style="color: #295f94">[</span><span class="variable" start="8" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">-</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="numeric" start="17" style="color: #566874">1</span><span class="filter" start="18" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">newLevel</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">=</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="13" style="color: #585858">:)</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" pair-end="32" style="color: #ddad60">if</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="4" select="quick" style="color: #ad95af">$char</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="op" start="10" style="color: #ddad60">=</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="12" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">and</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="variable" start="20" select="quick" style="color: #ad95af">$nChar</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" start="27" style="color: #ddad60">=</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="29" style="color: #585858">:</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="32" style="color: #295f94">)</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="op" start="34" style="color: #ddad60">then</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="variable" start="39" select="quick" style="color: #ad95af">$level</span><span class="whitespace" start="45" style="color: #ddad60"> </span><span class="op" start="46" style="color: #ddad60">+</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="numeric" start="48" style="color: #566874">1</span><span class="whitespace" start="49" style="color: #ddad60">
                                </span><span class="op" start="50" style="color: #ddad60">else</span><span class="whitespace" start="54" style="color: #ddad60"> </span><span class="if" start="55" style="color: #ddad60">if</span><span class="whitespace" start="57" style="color: #ddad60"> </span><span class="parenthesis" start="58" pair-end="103" select="quick" style="color: #295f94">(</span><span class="variable" start="59" select="quick" style="color: #ad95af">$char</span><span class="whitespace" start="64" style="color: #ddad60"> </span><span class="op" start="65" style="color: #ddad60">=</span><span class="whitespace" start="66" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="67" style="color: #585858">)</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="70" style="color: #ddad60"> </span><span class="op" start="71" style="color: #ddad60">and</span><span class="whitespace" start="74" style="color: #ddad60"> </span><span class="variable" start="75" select="quick" style="color: #ad95af">$pChar</span><span class="whitespace" start="81" style="color: #ddad60"> </span><span class="op" start="82" style="color: #ddad60">=</span><span class="whitespace" start="83" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="84" style="color: #585858">:</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="87" style="color: #ddad60"> </span><span class="op" start="88" style="color: #ddad60">and</span><span class="whitespace" start="91" style="color: #ddad60"> </span><span class="variable" start="92" select="quick" style="color: #ad95af">$level</span><span class="whitespace" start="98" style="color: #ddad60"> </span><span class="op" start="99" style="color: #ddad60">gt</span><span class="whitespace" start="101" style="color: #ddad60"> </span><span class="numeric" start="102" style="color: #566874">0</span><span class="parenthesis" start="103" style="color: #295f94">)</span><span class="whitespace" start="104" style="color: #ddad60"> </span><span class="op" start="105" style="color: #ddad60">then</span><span class="whitespace" start="109" style="color: #ddad60"> </span><span class="variable" start="110" select="quick" style="color: #ad95af">$level</span><span class="whitespace" start="116" style="color: #ddad60"> </span><span class="numeric" start="117" style="color: #566874">-1</span><span class="whitespace" start="119" style="color: #ddad60">
                                </span><span class="op" start="120" style="color: #ddad60">else</span><span class="whitespace" start="124" style="color: #ddad60"> </span><span class="variable" start="125" select="quick" style="color: #ad95af">$level</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$level</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">nowAwaiting</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="op" start="10" style="color: #ddad60">=</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" pair-end="37" style="color: #ddad60">if</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="4" select="quick" style="color: #ad95af">$char</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="op" start="10" style="color: #ddad60">=</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="parenthesis" start="12" pair-end="36" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="13" style="color: #585858">&amp;apos;&amp;apos;</span><span class="op" style="color: #ddad60">'</span><span class="op" start="27" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="28" style="color: #585858">&amp;quot;</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="36" style="color: #295f94">)</span><span class="parenthesis" start="37" style="color: #295f94">)</span><span class="whitespace" start="38" style="color: #ddad60">
                                </span><span class="op" start="39" style="color: #ddad60">then</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="variable" start="44" select="quick" style="color: #ad95af">$char</span><span class="whitespace" start="49" style="color: #ddad60"> 
                                </span><span class="op" start="51" style="color: #ddad60">else</span><span class="whitespace" start="55" style="color: #ddad60"> </span><span class="if" start="56" style="color: #ddad60">if</span><span class="whitespace" start="58" style="color: #ddad60"> </span><span class="parenthesis" start="59" pair-end="88" select="quick" style="color: #295f94">(</span><span class="variable" start="60" select="quick" style="color: #ad95af">$char</span><span class="whitespace" start="65" style="color: #ddad60"> </span><span class="op" start="66" style="color: #ddad60">=</span><span class="whitespace" start="67" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="68" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="71" style="color: #ddad60"> </span><span class="op" start="72" style="color: #ddad60">and</span><span class="whitespace" start="75" style="color: #ddad60"> </span><span class="variable" start="76" select="quick" style="color: #ad95af">$nChar</span><span class="whitespace" start="82" style="color: #ddad60"> </span><span class="op" start="83" style="color: #ddad60">=</span><span class="whitespace" start="84" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="85" style="color: #585858">:</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="88" style="color: #295f94">)</span><span class="whitespace" start="89" style="color: #ddad60"> </span><span class="op" start="90" style="color: #ddad60">then</span><span class="whitespace" start="94" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="95" style="color: #585858">:)</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="99" style="color: #ddad60"> 
                                </span><span class="op" start="101" style="color: #ddad60">else</span><span class="whitespace" start="105" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="106" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$char</span><span class="whitespace" start="6" style="color: #ddad60"> </span><span class="op" start="7" style="color: #ddad60">=</span><span class="whitespace" start="8" style="color: #ddad60"> </span><span class="variable" start="9" select="quick" style="color: #ad95af">$awaiting</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">=</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="13" style="color: #585858">:)</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" start="18" style="color: #ddad60">and</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="variable" start="22" select="quick" style="color: #ad95af">$char</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="op" start="28" style="color: #ddad60">=</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="30" style="color: #585858">)</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="op" start="34" style="color: #ddad60">and</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="variable" start="38" select="quick" style="color: #ad95af">$pChar</span><span class="whitespace" start="44" style="color: #ddad60"> </span><span class="op" start="45" style="color: #ddad60">=</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="47" style="color: #585858">:</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="50" style="color: #ddad60"> </span><span class="op" start="51" style="color: #ddad60">and</span><span class="whitespace" start="54" style="color: #ddad60"> </span><span class="variable" start="55" select="quick" style="color: #ad95af">$level</span><span class="whitespace" start="61" style="color: #ddad60"> </span><span class="op" start="62" style="color: #ddad60">=</span><span class="whitespace" start="63" style="color: #ddad60"> </span><span class="numeric" start="64" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">nowSkip</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$skip</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="7" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="7" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$char</span><span class="whitespace" start="6" style="color: #ddad60"> </span><span class="op" start="7" style="color: #ddad60">=</span><span class="whitespace" start="8" style="color: #ddad60"> </span><span class="variable" start="9" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="op" start="19" style="color: #ddad60">and</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="variable" start="23" select="quick" style="color: #ad95af">$nChar</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" start="30" style="color: #ddad60">=</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="variable" start="32" select="quick" style="color: #ad95af">$char</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="6" select="quick" style="color: #885d3b">true</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="6" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="7" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="7" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">=</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="13" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">and</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="variable" start="20" select="quick" style="color: #ad95af">$nowAwaiting</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="op" start="33" style="color: #ddad60">=</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="35" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$char</span><span class="whitespace" start="6" style="color: #ddad60"> </span><span class="op" start="7" style="color: #ddad60">=</span><span class="whitespace" start="8" style="color: #ddad60"> </span><span class="parenthesis" start="9" pair-end="25" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="10" style="color: #585858">[</span><span class="op" style="color: #ddad60">'</span><span class="op" start="13" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="14" style="color: #585858">]</span><span class="op" style="color: #ddad60">'</span><span class="op" start="17" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="18" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="op" start="21" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="22" style="color: #585858">)</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="25" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="en" style="color: #b05a65">block</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">position</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">type</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="variable" start="1" select="quick" style="color: #ad95af">$char</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isFound</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="29" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">=</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="variable" start="17" select="quick" style="color: #ad95af">$nowAwaiting</span><span class="parenthesis" start="29" style="color: #295f94">)</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="op" start="31" style="color: #ddad60">and</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="function" start="35" pair-end="56" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="39" select="quick" style="color: #ad95af">$skip</span><span class="whitespace" start="44" style="color: #ddad60"> </span><span class="op" start="45" style="color: #ddad60">or</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="variable" start="48" select="quick" style="color: #ad95af">$nowSkip</span><span class="parenthesis" start="56" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">newStart</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="13" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$isFound</span><span class="parenthesis" start="13" style="color: #295f94">)</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">then</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="variable" start="20" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" start="27" style="color: #ddad60">else</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="variable" start="32" select="quick" style="color: #ad95af">$start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">ne</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="14" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" start="17" style="color: #ddad60">and</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="variable" start="21" select="quick" style="color: #ad95af">$isFound</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="21" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">=</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="17" style="color: #585858">:)</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" start="23" style="color: #ddad60">then</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="28" style="color: #585858">comment</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" start="38" style="color: #ddad60">else</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="43" style="color: #585858">literal</span><span class="op" style="color: #ddad60">'</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">ne</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="14" style="color: #585858">:)</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$char</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">end</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">eq</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="variable" start="11" select="quick" style="color: #ad95af">$charCount</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">ne</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="14" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" start="17" style="color: #ddad60">and</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="function" start="21" pair-end="33" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="25" select="quick" style="color: #ad95af">$isFound</span><span class="parenthesis" start="33" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">{</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="21" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">=</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="17" style="color: #585858">:)</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" start="23" style="color: #ddad60">then</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="28" style="color: #585858">comment</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" start="38" style="color: #ddad60">else</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="43" style="color: #585858">literal</span><span class="op" style="color: #ddad60">'</span><span class="op" style="color: #ddad60">}</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">ne</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="14" style="color: #585858">:)</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$awaiting</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="82" select="quick" style="color: #885d3b">loc:createBlocks</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$chars</span><span class="op" start="24" style="color: #ddad60">,</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="variable" start="26" select="quick" style="color: #ad95af">$nowSkip</span><span class="op" start="34" style="color: #ddad60">,</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="variable" start="36" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="op" start="43" style="color: #ddad60">+</span><span class="whitespace" start="44" style="color: #ddad60"> </span><span class="numeric" start="45" style="color: #566874">1</span><span class="op" start="46" style="color: #ddad60">,</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="variable" start="48" select="quick" style="color: #ad95af">$nowAwaiting</span><span class="op" start="60" style="color: #ddad60">,</span><span class="whitespace" start="61" style="color: #ddad60"> </span><span class="variable" start="62" select="quick" style="color: #ad95af">$newStart</span><span class="op" start="71" style="color: #ddad60">,</span><span class="whitespace" start="72" style="color: #ddad60"> </span><span class="variable" start="73" select="quick" style="color: #ad95af">$newLevel</span><span class="parenthesis" start="82" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> top-level call - marks up tokens with their type </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">loc:getTokens</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">chunk</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">omitPairs</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">pbPairs</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="42" select="quick" style="color: #885d3b">loc:createTokens</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$chunk</span><span class="op" start="24" style="color: #ddad60">,</span><span class="whitespace" start="25" style="color: #ddad60"> </span><span class="variable" start="26" select="quick" style="color: #ad95af">$omitPairs</span><span class="op" start="36" style="color: #ddad60">,</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="numeric" start="38" style="color: #566874">1</span><span class="op" start="39" style="color: #ddad60">,</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="numeric" start="41" style="color: #566874">1</span><span class="parenthesis" start="42" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="70" select="quick" style="color: #885d3b">loc:rationalizeTokens</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="23" select="quick" style="color: #ad95af">$tokens</span><span class="op" start="30" style="color: #ddad60">,</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="numeric" start="32" style="color: #566874">1</span><span class="op" start="33" style="color: #ddad60">,</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="function" start="35" pair-end="41" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="41" style="color: #295f94">)</span><span class="op" start="42" style="color: #ddad60">,</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="variable" start="44" select="quick" style="color: #ad95af">$pbPairs</span><span class="op" start="52" style="color: #ddad60">,</span><span class="whitespace" start="53" style="color: #ddad60"> </span><span class="function" start="54" pair-end="60" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="60" style="color: #295f94">)</span><span class="op" start="61" style="color: #ddad60">,</span><span class="whitespace" start="62" style="color: #ddad60"> </span><span class="function" start="63" pair-end="69" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="69" style="color: #295f94">)</span><span class="parenthesis" start="70" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">loc:rationalizeTokens</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">prevIsClosed</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">pbPairs</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">typeExpected</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">quantifierExpected</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> when closed, a probable operator is a QName instead </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">token</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tokens</span><span class="filter" start="8" pair-end="15" select="quick" style="color: #295f94">[</span><span class="variable" start="9" select="quick" style="color: #ad95af">$index</span><span class="filter" start="15" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()?</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isQuantifier</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$quantifierExpected</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="op" start="21" style="color: #ddad60">and</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="variable" start="25" select="quick" style="color: #ad95af">$token</span><span class="step" start="31" style="color: #ddad60">/</span><span class="axis" start="32" style="color: #566874">@</span><span class="qname" start="33" select="quick" style="color: #b05a65">value</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="op" start="39" style="color: #ddad60">=</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="parenthesis" start="41" pair-end="53" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="42" style="color: #585858">?</span><span class="op" style="color: #ddad60">'</span><span class="op" start="45" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="46" style="color: #585858">*</span><span class="op" style="color: #ddad60">'</span><span class="op" start="49" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="50" style="color: #585858">+</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="53" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">is-wildcard</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="18" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$isQuantifier</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">and</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="function" start="24" pair-end="41" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="28" select="quick" style="color: #ad95af">$prevIsClosed</span><span class="parenthesis" start="41" style="color: #295f94">)</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="op" start="43" style="color: #ddad60">and</span><span class="whitespace" start="46" style="color: #ddad60"> </span><span class="variable" start="47" select="quick" style="color: #ad95af">$token</span><span class="step" start="53" style="color: #ddad60">/</span><span class="axis" start="54" style="color: #566874">@</span><span class="qname" start="55" select="quick" style="color: #b05a65">value</span><span class="whitespace" start="60" style="color: #ddad60"> </span><span class="op" start="61" style="color: #ddad60">eq</span><span class="whitespace" start="63" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="64" style="color: #585858">*</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">currentIsClosed</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$is-wildcard</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" start="14" style="color: #ddad60">or</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="variable" start="17" select="quick" style="color: #ad95af">$isQuantifier</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="op" start="31" style="color: #ddad60">or</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="function" start="34" pair-end="50" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="38" select="quick" style="color: #ad95af">$token</span><span class="step" start="44" style="color: #ddad60">/</span><span class="axis" start="45" style="color: #566874">@</span><span class="qname" start="46" select="quick" style="color: #b05a65">type</span><span class="parenthesis" start="50" style="color: #295f94">)</span><span class="whitespace" start="51" style="color: #ddad60"> </span><span class="op" start="52" style="color: #ddad60">or</span><span class="whitespace" start="54" style="color: #ddad60"> </span><span class="parenthesis" start="55" pair-end="150" select="quick" style="color: #295f94">(</span><span class="variable" start="56" select="quick" style="color: #ad95af">$token</span><span class="step" start="62" style="color: #ddad60">/</span><span class="axis" start="63" style="color: #566874">@</span><span class="qname" start="64" select="quick" style="color: #b05a65">value</span><span class="whitespace" start="69" style="color: #ddad60"> </span><span class="op" start="70" style="color: #ddad60">=</span><span class="whitespace" start="71" style="color: #ddad60"> </span><span class="parenthesis" start="72" pair-end="85" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="73" style="color: #585858">)</span><span class="op" style="color: #ddad60">'</span><span class="op" start="76" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="77" style="color: #585858">]</span><span class="op" style="color: #ddad60">'</span><span class="op" start="80" style="color: #ddad60">,</span><span class="whitespace" start="81" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="82" style="color: #585858">}</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="85" style="color: #295f94">)</span><span class="whitespace" start="86" style="color: #ddad60"> </span><span class="op" start="87" style="color: #ddad60">or</span><span class="whitespace" start="89" style="color: #ddad60"> </span><span class="parenthesis" start="90" pair-end="149" select="quick" style="color: #295f94">(</span><span class="variable" start="91" select="quick" style="color: #ad95af">$token</span><span class="step" start="97" style="color: #ddad60">/</span><span class="axis" start="98" style="color: #566874">@</span><span class="qname" start="99" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="103" style="color: #ddad60"> </span><span class="op" start="104" style="color: #ddad60">=</span><span class="whitespace" start="105" style="color: #ddad60"> </span><span class="parenthesis" start="106" pair-end="148" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="107" style="color: #585858">literal</span><span class="op" style="color: #ddad60">'</span><span class="op" start="116" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="117" style="color: #585858">numeric</span><span class="op" style="color: #ddad60">'</span><span class="op" start="126" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="127" style="color: #585858">variable</span><span class="op" style="color: #ddad60">'</span><span class="op" start="137" style="color: #ddad60">,</span><span class="whitespace" start="138" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="139" style="color: #585858">context</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="148" style="color: #295f94">)</span><span class="parenthesis" start="149" style="color: #295f94">)</span><span class="parenthesis" start="150" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">token</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">end</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">end</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">value</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">value</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" start="14" style="color: #ddad60">=</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858">probableOp</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$prevIsClosed</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">op</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$is-wildcard</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55">
          &lt;xsl:attribute name="type" select="'any'"/&gt;
          </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" start="14" style="color: #ddad60">=</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="parenthesis" start="16" pair-end="40" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="17" style="color: #585858">function</span><span class="op" style="color: #ddad60">'</span><span class="op" start="27" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="28" style="color: #585858">if</span><span class="op" style="color: #ddad60">'</span><span class="op" start="32" style="color: #ddad60">,</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="34" style="color: #585858">node</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="40" style="color: #295f94">)</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="op" start="42" style="color: #ddad60">or</span><span class="whitespace" start="44" style="color: #ddad60"> </span><span class="variable" start="45" select="quick" style="color: #ad95af">$token</span><span class="step" start="51" style="color: #ddad60">/</span><span class="axis" start="52" style="color: #566874">@</span><span class="qname" start="53" select="quick" style="color: #b05a65">value</span><span class="whitespace" start="58" style="color: #ddad60"> </span><span class="op" start="59" style="color: #ddad60">=</span><span class="whitespace" start="60" style="color: #ddad60"> </span><span class="parenthesis" start="61" pair-end="69" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="62" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="op" start="65" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="66" style="color: #585858">[</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="69" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">pair</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pbPairs</span><span class="filter" start="9" pair-end="30" select="quick" style="color: #295f94">[</span><span class="axis" start="10" style="color: #566874">@</span><span class="qname" start="11" select="quick" style="color: #b05a65">start</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" start="17" style="color: #ddad60">=</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="variable" start="19" select="quick" style="color: #ad95af">$token</span><span class="step" start="25" style="color: #ddad60">/</span><span class="axis" start="26" style="color: #566874">@</span><span class="qname" start="27" select="quick" style="color: #b05a65">end</span><span class="filter" start="30" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$typeExpected</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">and</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="variable" start="19" select="quick" style="color: #ad95af">$token</span><span class="step" start="25" style="color: #ddad60">/</span><span class="axis" start="26" style="color: #566874">@</span><span class="qname" start="27" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" start="32" style="color: #ddad60">=</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="parenthesis" start="34" pair-end="53" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="35" style="color: #585858">node</span><span class="op" style="color: #ddad60">'</span><span class="op" start="41" style="color: #ddad60">,</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="43" style="color: #585858">function</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="53" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">node-type</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">type</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="17" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="5" pair-end="16" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$pair</span><span class="parenthesis" start="16" style="color: #295f94">)</span><span class="parenthesis" start="17" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pair</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">end</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">pair-end</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pair</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">end</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">level</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$pair</span><span class="step" start="6" style="color: #ddad60">/</span><span class="axis" start="7" style="color: #566874">@</span><span class="qname" start="8" select="quick" style="color: #b05a65">level</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$typeExpected</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="17" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$token</span><span class="step" start="11" style="color: #ddad60">/</span><span class="axis" start="12" style="color: #566874">@</span><span class="qname" start="13" select="quick" style="color: #b05a65">type</span><span class="parenthesis" start="17" style="color: #295f94">)</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="op" start="19" style="color: #ddad60">then</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="variable" start="24" select="quick" style="color: #ad95af">$token</span><span class="step" start="30" style="color: #ddad60">/</span><span class="axis" start="31" style="color: #566874">@</span><span class="qname" start="32" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="op" start="37" style="color: #ddad60">else</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="42" style="color: #585858">type-name</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isQuantifier</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">quantifier</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">type</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">type</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">ignorable</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" start="14" style="color: #ddad60">=</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="parenthesis" start="16" pair-end="40" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="17" style="color: #585858">whitespace</span><span class="op" style="color: #ddad60">'</span><span class="op" start="29" style="color: #ddad60">,</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="31" style="color: #585858">comment</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="40" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isNewClosed</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$ignorable</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$prevIsClosed</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="step" start="7" style="color: #ddad60">/</span><span class="axis" start="8" style="color: #566874">@</span><span class="qname" start="9" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" start="14" style="color: #ddad60">=</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858">probableOp</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="18" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$prevIsClosed</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$currentIsClosed</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">newTypeExpected</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="15" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$ignorable</span><span class="parenthesis" start="15" style="color: #295f94">)</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" start="17" style="color: #ddad60">then</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="variable" start="22" select="quick" style="color: #ad95af">$typeExpected</span><span class="whitespace" start="35" style="color: #ddad60">
                          </span><span class="op" start="36" style="color: #ddad60">else</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="parenthesis" start="41" pair-end="66" select="quick" style="color: #295f94">(</span><span class="variable" start="42" select="quick" style="color: #ad95af">$token</span><span class="step" start="48" style="color: #ddad60">/</span><span class="axis" start="49" style="color: #566874">@</span><span class="qname" start="50" select="quick" style="color: #b05a65">type</span><span class="whitespace" start="54" style="color: #ddad60"> </span><span class="op" start="55" style="color: #ddad60">=</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="57" style="color: #585858">type-op</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="66" style="color: #295f94">)</span><span class="whitespace" start="67" style="color: #ddad60"> </span><span class="op" start="68" style="color: #ddad60">or</span><span class="whitespace" start="70" style="color: #ddad60"> </span><span class="parenthesis" start="71" pair-end="93" select="quick" style="color: #295f94">(</span><span class="variable" start="72" select="quick" style="color: #ad95af">$token</span><span class="step" start="78" style="color: #ddad60">/</span><span class="axis" start="79" style="color: #566874">@</span><span class="qname" start="80" select="quick" style="color: #b05a65">value</span><span class="whitespace" start="85" style="color: #ddad60"> </span><span class="op" start="86" style="color: #ddad60">eq</span><span class="whitespace" start="88" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="89" style="color: #585858">as</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="93" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="numeric" start="10" style="color: #566874">1</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">le</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="function" start="15" pair-end="28" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="21" select="quick" style="color: #ad95af">$tokens</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">qExpected</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                    </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$typeExpected</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">or</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="variable" start="18" select="quick" style="color: #ad95af">$token</span><span class="step" start="24" style="color: #ddad60">/</span><span class="axis" start="25" style="color: #566874">@</span><span class="qname" start="26" select="quick" style="color: #b05a65">value</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" start="32" style="color: #ddad60">=</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="34" style="color: #585858">)</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af"> 
      
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="96" select="quick" style="color: #885d3b">loc:rationalizeTokens</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="23" select="quick" style="color: #ad95af">$tokens</span><span class="op" start="30" style="color: #ddad60">,</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="variable" start="32" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="op" start="39" style="color: #ddad60">+</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="numeric" start="41" style="color: #566874">1</span><span class="op" start="42" style="color: #ddad60">,</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="variable" start="44" select="quick" style="color: #ad95af">$isNewClosed</span><span class="op" start="56" style="color: #ddad60">,</span><span class="whitespace" start="57" style="color: #ddad60">
                            </span><span class="variable" start="58" select="quick" style="color: #ad95af">$pbPairs</span><span class="op" start="66" style="color: #ddad60">,</span><span class="whitespace" start="67" style="color: #ddad60"> </span><span class="variable" start="68" select="quick" style="color: #ad95af">$newTypeExpected</span><span class="op" start="84" style="color: #ddad60">,</span><span class="whitespace" start="85" style="color: #ddad60"> </span><span class="variable" start="86" select="quick" style="color: #ad95af">$qExpected</span><span class="parenthesis" start="96" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">loc:createTokens</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">excludes</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">exclude</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$excludes</span><span class="filter" start="10" pair-end="17" select="quick" style="color: #295f94">[</span><span class="variable" start="11" select="quick" style="color: #ad95af">$index</span><span class="filter" start="17" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">end</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="20" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="19" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$exclude</span><span class="parenthesis" start="19" style="color: #295f94">)</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">then</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="parenthesis" start="27" pair-end="28" select="quick" style="color: #295f94">(</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="whitespace" start="29" style="color: #ddad60">
                          </span><span class="op" start="30" style="color: #ddad60">else</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="if" start="35" style="color: #ddad60">if</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="parenthesis" start="38" pair-end="52" select="quick" style="color: #295f94">(</span><span class="variable" start="39" select="quick" style="color: #ad95af">$exclude</span><span class="step" start="47" style="color: #ddad60">/</span><span class="axis" start="48" style="color: #566874">@</span><span class="qname" start="49" select="quick" style="color: #b05a65">end</span><span class="parenthesis" start="52" style="color: #295f94">)</span><span class="whitespace" start="53" style="color: #ddad60"> </span><span class="op" start="54" style="color: #ddad60">then</span><span class="whitespace" start="58" style="color: #ddad60"> 
                          </span><span class="variable" start="60" select="quick" style="color: #ad95af">$exclude</span><span class="step" start="68" style="color: #ddad60">/</span><span class="axis" start="69" style="color: #566874">@</span><span class="qname" start="70" select="quick" style="color: #b05a65">end</span><span class="whitespace" start="73" style="color: #ddad60"> </span><span class="type-op" start="74" style="color: #ddad60">cast as</span><span class="whitespace" start="81" style="color: #ddad60"> </span><span class="type-name" start="82" style="color: #b05a65">xs:integer</span><span class="whitespace" start="92" style="color: #ddad60"> </span><span class="op" start="93" style="color: #ddad60">+</span><span class="whitespace" start="94" style="color: #ddad60"> </span><span class="numeric" start="95" style="color: #566874">1</span><span class="whitespace" start="96" style="color: #ddad60">
                          </span><span class="op" start="97" style="color: #ddad60">else</span><span class="whitespace" start="101" style="color: #ddad60"> </span><span class="parenthesis" start="102" pair-end="103" select="quick" style="color: #295f94">(</span><span class="parenthesis" start="103" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">exStart</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="20" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="19" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$exclude</span><span class="parenthesis" start="19" style="color: #295f94">)</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">then</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="parenthesis" start="27" pair-end="28" select="quick" style="color: #295f94">(</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="whitespace" start="29" style="color: #ddad60">
                          </span><span class="op" start="30" style="color: #ddad60">else</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="variable" start="35" select="quick" style="color: #ad95af">$exclude</span><span class="step" start="43" style="color: #ddad60">/</span><span class="axis" start="44" style="color: #566874">@</span><span class="qname" start="45" select="quick" style="color: #b05a65">start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">part</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="15" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="7" select="quick" style="color: #ad95af">$exclude</span><span class="parenthesis" start="15" style="color: #295f94">)</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="op" start="17" style="color: #ddad60">and</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="variable" start="21" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="op" start="28" style="color: #ddad60">=</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="numeric" start="30" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="16" select="quick" style="color: #885d3b">exists</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$exStart</span><span class="parenthesis" start="16" style="color: #295f94">)</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" start="18" style="color: #ddad60">and</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="variable" start="22" select="quick" style="color: #ad95af">$exStart</span><span class="whitespace" start="30" style="color: #ddad60"> </span><span class="op" start="31" style="color: #ddad60">ge</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="variable" start="34" select="quick" style="color: #ad95af">$start</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="45" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$string</span><span class="op" start="18" style="color: #ddad60">,</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="variable" start="20" select="quick" style="color: #ad95af">$start</span><span class="op" start="26" style="color: #ddad60">,</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="variable" start="28" select="quick" style="color: #ad95af">$exStart</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="op" start="37" style="color: #ddad60">-</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="variable" start="39" select="quick" style="color: #ad95af">$start</span><span class="parenthesis" start="45" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="63" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$string</span><span class="op" start="18" style="color: #ddad60">,</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="variable" start="20" select="quick" style="color: #ad95af">$start</span><span class="op" start="26" style="color: #ddad60">,</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="function" start="28" pair-end="49" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="42" select="quick" style="color: #ad95af">$string</span><span class="parenthesis" start="49" style="color: #295f94">)</span><span class="whitespace" start="50" style="color: #ddad60"> </span><span class="op" start="51" style="color: #ddad60">+</span><span class="whitespace" start="52" style="color: #ddad60"> </span><span class="numeric" start="53" style="color: #566874">1</span><span class="whitespace" start="54" style="color: #ddad60"> </span><span class="op" start="55" style="color: #ddad60">-</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="variable" start="57" select="quick" style="color: #ad95af">$start</span><span class="parenthesis" start="63" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="20" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$part</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="whitespace" start="21" style="color: #ddad60"> </span><span class="op" start="22" style="color: #ddad60">gt</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="numeric" start="25" style="color: #566874">0</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                    </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="20" select="quick" style="color: #885d3b">loc:rawTokens</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="15" select="quick" style="color: #ad95af">$part</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> The XSLT that generates the tokens </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="37" select="quick" style="color: #885d3b">loc:processTokens</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="19" select="quick" style="color: #ad95af">$tokens</span><span class="op" start="26" style="color: #ddad60">,</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="variable" start="28" select="quick" style="color: #ad95af">$start</span><span class="op" start="34" style="color: #ddad60">,</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="numeric" start="36" style="color: #566874">1</span><span class="parenthesis" start="37" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="20" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="5" pair-end="19" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$exclude</span><span class="parenthesis" start="19" style="color: #295f94">)</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">token</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$exclude</span><span class="step" start="9" style="color: #ddad60">/</span><span class="axis" start="10" style="color: #566874">@</span><span class="qname" start="11" select="quick" style="color: #b05a65">start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$exclude</span><span class="step" start="9" style="color: #ddad60">/</span><span class="axis" start="10" style="color: #566874">@</span><span class="qname" start="11" select="quick" style="color: #b05a65">end</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">end</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$exclude</span><span class="step" start="9" style="color: #ddad60">/</span><span class="axis" start="10" style="color: #566874">@</span><span class="qname" start="11" select="quick" style="color: #b05a65">end</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">stringEnd</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="18" select="quick" style="color: #295f94">(</span><span class="variable" start="5" select="quick" style="color: #ad95af">$exclude</span><span class="step" start="13" style="color: #ddad60">/</span><span class="axis" start="14" style="color: #566874">@</span><span class="qname" start="15" select="quick" style="color: #b05a65">end</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="op" start="20" style="color: #ddad60">then</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="variable" start="25" select="quick" style="color: #ad95af">$exclude</span><span class="step" start="33" style="color: #ddad60">/</span><span class="axis" start="34" style="color: #566874">@</span><span class="qname" start="35" select="quick" style="color: #b05a65">end</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="op" start="39" style="color: #ddad60">else</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="function" start="44" pair-end="65" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="58" select="quick" style="color: #ad95af">$string</span><span class="parenthesis" start="65" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">value</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="69" select="quick" style="color: #885d3b">substring</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$string</span><span class="op" start="18" style="color: #ddad60">,</span><span class="whitespace" start="19" style="color: #ddad60"> </span><span class="variable" start="20" select="quick" style="color: #ad95af">$exclude</span><span class="step" start="28" style="color: #ddad60">/</span><span class="axis" start="29" style="color: #566874">@</span><span class="qname" start="30" select="quick" style="color: #b05a65">start</span><span class="op" start="35" style="color: #ddad60">,</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="variable" start="37" select="quick" style="color: #ad95af">$stringEnd</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="op" start="48" style="color: #ddad60">+</span><span class="whitespace" start="49" style="color: #ddad60"> </span><span class="numeric" start="50" style="color: #566874">1</span><span class="whitespace" start="51" style="color: #ddad60"> </span><span class="op" start="52" style="color: #ddad60">-</span><span class="whitespace" start="53" style="color: #ddad60"> </span><span class="variable" start="54" select="quick" style="color: #ad95af">$exclude</span><span class="step" start="62" style="color: #ddad60">/</span><span class="axis" start="63" style="color: #566874">@</span><span class="qname" start="64" select="quick" style="color: #b05a65">start</span><span class="parenthesis" start="69" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:attribute</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="14" select="quick" style="color: #885d3b">name</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="6" select="quick" style="color: #ad95af">$exclude</span><span class="parenthesis" start="14" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> iterate 1 pos beyond end of excludes length </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="5" pair-end="20" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$excludes</span><span class="parenthesis" start="20" style="color: #295f94">)</span><span class="parenthesis" start="21" style="color: #295f94">)</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" start="23" style="color: #ddad60">and</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="function" start="27" pair-end="42" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="31" pair-end="41" select="quick" style="color: #885d3b">empty</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="37" select="quick" style="color: #ad95af">$end</span><span class="parenthesis" start="41" style="color: #295f94">)</span><span class="parenthesis" start="42" style="color: #295f94">)</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="op" start="44" style="color: #ddad60">and</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="variable" start="48" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="54" style="color: #ddad60"> </span><span class="op" start="55" style="color: #ddad60">le</span><span class="whitespace" start="57" style="color: #ddad60"> </span><span class="function" start="58" pair-end="73" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="64" select="quick" style="color: #ad95af">$excludes</span><span class="parenthesis" start="73" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="54" select="quick" style="color: #885d3b">loc:createTokens</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$string</span><span class="op" start="25" style="color: #ddad60">,</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="variable" start="27" select="quick" style="color: #ad95af">$excludes</span><span class="op" start="36" style="color: #ddad60">,</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="variable" start="38" select="quick" style="color: #ad95af">$end</span><span class="op" start="42" style="color: #ddad60">,</span><span class="whitespace" start="43" style="color: #ddad60"> </span><span class="variable" start="44" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="50" style="color: #ddad60"> </span><span class="op" start="51" style="color: #ddad60">+</span><span class="whitespace" start="52" style="color: #ddad60"> </span><span class="numeric" start="53" style="color: #566874">1</span><span class="parenthesis" start="54" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">loc:processTokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">element()*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">token</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$tokens</span><span class="filter" start="8" pair-end="15" select="quick" style="color: #295f94">[</span><span class="variable" start="9" select="quick" style="color: #ad95af">$index</span><span class="filter" start="15" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">end</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                  </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$start</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="function" start="10" pair-end="30" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="24" select="quick" style="color: #ad95af">$token</span><span class="parenthesis" start="30" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:element</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">token</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">start</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$start</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">end</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$end</span><span class="whitespace" start="5" style="color: #ddad60"> </span><span class="op" start="6" style="color: #ddad60">-</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="numeric" start="8" style="color: #566874">1</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">value</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isSimpleOps</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">=</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="variable" start="10" select="quick" style="color: #ad95af">$simpleOps</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isSimpleOps</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" pair-end="23" style="color: #ddad60">if</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="4" select="quick" style="color: #ad95af">$token</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" start="11" style="color: #ddad60">=</span><span class="whitespace" start="12" style="color: #ddad60"> </span><span class="parenthesis" start="13" pair-end="22" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="14" style="color: #585858">/</span><span class="op" style="color: #ddad60">'</span><span class="op" start="17" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="18" style="color: #585858">//</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="parenthesis" start="23" style="color: #295f94">)</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="op" start="25" style="color: #ddad60">then</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="30" style="color: #585858">step</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="36" style="color: #ddad60"> </span><span class="op" start="37" style="color: #ddad60">else</span><span class="whitespace" start="41" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="42" style="color: #585858">op</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">isDoubleToken</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:boolean</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isSimpleOps</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="7" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="7" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">splitToken</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
                          </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="31" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="10" select="quick" style="color: #ad95af">$token</span><span class="op" start="16" style="color: #ddad60">,</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="18" style="color: #585858">[\s\p{Zs}]+</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="31" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf">
                </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" style="color: #ddad60">if</span><span class="whitespace" start="3" style="color: #ddad60"> </span><span class="parenthesis" start="4" pair-end="28" select="quick" style="color: #295f94">(</span><span class="function" start="5" pair-end="22" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$splitToken</span><span class="parenthesis" start="22" style="color: #295f94">)</span><span class="whitespace" start="23" style="color: #ddad60"> </span><span class="op" start="24" style="color: #ddad60">ne</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="numeric" start="27" style="color: #566874">2</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="whitespace" start="29" style="color: #ddad60"> </span><span class="op" start="30" style="color: #ddad60">then</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="function" start="35" pair-end="41" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="41" style="color: #295f94">)</span><span class="whitespace" start="42" style="color: #ddad60">
                        </span><span class="op" start="43" style="color: #ddad60">else</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="if" start="48" style="color: #ddad60">if</span><span class="whitespace" start="50" style="color: #ddad60"> </span><span class="parenthesis" start="51" pair-end="107" select="quick" style="color: #295f94">(</span><span class="variable" start="52" select="quick" style="color: #ad95af">$splitToken</span><span class="filter" start="63" pair-end="65" select="quick" style="color: #295f94">[</span><span class="numeric" start="64" style="color: #566874">1</span><span class="filter" start="65" style="color: #295f94">]</span><span class="whitespace" start="66" style="color: #ddad60"> </span><span class="op" start="67" style="color: #ddad60">eq</span><span class="whitespace" start="69" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="70" style="color: #585858">instance</span><span class="op" style="color: #ddad60">'</span><span class="whitespace" start="80" style="color: #ddad60"> </span><span class="op" start="81" style="color: #ddad60">and</span><span class="whitespace" start="84" style="color: #ddad60"> </span><span class="variable" start="85" select="quick" style="color: #ad95af">$splitToken</span><span class="filter" start="96" pair-end="98" select="quick" style="color: #295f94">[</span><span class="numeric" start="97" style="color: #566874">2</span><span class="filter" start="98" style="color: #295f94">]</span><span class="whitespace" start="99" style="color: #ddad60"> </span><span class="op" start="100" style="color: #ddad60">eq</span><span class="whitespace" start="102" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="103" style="color: #585858">of</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="107" style="color: #295f94">)</span><span class="whitespace" start="108" style="color: #ddad60"> 
                        </span><span class="op" start="110" style="color: #ddad60">then</span><span class="whitespace" start="114" style="color: #ddad60"> </span><span class="function" start="115" pair-end="120" select="quick" style="color: #885d3b">true</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="120" style="color: #295f94">)</span><span class="whitespace" start="121" style="color: #ddad60">
                        </span><span class="op" start="122" style="color: #ddad60">else</span><span class="whitespace" start="126" style="color: #ddad60"> </span><span class="if" start="127" style="color: #ddad60">if</span><span class="whitespace" start="129" style="color: #ddad60"> </span><span class="parenthesis" start="130" pair-end="202" select="quick" style="color: #295f94">(</span><span class="variable" start="131" select="quick" style="color: #ad95af">$splitToken</span><span class="filter" start="142" pair-end="144" select="quick" style="color: #295f94">[</span><span class="numeric" start="143" style="color: #566874">1</span><span class="filter" start="144" style="color: #295f94">]</span><span class="whitespace" start="145" style="color: #ddad60"> </span><span class="op" start="146" style="color: #ddad60">=</span><span class="whitespace" start="147" style="color: #ddad60"> </span><span class="parenthesis" start="148" pair-end="174" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="149" style="color: #585858">cast</span><span class="op" style="color: #ddad60">'</span><span class="op" start="155" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="156" style="color: #585858">castable</span><span class="op" style="color: #ddad60">'</span><span class="op" start="166" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="167" style="color: #585858">treat</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="174" style="color: #295f94">)</span><span class="whitespace" start="175" style="color: #ddad60"> </span><span class="op" start="176" style="color: #ddad60">and</span><span class="whitespace" start="179" style="color: #ddad60"> </span><span class="variable" start="180" select="quick" style="color: #ad95af">$splitToken</span><span class="filter" start="191" pair-end="193" select="quick" style="color: #295f94">[</span><span class="numeric" start="192" style="color: #566874">2</span><span class="filter" start="193" style="color: #295f94">]</span><span class="whitespace" start="194" style="color: #ddad60"> </span><span class="op" start="195" style="color: #ddad60">eq</span><span class="whitespace" start="197" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="198" style="color: #585858">as</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="202" style="color: #295f94">)</span><span class="whitespace" start="203" style="color: #ddad60">
                        </span><span class="op" start="204" style="color: #ddad60">then</span><span class="whitespace" start="208" style="color: #ddad60"> </span><span class="function" start="209" pair-end="214" select="quick" style="color: #885d3b">true</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="214" style="color: #295f94">)</span><span class="whitespace" start="215" style="color: #ddad60"> </span><span class="op" start="216" style="color: #ddad60">else</span><span class="whitespace" start="220" style="color: #ddad60"> </span><span class="function" start="221" pair-end="227" select="quick" style="color: #885d3b">false</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="227" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isDoubleToken</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">type-op</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">functionType</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isSimpleOps</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" start="14" style="color: #ddad60">or</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="variable" start="17" select="quick" style="color: #ad95af">$isDoubleToken</span><span class="whitespace" start="31" style="color: #ddad60"> </span><span class="op" start="32" style="color: #ddad60">or</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="function" start="35" pair-end="55" select="quick" style="color: #885d3b">string-length</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="49" select="quick" style="color: #ad95af">$token</span><span class="parenthesis" start="55" style="color: #295f94">)</span><span class="whitespace" start="56" style="color: #ddad60"> </span><span class="op" start="57" style="color: #ddad60">=</span><span class="whitespace" start="58" style="color: #ddad60"> </span><span class="numeric" start="59" style="color: #566874">1</span><span class="whitespace" start="60" style="color: #ddad60"> </span><span class="op" start="61" style="color: #ddad60">or</span><span class="whitespace" start="63" style="color: #ddad60"> </span><span class="function" start="64" pair-end="89" select="quick" style="color: #885d3b">not</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="68" pair-end="88" select="quick" style="color: #885d3b">ends-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="78" select="quick" style="color: #ad95af">$token</span><span class="op" start="84" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="85" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="88" style="color: #295f94">)</span><span class="parenthesis" start="89" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:text</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:text</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:variable</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">fnName</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="34" select="quick" style="color: #885d3b">tokenize</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="10" select="quick" style="color: #ad95af">$token</span><span class="op" start="16" style="color: #ddad60">,</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="18" style="color: #585858">[\s\p{Zs}]+|\(</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="34" style="color: #295f94">)</span><span class="filter" start="35" pair-end="37" select="quick" style="color: #295f94">[</span><span class="numeric" start="36" style="color: #566874">1</span><span class="filter" start="37" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$fnName</span><span class="whitespace" start="8" style="color: #ddad60"> </span><span class="op" start="9" style="color: #ddad60">=</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">if</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:text</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">if</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:text</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="higher" start="1" style="color: #ddad60">some</span><span class="whitespace" start="5" style="color: #ddad60"> </span><span id="rng-$n" class="variable" start="6" select="quick" style="color: #ad95af">$n</span><span class="whitespace" start="8" style="color: #ddad60"> </span><span class="op" start="9" style="color: #ddad60">in</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="variable" start="12" select="quick" style="color: #ad95af">$nodeTests</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" start="23" style="color: #ddad60">satisfies</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="variable" start="33" select="quick" style="color: #ad95af">$n</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="op" start="36" style="color: #ddad60">=</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="variable" start="38" select="quick" style="color: #ad95af">$fnName</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:text</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">node</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:text</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="higher" start="1" style="color: #ddad60">some</span><span class="whitespace" start="5" style="color: #ddad60"> </span><span id="rng-$x" class="variable" start="6" select="quick" style="color: #ad95af">$x</span><span class="whitespace" start="8" style="color: #ddad60"> </span><span class="op" start="9" style="color: #ddad60">in</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="variable" start="12" select="quick" style="color: #ad95af">$typeTests</span><span class="whitespace" start="22" style="color: #ddad60"> </span><span class="op" start="23" style="color: #ddad60">satisfies</span><span class="whitespace" start="32" style="color: #ddad60"> </span><span class="variable" start="33" select="quick" style="color: #ad95af">$x</span><span class="whitespace" start="35" style="color: #ddad60"> </span><span class="op" start="36" style="color: #ddad60">=</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="variable" start="38" select="quick" style="color: #ad95af">$fnName</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:text</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">type</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:text</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
                </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:text</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">function</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:text</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
              </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:variable</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="25" select="quick" style="color: #885d3b">starts-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="13" select="quick" style="color: #ad95af">$token</span><span class="op" start="19" style="color: #ddad60">,</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="21" style="color: #585858">Q{</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="25" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">bracedq</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$isSimpleOps</span><span class="whitespace" start="13" style="color: #ddad60"> </span><span class="op" start="14" style="color: #ddad60">or</span><span class="whitespace" start="16" style="color: #ddad60"> </span><span class="variable" start="17" select="quick" style="color: #ad95af">$isDoubleToken</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$functionType</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="op" start="15" style="color: #ddad60">ne</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="18" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$functionType</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="23" select="quick" style="color: #885d3b">ends-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="11" select="quick" style="color: #ad95af">$token</span><span class="op" start="17" style="color: #ddad60">,</span><span class="whitespace" start="18" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="19" style="color: #585858">::</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="23" style="color: #295f94">)</span><span class="whitespace" start="24" style="color: #ddad60"> </span><span class="op" start="25" style="color: #ddad60">or</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="variable" start="28" select="quick" style="color: #ad95af">$token</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" start="35" style="color: #ddad60">eq</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="38" style="color: #585858">@</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">axis</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="29" select="quick" style="color: #885d3b">matches</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="9" select="quick" style="color: #ad95af">$token</span><span class="op" start="15" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="16" style="color: #585858">[\s\p{Zs}]+</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="29" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">whitespace</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">=</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="parenthesis" start="10" pair-end="19" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">.</span><span class="op" style="color: #ddad60">'</span><span class="op" start="14" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">..</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="19" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">context</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">=</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="parenthesis" start="10" pair-end="18" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="op" start="14" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">)</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">parenthesis</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">=</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="parenthesis" start="10" pair-end="18" select="quick" style="color: #295f94">(</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">[</span><span class="op" style="color: #ddad60">'</span><span class="op" start="14" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="15" style="color: #585858">]</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="18" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">filter</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="14" select="quick" style="color: #885d3b">number</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="8" select="quick" style="color: #ad95af">$token</span><span class="parenthesis" start="14" style="color: #295f94">)</span><span class="whitespace" start="15" style="color: #ddad60"> </span><span class="op" start="16" style="color: #ddad60">=</span><span class="whitespace" start="17" style="color: #ddad60"> </span><span class="function" start="18" pair-end="31" select="quick" style="color: #885d3b">number</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="25" select="quick" style="color: #ad95af">$token</span><span class="parenthesis" start="31" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">numeric</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">=</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="variable" start="10" select="quick" style="color: #ad95af">$ambiguousOps</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">probableOp</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">=</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="variable" start="10" select="quick" style="color: #ad95af">$higherOps</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="51" select="quick" style="color: #885d3b">starts-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="13" pair-end="45" select="quick" style="color: #885d3b">loc:nextNonWhite</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="30" select="quick" style="color: #ad95af">$tokens</span><span class="op" start="37" style="color: #ddad60">,</span><span class="whitespace" start="38" style="color: #ddad60"> </span><span class="variable" start="39" select="quick" style="color: #ad95af">$index</span><span class="parenthesis" start="45" style="color: #295f94">)</span><span class="op" start="46" style="color: #ddad60">,</span><span class="whitespace" start="47" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="48" style="color: #585858">$</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="51" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">higher</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$token</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">eq</span><span class="whitespace" start="10" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="11" style="color: #585858">if</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="33" select="quick" style="color: #885d3b">loc:nextNonWhite</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="18" select="quick" style="color: #ad95af">$tokens</span><span class="op" start="25" style="color: #ddad60">,</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="variable" start="27" select="quick" style="color: #ad95af">$index</span><span class="parenthesis" start="33" style="color: #295f94">)</span><span class="whitespace" start="34" style="color: #ddad60"> </span><span class="op" start="35" style="color: #ddad60">eq</span><span class="whitespace" start="37" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="38" style="color: #585858">(</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
            </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">if</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="24" select="quick" style="color: #885d3b">starts-with</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="13" select="quick" style="color: #ad95af">$token</span><span class="op" start="19" style="color: #ddad60">,</span><span class="whitespace" start="20" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="21" style="color: #585858">$</span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="24" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
          </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:attribute</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">type</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="1" style="color: #585858">variable</span><span class="op" style="color: #ddad60">'</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:element</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:if</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="7" style="color: #ddad60"> </span><span class="op" start="8" style="color: #ddad60">+</span><span class="whitespace" start="9" style="color: #ddad60"> </span><span class="numeric" start="10" style="color: #566874">1</span><span class="whitespace" start="11" style="color: #ddad60"> </span><span class="op" start="12" style="color: #ddad60">le</span><span class="whitespace" start="14" style="color: #ddad60"> </span><span class="function" start="15" pair-end="28" select="quick" style="color: #885d3b">count</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="21" select="quick" style="color: #ad95af">$tokens</span><span class="parenthesis" start="28" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:sequence</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="44" select="quick" style="color: #885d3b">loc:processTokens</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="19" select="quick" style="color: #ad95af">$tokens</span><span class="op" start="26" style="color: #ddad60">,</span><span class="whitespace" start="27" style="color: #ddad60"> </span><span class="variable" start="28" select="quick" style="color: #ad95af">$end</span><span class="op" start="32" style="color: #ddad60">,</span><span class="whitespace" start="33" style="color: #ddad60"> </span><span class="variable" start="34" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="40" style="color: #ddad60"> </span><span class="op" start="41" style="color: #ddad60">+</span><span class="whitespace" start="42" style="color: #ddad60"> </span><span class="numeric" start="43" style="color: #566874">1</span><span class="parenthesis" start="44" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:if</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">loc:nextNonWhite</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string?</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">tokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">index</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:integer</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:choose</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:when</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">test</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="6" select="quick" style="color: #885d3b">true</span><span class="parenthesis" style="color: #295f94">(</span><span class="parenthesis" start="6" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="z" style="color: #afbfcf">&lt;!--</span><span class="cm" style="color: #55aa55"> test="$index + 2 lt count($tokens)"&gt;  </span><span class="z" style="color: #afbfcf">--&gt;</span><span class="txt" style="color: #ad95af"> 
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="if" start="1" pair-end="55" style="color: #ddad60">if</span><span class="parenthesis" style="color: #295f94">(</span><span class="function" start="4" pair-end="48" select="quick" style="color: #885d3b">replace</span><span class="parenthesis" style="color: #295f94">(</span><span class="variable" start="12" select="quick" style="color: #ad95af">$tokens</span><span class="filter" start="19" pair-end="30" select="quick" style="color: #295f94">[</span><span class="variable" start="20" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="26" style="color: #ddad60"> </span><span class="op" start="27" style="color: #ddad60">+</span><span class="whitespace" start="28" style="color: #ddad60"> </span><span class="numeric" start="29" style="color: #566874">1</span><span class="filter" start="30" style="color: #295f94">]</span><span class="op" start="31" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="32" style="color: #585858">[\s\p{Zs}]+</span><span class="op" style="color: #ddad60">'</span><span class="op" start="45" style="color: #ddad60">,</span><span class="op" style="color: #ddad60">'</span><span class="literal" start="46" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="48" style="color: #295f94">)</span><span class="whitespace" start="49" style="color: #ddad60"> </span><span class="op" start="50" style="color: #ddad60">eq</span><span class="whitespace" start="52" style="color: #ddad60"> </span><span class="op" style="color: #ddad60">'</span><span class="literal" start="53" style="color: #585858"></span><span class="op" style="color: #ddad60">'</span><span class="parenthesis" start="55" style="color: #295f94">)</span><span class="whitespace" start="56" style="color: #ddad60">
                              </span><span class="op" start="57" style="color: #ddad60">then</span><span class="whitespace" start="61" style="color: #ddad60"> </span><span class="variable" start="62" select="quick" style="color: #ad95af">$tokens</span><span class="filter" start="69" pair-end="80" select="quick" style="color: #295f94">[</span><span class="variable" start="70" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="76" style="color: #ddad60"> </span><span class="op" start="77" style="color: #ddad60">+</span><span class="whitespace" start="78" style="color: #ddad60"> </span><span class="numeric" start="79" style="color: #566874">2</span><span class="filter" start="80" style="color: #295f94">]</span><span class="whitespace" start="81" style="color: #ddad60"> </span><span class="op" start="82" style="color: #ddad60">else</span><span class="whitespace" start="86" style="color: #ddad60"> </span><span class="variable" start="87" select="quick" style="color: #ad95af">$tokens</span><span class="filter" start="94" pair-end="105" select="quick" style="color: #295f94">[</span><span class="variable" start="95" select="quick" style="color: #ad95af">$index</span><span class="whitespace" start="101" style="color: #ddad60"> </span><span class="op" start="102" style="color: #ddad60">+</span><span class="whitespace" start="103" style="color: #ddad60"> </span><span class="numeric" start="104" style="color: #566874">1</span><span class="filter" start="105" style="color: #295f94">]</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:when</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:otherwise</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af"></span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:otherwise</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:choose</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
  </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:function</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="fname" style="color: #ab2525">loc:rawTokens</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string*</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:param</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">name</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="vname" style="color: #ad95af">chunk</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">as</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">xs:string</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:analyze-string</span><span class="z" style="color: #afbfcf">
        </span><span class="atn" style="color: #566874">regex</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="av" style="color: #55aa55">(((-)?\d+)(\.)?(\d+([eE][\+\-]?)?\d*)?)|(\?)|(Q\{{[^\{{\}}]*\}})|(instance[\s\p{{Zs}}]+of)|(cast[\s\p{{Zs}}]+as)|(:=)|(\|\|)|(castable[\s\p{{Zs}}]+as)|(treat[\s\p{{Zs}}]+as)|((\$[\s\p{{Zs}}]*)?[\i\*][\p{{L}}\p{{Nd}}\.\-]*(:[\p{{L}}\p{{Nd}}\.\-\*]*)?(::)?:?(#\d+)?)(\()?|(\.\.)|((-)?\d?\.\d*)|-|([&amp;lt;&amp;gt;!]=)|(&amp;gt;&amp;gt;|&amp;lt;&amp;lt;)|(//)|([\s\p{{Zs}}]+)|(\C)</span><span class="z" style="color: #afbfcf">"</span><span class="z" style="color: #afbfcf">
        </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="variable" start="1" select="quick" style="color: #ad95af">$chunk</span><span class="z" style="color: #afbfcf">"</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:matching-substring</span><span class="scx" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
        </span><span class="es" style="color: #afbfcf">&lt;</span><span class="enxsl" style="color: #295f94">xsl:value-of</span><span class="z" style="color: #afbfcf"> </span><span class="atn" style="color: #566874">select</span><span class="atneq" style="color: #afbfcf">=</span><span class="z" style="color: #afbfcf">"</span><span class="function" start="1" pair-end="9" select="quick" style="color: #885d3b">string</span><span class="parenthesis" style="color: #295f94">(</span><span class="context" start="8" style="color: #566874">.</span><span class="parenthesis" start="9" style="color: #295f94">)</span><span class="z" style="color: #afbfcf">"</span><span class="sc" style="color: #afbfcf">/&gt;</span><span class="txt" style="color: #ad95af">
      </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:matching-substring</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
    </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:analyze-string</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  </span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:function</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
  
</span><span class="ez" style="color: #afbfcf">&lt;/</span><span class="clxsl" style="color: #295f94">xsl:stylesheet</span><span class="ec" style="color: #afbfcf">&gt;</span><span class="txt" style="color: #ad95af">
</span></pre></div></body></html>