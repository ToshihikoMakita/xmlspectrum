<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>4-normalize.xsl</title><link rel="stylesheet" type="text/css" href="../../../theme.css"></head><body><div><p class="spectrum"><span class="ww" id="w1"><span class="es">&lt;</span><span class="enxsl">xsl:stylesheet</span><span class="z"> </span><span class="atn">xmlns:xsl</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/1999/XSL/Transform</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:db</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:doc</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://nwalsh.com/xsl/documentation/1.0</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:f</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/extension</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:ghost</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook/ephemeral</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:m</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/mode</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:mp</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/mode/private</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:n</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/xslt/ns/normalize</span><span class="z">"</span><span class="z">
                                </span><span class="atn">xmlns:xs</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://www.w3.org/2001/XMLSchema</span><span class="z">"</span><span class="z">
                		</span><span class="atn">exclude-result-prefixes</span><span class="atneq">=</span><span class="z">"</span><span class="av">db doc f ghost m mp n xs</span><span class="z">"</span><span class="z">
                                </span><span class="atn">version</span><span class="atneq">=</span><span class="z">"</span><span class="av">2.0</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
</span><span class="z">&lt;!--</span><span class="cm"> needed for standalone processing...not sure what to do about that
&lt;xsl:import href="../common/l10n.xsl"/&gt;
</span><span class="z">--&gt;</span><span class="txt">

</span><span class="ww" id="w75"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?l10n.gentext.default.language">l10n.gentext.default.language</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">en</span><span class="op">'</span><span class="z">"</span><span id="wx91" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w93"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?l10n.gentext.language">l10n.gentext.language</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx109" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w111"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?l10n.gentext.use.xref.language">l10n.gentext.use.xref.language</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="numeric" start="1">0</span><span class="z">"</span><span id="wx125" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w127"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?l10n.locale.dir">l10n.locale.dir</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">locales/</span><span class="ez">&lt;/</span><span class="clxsl">xsl:param</span><span id="wx139" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w141"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?glossary.collection">glossary.collection</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx157" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w159"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?bibliography.collection">bibliography.collection</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1"></span><span class="op">'</span><span class="z">"</span><span id="wx175" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ww" id="w177"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?docbook-namespace">docbook-namespace</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">http://docbook.org/ns/docbook</span><span class="op">'</span><span class="z">"</span><span id="wx193" class="sc">/&gt;</span></span><span class="txt">

</span><span class="ww" id="w195"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w205"><span class="es">&lt;</span><span class="enxsl">xsl:sequence</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/preprocess/4-normalize.xsl.html#f?{http://docbook.org/xslt/ns/extension}normalize" class="solar"><span class="function" start="1" pair-end="14" select="quick">f:normalize</span></a><span class="parenthesis">(</span><span class="step" start="13">/</span><span class="parenthesis" start="14">)</span><span class="z">"</span><span id="wx216" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx220" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w222"><span class="es">&lt;</span><span class="enxsl">xsl:function</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="fname" id="f?{http://docbook.org/xslt/ns/extension}normalize">f:normalize</span><span class="z">"</span><span class="z"> </span><span class="atn">as</span><span class="atneq">=</span><span class="z">"</span><span class="av">document-node()</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w238"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?root">root</span><span class="z">"</span><span class="z"> </span><span class="atn">as</span><span class="atneq">=</span><span class="z">"</span><span class="av">document-node()</span><span class="z">"</span><span id="wx252" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ww" id="w254"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$root</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx268" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:function</span><span id="wx272" class="ec">&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> ============================================================ </span><span class="z">--&gt;</span><span class="txt">
</span><span class="z">&lt;!--</span><span class="cm"> normalize content </span><span class="z">--&gt;</span><span class="txt">

</span><span class="ww" id="w282"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?external.glossary">external.glossary</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w292"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w296"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/html/param.xsl.html#v?glossary.collection" class="solar"><span class="variable" start="1" select="quick">$glossary.collection</span></a><span class="whitespace" start="21"> </span><span class="op" start="22">=</span><span class="whitespace" start="23"> </span><span class="op">'</span><span class="literal" start="24"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w312"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="parenthesis" start="1" pair-end="2" select="quick">(</span><span class="parenthesis" start="2">)</span><span class="z">"</span><span id="wx321" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx325" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ww" id="w327"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w331"><span class="es">&lt;</span><span class="enxsl">xsl:sequence</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-document" class="solar"><span class="function" start="1" pair-end="32" select="quick">document</span></a><span class="parenthesis">(</span><a href="xslt/base/html/param.xsl.html#v?glossary.collection" class="solar"><span class="variable" start="10" select="quick">$glossary.collection</span></a><span class="op" start="30">,</span><span class="context" start="31">.</span><span class="parenthesis" start="32">)</span><span class="z">"</span><span id="wx344" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx348" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx352" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx356" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w358"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?external.bibliography">external.bibliography</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w368"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w372"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/html/param.xsl.html#v?bibliography.collection" class="solar"><span class="variable" start="1" select="quick">$bibliography.collection</span></a><span class="whitespace" start="25"> </span><span class="op" start="26">=</span><span class="whitespace" start="27"> </span><span class="op">'</span><span class="literal" start="28"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w388"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="parenthesis" start="1" pair-end="2" select="quick">(</span><span class="parenthesis" start="2">)</span><span class="z">"</span><span id="wx397" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx401" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ww" id="w403"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w407"><span class="es">&lt;</span><span class="enxsl">xsl:sequence</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-document" class="solar"><span class="function" start="1" pair-end="36" select="quick">document</span></a><span class="parenthesis">(</span><a href="xslt/base/html/param.xsl.html#v?bibliography.collection" class="solar"><span class="variable" start="10" select="quick">$bibliography.collection</span></a><span class="op" start="34">,</span><span class="context" start="35">.</span><span class="parenthesis" start="36">)</span><span class="z">"</span><span id="wx420" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx424" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx428" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx432" class="ec">&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> ============================================================ </span><span class="z">--&gt;</span><span class="txt">

</span><span class="ww" id="w438"><span class="es">&lt;</span><span class="en">doc:mode</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="z"> </span><span class="atn">xmlns</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w454"><span class="es">&lt;</span><span class="en">refpurpose</span><span class="scx">&gt;</span><span class="txt">Mode for normalizing a DocBook document</span><span class="ez">&lt;/</span><span class="cl">refpurpose</span><span id="wx460" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w462"><span class="es">&lt;</span><span class="en">refdescription</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w466"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">This mode is used to normalize an input document. Normalization
moves all </span><span class="ww" id="w470"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">title</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx476" class="ec">&gt;</span></span><span class="txt">, </span><span class="ww" id="w478"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">subtitle</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx484" class="ec">&gt;</span></span><span class="txt">, and
</span><span class="ww" id="w486"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">titleabbrev</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx492" class="ec">&gt;</span></span><span class="txt"> elements inside </span><span class="ww" id="w494"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">info</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx500" class="ec">&gt;</span></span><span class="txt"> wrappers,
creating the wrapper if necessary.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx504" class="ec">&gt;</span></span><span class="txt">
</span><span class="ww" id="w506"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">If the element being normalized has a default title (e.g.,
</span><span class="ww" id="w510"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">bibligraphy</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx516" class="ec">&gt;</span></span><span class="txt"> and </span><span class="ww" id="w518"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">glossary</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx524" class="ec">&gt;</span></span><span class="txt">), the title is made
explicit during normalization.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx528" class="ec">&gt;</span></span><span class="txt">
</span><span class="ww" id="w530"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">External glossaries and bibliographies (not yet!) are also
copied by normalization.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx536" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">refdescription</span><span id="wx540" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">doc:mode</span><span id="wx544" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w546"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">/</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w562"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w566"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx574" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx578" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx582" class="ec">&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> ============================================================ </span><span class="z">--&gt;</span><span class="txt">

</span><span class="ww" id="w588"><span class="es">&lt;</span><span class="en">doc:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">n:normalize-movetitle</span><span class="z">"</span><span class="z"> </span><span class="atn">xmlns</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w604"><span class="es">&lt;</span><span class="en">refpurpose</span><span class="scx">&gt;</span><span class="txt">Moves titles inside </span><span class="ww" id="w608"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">info</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx614" class="ec">&gt;</span></span><span class="txt"></span><span class="ez">&lt;/</span><span class="cl">refpurpose</span><span id="wx618" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w620"><span class="es">&lt;</span><span class="en">refdescription</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w624"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">This template moves </span><span class="ww" id="w628"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">title</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx634" class="ec">&gt;</span></span><span class="txt">, </span><span class="ww" id="w636"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">subtitle</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx642" class="ec">&gt;</span></span><span class="txt">, and
</span><span class="ww" id="w644"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">titleabbrev</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx650" class="ec">&gt;</span></span><span class="txt"> elements inside an </span><span class="ww" id="w652"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">info</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx658" class="ec">&gt;</span></span><span class="txt">.
</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx662" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">refdescription</span><span id="wx666" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w668"><span class="es">&lt;</span><span class="en">refreturn</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w672"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">The transformed node.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx678" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">refreturn</span><span id="wx682" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">doc:template</span><span id="wx686" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w688"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/normalize}normalize-movetitle">n:normalize-movetitle</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w698"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w702"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx711" class="sc">/&gt;</span></span><span class="txt">

    </span><span class="ww" id="w713"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w717"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:info</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	</span><span class="ww" id="w727"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx735" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx739" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ww" id="w741"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:title</span><span class="op" start="9">|</span><span class="qname" start="10" select="quick">db:subtitle</span><span class="op" start="21">|</span><span class="qname" start="22" select="quick">db:titleabbrev</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	</span><span class="ww" id="w755"><span class="es">&lt;</span><span class="enxsl">xsl:element</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">info</span><span class="z">"</span><span class="z"> </span><span class="atn">namespace</span><span class="atneq">=</span><span class="z">"</span><span class="op">{</span><a href="xslt/base/html/param.xsl.html#v?docbook-namespace" class="solar"><span class="variable" start="1" select="quick">$docbook-namespace</span></a><span class="op">}</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	  </span><span class="ww" id="w773"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-dbinfo" class="solar"><span class="tcall">n:normalize-dbinfo</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	    </span><span class="ww" id="w783"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">copynodes</span><span class="z">"</span><span class="z">
                			    </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:title</span><span class="op" start="9">|</span><span class="qname" start="10" select="quick">db:subtitle</span><span class="op" start="21">|</span><span class="qname" start="22" select="quick">db:titleabbrev</span><span class="z">"</span><span id="wx801" class="sc">/&gt;</span></span><span class="txt">
	  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx805" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ez">&lt;/</span><span class="clxsl">xsl:element</span><span id="wx809" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ww" id="w811"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx819" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx823" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ww" id="w825"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
	</span><span class="ww" id="w829"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx837" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx841" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx845" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx849" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx853" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w855"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:title</span><span class="op" start="9">|</span><span class="qname" start="10" select="quick">db:subtitle</span><span class="op" start="21">|</span><span class="qname" start="22" select="quick">db:titleabbrev</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w875"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">parent::</span><span class="qname" start="9" select="quick">db:info</span><span class="whitespace" start="16">
                              </span><span class="op" start="33">|</span><span class="axis" start="34">parent::</span><span class="qname" start="42" select="quick">db:biblioentry</span><span class="whitespace" start="56">
                              </span><span class="op" start="73">|</span><span class="axis" start="74">parent::</span><span class="qname" start="82" select="quick">db:bibliomixed</span><span class="whitespace" start="96">
                              </span><span class="op" start="113">|</span><span class="axis" start="114">parent::</span><span class="qname" start="122" select="quick">db:bibliomset</span><span class="whitespace" start="135">
                              </span><span class="op" start="152">|</span><span class="axis" start="153">parent::</span><span class="qname" start="161" select="quick">db:biblioset</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w902"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w906"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx915" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ww" id="w917"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx925" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx929" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx933" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx937" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w939"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:bibliography</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w955"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title" class="solar"><span class="tcall">n:normalize-generated-title</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w965"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx982" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx986" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx990" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w992"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:bibliomixed</span><span class="op" start="15">|</span><span class="qname" start="16" select="quick">db:biblioentry</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w1010"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w1014"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="1" pair-end="11" select="quick">not</span></a><span class="parenthesis">(</span><span class="node" start="5" pair-end="10" select="quick">node</span><span class="parenthesis">(</span><span class="parenthesis" start="10">)</span><span class="parenthesis" start="11">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt"> </span><span class="z">&lt;!--</span><span class="cm"> totally empty </span><span class="z">--&gt;</span><span class="txt">
      </span><span class="ww" id="w1033"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?id">id</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="parenthesis" start="1" pair-end="13" select="quick">(</span><span class="axis" start="2">@</span><span class="qname" start="3" select="quick">id</span><span class="op" start="5">|</span><span class="axis" start="6">@</span><span class="qname" start="7" select="quick">xml:id</span><span class="parenthesis" start="13">)</span><span class="filter" start="14" pair-end="16" select="quick">[</span><span class="numeric" start="15">1</span><span class="filter" start="16">]</span><span class="z">"</span><span id="wx1056" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ww" id="w1058"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
	</span><span class="ww" id="w1062"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="1" pair-end="8" select="quick">not</span></a><span class="parenthesis">(</span><span class="variable" start="5" select="quick">$id</span><span class="parenthesis" start="8">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	  </span><span class="ww" id="w1075"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
	    </span><span class="ww" id="w1079"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Error: </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1085" class="ec">&gt;</span></span><span class="txt">
	    </span><span class="ww" id="w1087"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">empty </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1093" class="ec">&gt;</span></span><span class="txt">
	    </span><span class="ww" id="w1095"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx1106" class="sc">/&gt;</span></span><span class="txt">
	    </span><span class="ww" id="w1108"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt"> with no id.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1114" class="ec">&gt;</span></span><span class="txt">
	  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1118" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1122" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ww" id="w1124"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#v?external.bibliography" class="solar"><span class="variable" start="1" select="quick">$external.bibliography</span></a><span class="step" start="23">/</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="24" pair-end="37" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="28">id</span><span class="op">'</span><span class="op" start="32">,</span><span class="whitespace" start="33"> </span><span class="variable" start="34" select="quick">$id</span><span class="parenthesis" start="37">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	  </span><span class="ww" id="w1144"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#v?external.bibliography" class="solar"><span class="variable" start="1" select="quick">$external.bibliography</span></a><span class="step" start="23">/</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="24" pair-end="37" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="28">id</span><span class="op">'</span><span class="op" start="32">,</span><span class="whitespace" start="33"> </span><span class="variable" start="34" select="quick">$id</span><span class="parenthesis" start="37">)</span><span class="z">"</span><span class="z">
                     			       </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx1168" class="sc">/&gt;</span></span><span class="txt">
	</span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1172" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ww" id="w1174"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
	  </span><span class="ww" id="w1178"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
	    </span><span class="ww" id="w1182"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Error: </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1188" class="ec">&gt;</span></span><span class="txt">
	    </span><span class="ww" id="w1190"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">$bibliography.collection doesn't contain </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1196" class="ec">&gt;</span></span><span class="txt">
	    </span><span class="ww" id="w1198"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$id</span><span class="z">"</span><span id="wx1206" class="sc">/&gt;</span></span><span class="txt">
	  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1210" class="ec">&gt;</span></span><span class="txt">
	  </span><span class="ww" id="w1212"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
	    </span><span class="ww" id="w1216"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx1225" class="sc">/&gt;</span></span><span class="txt">
	    </span><span class="ww" id="w1227"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">???</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1233" class="ec">&gt;</span></span><span class="txt">
	  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx1237" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx1241" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx1245" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1249" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ww" id="w1251"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w1255"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
	</span><span class="ww" id="w1259"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx1268" class="sc">/&gt;</span></span><span class="txt">
	</span><span class="ww" id="w1270"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx1278" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx1282" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx1286" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx1290" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx1294" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w1296"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:glossary</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w1312"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?glossary">glossary</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w1322"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title" class="solar"><span class="tcall">n:normalize-generated-title</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w1332"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx1349" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx1353" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx1357" class="ec">&gt;</span></span><span class="txt">

  </span><span class="ww" id="w1359"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w1363"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$glossary</span><span class="step" start="10">/</span><span class="qname" start="11" select="quick">db:glossary</span><span class="filter" start="22" pair-end="35" select="quick">[</span><span class="axis" start="23">@</span><span class="qname" start="24" select="quick">role</span><span class="op" start="28">=</span><span class="op">'</span><span class="literal" start="29">auto</span><span class="op">'</span><span class="filter" start="35">]</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w1383"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="1" pair-end="23" select="quick">not</span></a><span class="parenthesis">(</span><a href="xslt/base/common/normalize.xsl.html#v?external.glossary" class="solar"><span class="variable" start="5" select="quick">$external.glossary</span></a><span class="parenthesis" start="23">)</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	</span><span class="ww" id="w1396"><span class="es">&lt;</span><span class="enxsl">xsl:message</span><span class="scx">&gt;</span><span class="txt">
	  </span><span class="ww" id="w1400"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">Warning: processing automatic glossary </span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1406" class="ec">&gt;</span></span><span class="txt">
	  </span><span class="ww" id="w1408"><span class="es">&lt;</span><span class="enxsl">xsl:text</span><span class="scx">&gt;</span><span class="txt">without an external glossary.</span><span class="ez">&lt;/</span><span class="clxsl">xsl:text</span><span id="wx1414" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ez">&lt;/</span><span class="clxsl">xsl:message</span><span id="wx1418" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1422" class="ec">&gt;</span></span><span class="txt">

      </span><span class="ww" id="w1424"><span class="es">&lt;</span><span class="enxsl">xsl:element</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">glossary</span><span class="z">"</span><span class="z"> </span><span class="atn">namespace</span><span class="atneq">=</span><span class="z">"</span><span class="op">{</span><a href="xslt/base/html/param.xsl.html#v?docbook-namespace" class="solar"><span class="variable" start="1" select="quick">$docbook-namespace</span></a><span class="op">}</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	</span><span class="ww" id="w1442"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$glossary</span><span class="step" start="10">/</span><span class="qname" start="11" select="quick">db:glossary</span><span class="step" start="22">/</span><span class="axis" start="23">@</span><span class="qname" start="24" select="quick">*</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	  </span><span class="ww" id="w1457"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-name" class="solar"><span class="function" start="1" pair-end="7" select="quick">name</span></a><span class="parenthesis">(</span><span class="context" start="6">.</span><span class="parenthesis" start="7">)</span><span class="whitespace" start="8"> </span><span class="op" start="9">!=</span><span class="whitespace" start="11"> </span><span class="op">'</span><span class="literal" start="12">role</span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	    </span><span class="ww" id="w1476"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span id="wx1484" class="sc">/&gt;</span></span><span class="txt">
	  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx1488" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx1492" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ww" id="w1494"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$glossary</span><span class="step" start="10">/</span><span class="qname" start="11" select="quick">db:glossary</span><span class="step" start="22">/</span><span class="qname" start="23" select="quick">db:info</span><span class="z">"</span><span id="wx1506" class="sc">/&gt;</span></span><span class="txt">

	</span><span class="ww" id="w1508"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?seealsos">seealsos</span><span class="z">"</span><span class="z"> </span><span class="atn">as</span><span class="atneq">=</span><span class="z">"</span><span class="av">element()*</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	  </span><span class="ww" id="w1524"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#v?external.glossary" class="solar"><span class="variable" start="1" select="quick">$external.glossary</span></a><span class="step" start="19">//</span><span class="qname" start="21" select="quick">db:glossseealso</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	    </span><span class="ww" id="w1536"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="if" start="1">if</span><span class="whitespace" start="3"> </span><span class="parenthesis" start="4" pair-end="26" select="quick">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="5" pair-end="25" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="9">id</span><span class="op">'</span><span class="op" start="13">,</span><span class="whitespace" start="14"> </span><span class="axis" start="15">@</span><span class="qname" start="16" select="quick">otherterm</span><span class="parenthesis" start="25">)</span><span class="parenthesis" start="26">)</span><span class="whitespace" start="27">
                     </span><span class="qname" start="28" select="quick">	</span><span class="qname" start="29" select="quick">	</span><span class="qname" start="30" select="quick">	</span><span class="qname" start="31" select="quick">	</span><span class="whitespace" start="32">  </span><span class="op" start="34">then</span><span class="whitespace" start="38"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="39" pair-end="59" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="43">id</span><span class="op">'</span><span class="op" start="47">,</span><span class="whitespace" start="48"> </span><span class="axis" start="49">@</span><span class="qname" start="50" select="quick">otherterm</span><span class="parenthesis" start="59">)</span><span class="filter" start="60" pair-end="62" select="quick">[</span><span class="numeric" start="61">1</span><span class="filter" start="62">]</span><span class="whitespace" start="63">
                     </span><span class="qname" start="64" select="quick">	</span><span class="qname" start="65" select="quick">	</span><span class="qname" start="66" select="quick">	</span><span class="qname" start="67" select="quick">	</span><span class="whitespace" start="68">  </span><span class="op" start="70">else</span><span class="whitespace" start="74"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-key" class="solar"><span class="function" start="75" pair-end="101" select="quick">key</span></a><span class="parenthesis">(</span><span class="op">'</span><span class="literal" start="79">glossterm</span><span class="op">'</span><span class="op" start="90">,</span><span class="whitespace" start="91"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-string" class="solar"><span class="function" start="92" pair-end="100" select="quick">string</span></a><span class="parenthesis">(</span><span class="context" start="99">.</span><span class="parenthesis" start="100">)</span><span class="parenthesis" start="101">)</span><span class="z">"</span><span id="wx1598" class="sc">/&gt;</span></span><span class="txt">
	  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx1602" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx1606" class="ec">&gt;</span></span><span class="txt">

	</span><span class="ww" id="w1608"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?divs">divs</span><span class="z">"</span><span class="z">
              		      </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$glossary</span><span class="step" start="10">//</span><span class="qname" start="12" select="quick">db:glossary</span><span class="step" start="23">/</span><span class="qname" start="24" select="quick">db:glossdiv</span><span class="z">"</span><span id="wx1626" class="sc">/&gt;</span></span><span class="txt">

	</span><span class="ww" id="w1628"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
	  </span><span class="ww" id="w1632"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$divs</span><span class="whitespace" start="6"> </span><span class="op" start="7">and</span><span class="whitespace" start="10"> </span><a href="xslt/base/common/normalize.xsl.html#v?external.glossary" class="solar"><span class="variable" start="11" select="quick">$external.glossary</span></a><span class="step" start="29">//</span><span class="qname" start="31" select="quick">db:glossdiv</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	    </span><span class="ww" id="w1648"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#v?external.glossary" class="solar"><span class="variable" start="1" select="quick">$external.glossary</span></a><span class="step" start="19">//</span><span class="qname" start="21" select="quick">db:glossdiv</span><span class="z">"</span><span class="z">
                     				 </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:copy-external-glossary</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	      </span><span class="ww" id="w1666"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">terms</span><span class="z">"</span><span class="z">
                			      </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">//</span><span class="qname" start="3" select="quick">db:glossterm</span><span class="filter" start="15" pair-end="40" select="quick">[</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="16" pair-end="39" select="quick">not</span></a><span class="parenthesis">(</span><span class="axis" start="20">parent::</span><span class="qname" start="28" select="quick">db:glossdef</span><span class="parenthesis" start="39">)</span><span class="filter" start="40">]</span><span class="whitespace" start="41">
                        </span><span class="qname" start="42" select="quick">	</span><span class="qname" start="43" select="quick">	</span><span class="qname" start="44" select="quick">	</span><span class="qname" start="45" select="quick">	</span><span class="whitespace" start="46">      </span><span class="op" start="52">|</span><span class="step" start="53">//</span><span class="qname" start="55" select="quick">db:firstterm</span><span class="whitespace" start="67">
                        </span><span class="qname" start="68" select="quick">	</span><span class="qname" start="69" select="quick">	</span><span class="qname" start="70" select="quick">	</span><span class="qname" start="71" select="quick">	</span><span class="whitespace" start="72">      </span><span class="op" start="78">|</span><span class="variable" start="79" select="quick">$seealsos</span><span class="z">"</span><span id="wx1705" class="sc">/&gt;</span></span><span class="txt">
	      </span><span class="ww" id="w1707"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">divs</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$divs</span><span class="z">"</span><span id="wx1721" class="sc">/&gt;</span></span><span class="txt">
	    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:apply-templates</span><span id="wx1725" class="ec">&gt;</span></span><span class="txt">
	  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1729" class="ec">&gt;</span></span><span class="txt">
	  </span><span class="ww" id="w1731"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
	    </span><span class="ww" id="w1735"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#v?external.glossary" class="solar"><span class="variable" start="1" select="quick">$external.glossary</span></a><span class="step" start="19">//</span><span class="qname" start="21" select="quick">db:glossentry</span><span class="z">"</span><span class="z">
                     				 </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:copy-external-glossary</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	      </span><span class="ww" id="w1753"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">terms</span><span class="z">"</span><span class="z">
                			      </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="step" start="1">//</span><span class="qname" start="3" select="quick">db:glossterm</span><span class="filter" start="15" pair-end="40" select="quick">[</span><a href="http://www.w3.org/TR/xpath-functions/#func-not" class="solar"><span class="function" start="16" pair-end="39" select="quick">not</span></a><span class="parenthesis">(</span><span class="axis" start="20">parent::</span><span class="qname" start="28" select="quick">db:glossdef</span><span class="parenthesis" start="39">)</span><span class="filter" start="40">]</span><span class="whitespace" start="41">
                        </span><span class="qname" start="42" select="quick">	</span><span class="qname" start="43" select="quick">	</span><span class="qname" start="44" select="quick">	</span><span class="qname" start="45" select="quick">	</span><span class="whitespace" start="46">      </span><span class="op" start="52">|</span><span class="step" start="53">//</span><span class="qname" start="55" select="quick">db:firstterm</span><span class="whitespace" start="67">
                        </span><span class="qname" start="68" select="quick">	</span><span class="qname" start="69" select="quick">	</span><span class="qname" start="70" select="quick">	</span><span class="qname" start="71" select="quick">	</span><span class="whitespace" start="72">      </span><span class="op" start="78">|</span><span class="variable" start="79" select="quick">$seealsos</span><span class="z">"</span><span id="wx1792" class="sc">/&gt;</span></span><span class="txt">
	      </span><span class="ww" id="w1794"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">divs</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$divs</span><span class="z">"</span><span id="wx1808" class="sc">/&gt;</span></span><span class="txt">
	    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:apply-templates</span><span id="wx1812" class="ec">&gt;</span></span><span class="txt">
	  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx1816" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx1820" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:element</span><span id="wx1824" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx1828" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ww" id="w1830"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w1834"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$glossary</span><span class="z">"</span><span id="wx1842" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx1846" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx1850" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx1854" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w1856"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:index</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w1872"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title" class="solar"><span class="tcall">n:normalize-generated-title</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w1882"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx1899" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx1903" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx1907" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w1909"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:setindex</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w1925"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title" class="solar"><span class="tcall">n:normalize-generated-title</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w1935"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx1952" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx1956" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx1960" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w1962"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:abstract</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w1978"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title" class="solar"><span class="tcall">n:normalize-generated-title</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w1988"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx2005" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx2009" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx2013" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2015"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:legalnotice</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w2031"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title" class="solar"><span class="tcall">n:normalize-generated-title</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w2041"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx2058" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx2062" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx2066" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2068"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:note</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w2084"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title" class="solar"><span class="tcall">n:normalize-generated-title</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w2094"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx2111" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx2115" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx2119" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2121"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:tip</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w2137"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title" class="solar"><span class="tcall">n:normalize-generated-title</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w2147"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx2164" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx2168" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx2172" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2174"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:caution</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w2190"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title" class="solar"><span class="tcall">n:normalize-generated-title</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w2200"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx2217" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx2221" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx2225" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2227"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:warning</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w2243"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title" class="solar"><span class="tcall">n:normalize-generated-title</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w2253"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx2270" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx2274" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx2278" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2280"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:important</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w2296"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title" class="solar"><span class="tcall">n:normalize-generated-title</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w2306"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-local-name" class="solar"><span class="function" start="1" pair-end="13" select="quick">local-name</span></a><span class="parenthesis">(</span><span class="context" start="12">.</span><span class="parenthesis" start="13">)</span><span class="z">"</span><span id="wx2323" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx2327" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx2331" class="ec">&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> ============================================================ </span><span class="z">--&gt;</span><span class="txt">

</span><span class="ww" id="w2337"><span class="es">&lt;</span><span class="en">doc:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">n:normalize-generated-title</span><span class="z">"</span><span class="z">
              	      </span><span class="atn">xmlns</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w2353"><span class="es">&lt;</span><span class="en">refpurpose</span><span class="scx">&gt;</span><span class="txt">Generate a title, if necessary, and see that its moved into
</span><span class="ww" id="w2357"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">info</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx2363" class="ec">&gt;</span></span><span class="txt"></span><span class="ez">&lt;/</span><span class="cl">refpurpose</span><span id="wx2367" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2369"><span class="es">&lt;</span><span class="en">refdescription</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w2373"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">If the context node does not have a title, this template will
generate one. In either case, the title will be placed or moved inside
an </span><span class="ww" id="w2377"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">info</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx2383" class="ec">&gt;</span></span><span class="txt"> which will be created if necessary.
</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx2387" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">refdescription</span><span id="wx2391" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2393"><span class="es">&lt;</span><span class="en">refparameter</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w2397"><span class="es">&lt;</span><span class="en">variablelist</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w2401"><span class="es">&lt;</span><span class="en">varlistentry</span><span class="scx">&gt;</span><span class="txt"></span><span class="ww" id="w2405"><span class="es">&lt;</span><span class="en">term</span><span class="scx">&gt;</span><span class="txt">title-key</span><span class="ez">&lt;/</span><span class="cl">term</span><span id="wx2411" class="ec">&gt;</span></span><span class="txt">
</span><span class="ww" id="w2413"><span class="es">&lt;</span><span class="en">listitem</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w2417"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">The key to use for creating the generated-text title if one is
necessary.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx2423" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">listitem</span><span id="wx2427" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">varlistentry</span><span id="wx2431" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">variablelist</span><span id="wx2435" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">refparameter</span><span id="wx2439" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2441"><span class="es">&lt;</span><span class="en">refreturn</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w2445"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">The transformed node.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx2451" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">refreturn</span><span id="wx2455" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">doc:template</span><span id="wx2459" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2461"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/normalize}normalize-generated-title">n:normalize-generated-title</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w2471"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?title-key">title-key</span><span class="z">"</span><span id="wx2479" class="sc">/&gt;</span></span><span class="txt">

  </span><span class="ww" id="w2481"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w2485"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:title</span><span class="op" start="9">|</span><span class="qname" start="10" select="quick">db:info</span><span class="step" start="17">/</span><span class="qname" start="18" select="quick">db:title</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w2499"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-movetitle" class="solar"><span class="tcall">n:normalize-movetitle</span></a><span class="z">"</span><span id="wx2507" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2511" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ww" id="w2513"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w2517"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
	</span><span class="ww" id="w2521"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx2530" class="sc">/&gt;</span></span><span class="txt">

	</span><span class="ww" id="w2532"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
	  </span><span class="ww" id="w2536"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:info</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	    </span><span class="ww" id="w2546"><span class="es">&lt;</span><span class="enxsl">xsl:element</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">info</span><span class="z">"</span><span class="z"> </span><span class="atn">namespace</span><span class="atneq">=</span><span class="z">"</span><span class="op">{</span><a href="xslt/base/html/param.xsl.html#v?docbook-namespace" class="solar"><span class="variable" start="1" select="quick">$docbook-namespace</span></a><span class="op">}</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	      </span><span class="ww" id="w2564"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:info</span><span class="step" start="8">/</span><span class="axis" start="9">@</span><span class="qname" start="10" select="quick">*</span><span class="z">"</span><span id="wx2575" class="sc">/&gt;</span></span><span class="txt">
	      </span><span class="ww" id="w2577"><span class="es">&lt;</span><span class="enxsl">xsl:element</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title</span><span class="z">"</span><span class="z"> </span><span class="atn">namespace</span><span class="atneq">=</span><span class="z">"</span><span class="op">{</span><a href="xslt/base/html/param.xsl.html#v?docbook-namespace" class="solar"><span class="variable" start="1" select="quick">$docbook-namespace</span></a><span class="op">}</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
		</span><span class="ww" id="w2595"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">n:normalized-title</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
		  </span><span class="ww" id="w2611"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$title-key</span><span class="z">"</span><span id="wx2625" class="sc">/&gt;</span></span><span class="txt">
		</span><span class="ez">&lt;/</span><span class="clxsl">xsl:apply-templates</span><span id="wx2629" class="ec">&gt;</span></span><span class="txt">
	      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:element</span><span id="wx2633" class="ec">&gt;</span></span><span class="txt">
	      </span><span class="ww" id="w2635"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:info</span><span class="step" start="8">/</span><span class="axis" start="9">preceding-sibling::</span><span class="node" start="28" pair-end="33" select="quick">node</span><span class="parenthesis">(</span><span class="parenthesis" start="33">)</span><span class="z">"</span><span id="wx2648" class="sc">/&gt;</span></span><span class="txt">
	      </span><span class="ww" id="w2650"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:info</span><span class="step" start="8">/</span><span class="qname" start="9" select="quick">*</span><span class="z">"</span><span id="wx2660" class="sc">/&gt;</span></span><span class="txt">
	    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:element</span><span id="wx2664" class="ec">&gt;</span></span><span class="txt">

	    </span><span class="ww" id="w2666"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:info</span><span class="step" start="8">/</span><span class="axis" start="9">following-sibling::</span><span class="node" start="28" pair-end="33" select="quick">node</span><span class="parenthesis">(</span><span class="parenthesis" start="33">)</span><span class="z">"</span><span class="z">
                     				 </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx2685" class="sc">/&gt;</span></span><span class="txt">
	  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx2689" class="ec">&gt;</span></span><span class="txt">

	  </span><span class="ww" id="w2691"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
	    </span><span class="ww" id="w2695"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?node-tree">node-tree</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	      </span><span class="ww" id="w2705"><span class="es">&lt;</span><span class="enxsl">xsl:element</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title</span><span class="z">"</span><span class="z"> </span><span class="atn">namespace</span><span class="atneq">=</span><span class="z">"</span><span class="op">{</span><a href="xslt/base/html/param.xsl.html#v?docbook-namespace" class="solar"><span class="variable" start="1" select="quick">$docbook-namespace</span></a><span class="op">}</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
		</span><span class="ww" id="w2723"><span class="es">&lt;</span><span class="enxsl">xsl:attribute</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">ghost:title</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="op">'</span><span class="literal" start="1">yes</span><span class="op">'</span><span class="z">"</span><span id="wx2739" class="sc">/&gt;</span></span><span class="txt">
		</span><span class="ww" id="w2741"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">n:normalized-title</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
		  </span><span class="ww" id="w2757"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">title-key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$title-key</span><span class="z">"</span><span id="wx2771" class="sc">/&gt;</span></span><span class="txt">
		</span><span class="ez">&lt;/</span><span class="clxsl">xsl:apply-templates</span><span id="wx2775" class="ec">&gt;</span></span><span class="txt">
	      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:element</span><span id="wx2779" class="ec">&gt;</span></span><span class="txt">
	    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx2783" class="ec">&gt;</span></span><span class="txt">

	    </span><span class="ww" id="w2785"><span class="es">&lt;</span><span class="enxsl">xsl:element</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">info</span><span class="z">"</span><span class="z"> </span><span class="atn">namespace</span><span class="atneq">=</span><span class="z">"</span><span class="op">{</span><a href="xslt/base/html/param.xsl.html#v?docbook-namespace" class="solar"><span class="variable" start="1" select="quick">$docbook-namespace</span></a><span class="op">}</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	      </span><span class="ww" id="w2803"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-dbinfo" class="solar"><span class="tcall">n:normalize-dbinfo</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
		</span><span class="ww" id="w2813"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">copynodes</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$node-tree</span><span class="step" start="11">/</span><span class="qname" start="12" select="quick">*</span><span class="z">"</span><span id="wx2829" class="sc">/&gt;</span></span><span class="txt">
	      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx2833" class="ec">&gt;</span></span><span class="txt">
	    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:element</span><span id="wx2837" class="ec">&gt;</span></span><span class="txt">
	    </span><span class="ww" id="w2839"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx2847" class="sc">/&gt;</span></span><span class="txt">
	  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx2851" class="ec">&gt;</span></span><span class="txt">
	</span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx2855" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx2859" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx2863" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx2867" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx2871" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2873"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">*</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">n:normalized-title</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w2889"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?title-key">title-key</span><span class="z">"</span><span id="wx2897" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ww" id="w2899"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/l10n.xsl.html#t?gentext" class="solar"><span class="tcall">gentext</span></a><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w2909"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">key</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$title-key</span><span class="z">"</span><span id="wx2923" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:call-template</span><span id="wx2927" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx2931" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w2933"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:info</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w2949"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w2953"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx2962" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ww" id="w2964"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-dbinfo" class="solar"><span class="tcall">n:normalize-dbinfo</span></a><span class="z">"</span><span id="wx2972" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx2976" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx2980" class="ec">&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> ============================================================ </span><span class="z">--&gt;</span><span class="txt">

</span><span class="ww" id="w2986"><span class="es">&lt;</span><span class="en">doc:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">n:normalize-dbinfo</span><span class="z">"</span><span class="z">
              	      </span><span class="atn">xmlns</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w3002"><span class="es">&lt;</span><span class="en">refpurpose</span><span class="scx">&gt;</span><span class="txt">Copy the specified nodes, normalizing other content
if appropriate</span><span class="ez">&lt;/</span><span class="cl">refpurpose</span><span id="wx3008" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w3010"><span class="es">&lt;</span><span class="en">refdescription</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w3014"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">The specified nodes are copied. If the context node is an
</span><span class="ww" id="w3018"><span class="es">&lt;</span><span class="en">tag</span><span class="scx">&gt;</span><span class="txt">info</span><span class="ez">&lt;/</span><span class="cl">tag</span><span id="wx3024" class="ec">&gt;</span></span><span class="txt"> element, then the rest of its contents are also normalized.
</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx3028" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">refdescription</span><span id="wx3032" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w3034"><span class="es">&lt;</span><span class="en">refparameter</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w3038"><span class="es">&lt;</span><span class="en">variablelist</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w3042"><span class="es">&lt;</span><span class="en">varlistentry</span><span class="scx">&gt;</span><span class="txt"></span><span class="ww" id="w3046"><span class="es">&lt;</span><span class="en">term</span><span class="scx">&gt;</span><span class="txt">copynodes</span><span class="ez">&lt;/</span><span class="cl">term</span><span id="wx3052" class="ec">&gt;</span></span><span class="txt">
</span><span class="ww" id="w3054"><span class="es">&lt;</span><span class="en">listitem</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w3058"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">The nodes to copy.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx3064" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">listitem</span><span id="wx3068" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">varlistentry</span><span id="wx3072" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">variablelist</span><span id="wx3076" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">refparameter</span><span id="wx3080" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w3082"><span class="es">&lt;</span><span class="en">refreturn</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w3086"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">The transformed node.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx3092" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">refreturn</span><span id="wx3096" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">doc:template</span><span id="wx3100" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w3102"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="tname" id="t?{http://docbook.org/xslt/ns/normalize}normalize-dbinfo">n:normalize-dbinfo</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w3112"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?copynodes">copynodes</span><span class="z">"</span><span id="wx3120" class="sc">/&gt;</span></span><span class="txt">

  </span><span class="ww" id="w3122"><span class="es">&lt;</span><span class="enxsl">xsl:for-each</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$copynodes</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w3132"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w3136"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx3145" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ww" id="w3147"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx3155" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx3159" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:for-each</span><span id="wx3163" class="ec">&gt;</span></span><span class="txt">

  </span><span class="ww" id="w3165"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">self::</span><span class="qname" start="7" select="quick">db:info</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w3176"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx3184" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx3188" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx3192" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w3194"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:inlinemediaobject</span><span class="whitespace" start="21">
                     </span><span class="qname" start="22" select="quick">	</span><span class="qname" start="23" select="quick">	</span><span class="whitespace" start="24">     </span><span class="filter" start="29" pair-end="284" select="quick">[</span><span class="parenthesis" start="30" pair-end="194" select="quick">(</span><span class="axis" start="31">parent::</span><span class="qname" start="39" select="quick">db:programlisting</span><span class="whitespace" start="56">
                     </span><span class="qname" start="57" select="quick">	</span><span class="qname" start="58" select="quick">	</span><span class="whitespace" start="59">       </span><span class="op" start="66">or</span><span class="whitespace" start="68"> </span><span class="axis" start="69">parent::</span><span class="qname" start="77" select="quick">db:screen</span><span class="whitespace" start="86">
                     </span><span class="qname" start="87" select="quick">	</span><span class="qname" start="88" select="quick">	</span><span class="whitespace" start="89">       </span><span class="op" start="96">or</span><span class="whitespace" start="98"> </span><span class="axis" start="99">parent::</span><span class="qname" start="107" select="quick">db:literallayout</span><span class="whitespace" start="123">
                     </span><span class="qname" start="124" select="quick">	</span><span class="qname" start="125" select="quick">	</span><span class="whitespace" start="126">       </span><span class="op" start="133">or</span><span class="whitespace" start="135"> </span><span class="axis" start="136">parent::</span><span class="qname" start="144" select="quick">db:address</span><span class="whitespace" start="154">
                     </span><span class="qname" start="155" select="quick">	</span><span class="qname" start="156" select="quick">	</span><span class="whitespace" start="157">       </span><span class="op" start="164">or</span><span class="whitespace" start="166"> </span><span class="axis" start="167">parent::</span><span class="qname" start="175" select="quick">db:funcsynopsisinfo</span><span class="parenthesis" start="194">)</span><span class="whitespace" start="195">
                     </span><span class="qname" start="196" select="quick">	</span><span class="qname" start="197" select="quick">	</span><span class="whitespace" start="198">     </span><span class="op" start="203">and</span><span class="whitespace" start="206"> </span><span class="qname" start="207" select="quick">db:imageobject</span><span class="whitespace" start="221">
                     </span><span class="qname" start="222" select="quick">	</span><span class="qname" start="223" select="quick">	</span><span class="whitespace" start="224">     </span><span class="op" start="229">and</span><span class="whitespace" start="232"> </span><span class="qname" start="233" select="quick">db:imageobject</span><span class="step" start="247">/</span><span class="qname" start="248" select="quick">db:imagedata</span><span class="filter" start="260" pair-end="283" select="quick">[</span><span class="axis" start="261">@</span><span class="qname" start="262" select="quick">format</span><span class="op" start="268">=</span><span class="op">'</span><span class="literal" start="269">linespecific</span><span class="op">'</span><span class="filter" start="283">]</span><span class="filter" start="284">]</span><span class="z">"</span><span class="z">
              	      </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">

  </span><span class="ww" id="w3276"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?data">data</span><span class="z">"</span><span class="z">
              		</span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="parenthesis" start="1" pair-end="58" select="quick">(</span><span class="qname" start="2" select="quick">db:imageobject</span><span class="whitespace" start="16">
                      </span><span class="qname" start="17" select="quick">	</span><span class="qname" start="18" select="quick">	</span><span class="qname" start="19" select="quick">	</span><span class="whitespace" start="20"> </span><span class="step" start="21">/</span><span class="qname" start="22" select="quick">db:imagedata</span><span class="filter" start="34" pair-end="57" select="quick">[</span><span class="axis" start="35">@</span><span class="qname" start="36" select="quick">format</span><span class="op" start="42">=</span><span class="op">'</span><span class="literal" start="43">linespecific</span><span class="op">'</span><span class="filter" start="57">]</span><span class="parenthesis" start="58">)</span><span class="filter" start="59" pair-end="61" select="quick">[</span><span class="numeric" start="60">1</span><span class="filter" start="61">]</span><span class="z">"</span><span id="wx3310" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ww" id="w3312"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w3316"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$data</span><span class="step" start="6">/</span><span class="axis" start="7">@</span><span class="qname" start="8" select="quick">entityref</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w3329"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-unparsed-text" class="solar"><span class="function" start="1" pair-end="52" select="quick">unparsed-text</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-unparsed-entity-uri" class="solar"><span class="function" start="15" pair-end="51" select="quick">unparsed-entity-uri</span></a><span class="parenthesis">(</span><span class="variable" start="35" select="quick">$data</span><span class="step" start="40">/</span><span class="axis" start="41">@</span><span class="qname" start="42" select="quick">entityref</span><span class="parenthesis" start="51">)</span><span class="parenthesis" start="52">)</span><span class="z">"</span><span id="wx3346" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx3350" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ww" id="w3352"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w3356"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-unparsed-text" class="solar"><span class="function" start="1" pair-end="29" select="quick">unparsed-text</span></a><span class="parenthesis">(</span><span class="variable" start="15" select="quick">$data</span><span class="step" start="20">/</span><span class="axis" start="21">@</span><span class="qname" start="22" select="quick">fileref</span><span class="parenthesis" start="29">)</span><span class="z">"</span><span id="wx3370" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx3374" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx3378" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx3382" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w3384"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:textobject</span><span class="whitespace" start="14">
                     </span><span class="qname" start="15" select="quick">	</span><span class="qname" start="16" select="quick">	</span><span class="whitespace" start="17">     </span><span class="filter" start="22" pair-end="182" select="quick">[</span><span class="axis" start="23">parent::</span><span class="qname" start="31" select="quick">db:programlisting</span><span class="whitespace" start="48">
                     </span><span class="qname" start="49" select="quick">	</span><span class="qname" start="50" select="quick">	</span><span class="whitespace" start="51">      </span><span class="op" start="57">or</span><span class="whitespace" start="59"> </span><span class="axis" start="60">parent::</span><span class="qname" start="68" select="quick">db:screen</span><span class="whitespace" start="77">
                     </span><span class="qname" start="78" select="quick">	</span><span class="qname" start="79" select="quick">	</span><span class="whitespace" start="80">      </span><span class="op" start="86">or</span><span class="whitespace" start="88"> </span><span class="axis" start="89">parent::</span><span class="qname" start="97" select="quick">db:literallayout</span><span class="whitespace" start="113">
                     </span><span class="qname" start="114" select="quick">	</span><span class="qname" start="115" select="quick">	</span><span class="whitespace" start="116">      </span><span class="op" start="122">or</span><span class="whitespace" start="124"> </span><span class="axis" start="125">parent::</span><span class="qname" start="133" select="quick">db:address</span><span class="whitespace" start="143">
                     </span><span class="qname" start="144" select="quick">	</span><span class="qname" start="145" select="quick">	</span><span class="whitespace" start="146">      </span><span class="op" start="152">or</span><span class="whitespace" start="154"> </span><span class="axis" start="155">parent::</span><span class="qname" start="163" select="quick">db:funcsynopsisinfo</span><span class="filter" start="182">]</span><span class="z">"</span><span class="z">
              	      </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w3440"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w3444"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:textdata</span><span class="step" start="12">/</span><span class="axis" start="13">@</span><span class="qname" start="14" select="quick">entityref</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w3457"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-unparsed-text" class="solar"><span class="function" start="1" pair-end="58" select="quick">unparsed-text</span></a><span class="parenthesis">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-unparsed-entity-uri" class="solar"><span class="function" start="15" pair-end="57" select="quick">unparsed-entity-uri</span></a><span class="parenthesis">(</span><span class="qname" start="35" select="quick">db:textdata</span><span class="step" start="46">/</span><span class="axis" start="47">@</span><span class="qname" start="48" select="quick">entityref</span><span class="parenthesis" start="57">)</span><span class="parenthesis" start="58">)</span><span class="z">"</span><span id="wx3474" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx3478" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ww" id="w3480"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w3484"><span class="es">&lt;</span><span class="enxsl">xsl:value-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><a href="http://www.w3.org/TR/xpath-functions/#func-unparsed-text" class="solar"><span class="function" start="1" pair-end="35" select="quick">unparsed-text</span></a><span class="parenthesis">(</span><span class="qname" start="15" select="quick">db:textdata</span><span class="step" start="26">/</span><span class="axis" start="27">@</span><span class="qname" start="28" select="quick">fileref</span><span class="parenthesis" start="35">)</span><span class="z">"</span><span id="wx3498" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx3502" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx3506" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx3510" class="ec">&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> CALS tables are normalized here so that they're in the right context later </span><span class="z">--&gt;</span><span class="txt">
</span><span class="ww" id="w3516"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:tgroup</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w3532"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:cals-phase-1</span><span class="z">"</span><span id="wx3546" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx3550" class="ec">&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> Verbatim environments are normalized here too </span><span class="z">--&gt;</span><span class="txt">
</span><span class="ww" id="w3556"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z">
        </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:programlisting</span><span class="op" start="18">|</span><span class="qname" start="19" select="quick">db:address</span><span class="op" start="29">|</span><span class="qname" start="30" select="quick">db:screen</span><span class="op" start="39">|</span><span class="qname" start="40" select="quick">db:synopsis</span><span class="op" start="51">|</span><span class="qname" start="52" select="quick">db:literallayout</span><span class="z">"</span><span class="z">
        </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">

  </span><span class="ww" id="w3580"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?normalized">normalized</span><span class="z">"</span><span class="z"> </span><span class="atn">as</span><span class="atneq">=</span><span class="z">"</span><span class="av">element()</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w3596"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w3600"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx3609" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ww" id="w3611"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx3619" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx3623" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx3627" class="ec">&gt;</span></span><span class="txt">

  </span><span class="ww" id="w3629"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$normalized</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:verbatim-phase-1</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w3645"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">origelem</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span id="wx3659" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:apply-templates</span><span id="wx3663" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx3667" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w3669"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:programlistingco</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w3685"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?normalized">normalized</span><span class="z">"</span><span class="z"> </span><span class="atn">as</span><span class="atneq">=</span><span class="z">"</span><span class="av">element()</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w3701"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w3705"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx3714" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ww" id="w3716"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:info</span><span class="z">"</span><span id="wx3724" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ww" id="w3726"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:areaspec</span><span class="z">"</span><span id="wx3734" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ww" id="w3736"><span class="es">&lt;</span><span class="en">db:programlisting</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w3740"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:programlisting</span><span class="step" start="18">/</span><span class="axis" start="19">@</span><span class="qname" start="20" select="quick">*</span><span class="z">"</span><span id="wx3751" class="sc">/&gt;</span></span><span class="txt">
        </span><span class="ww" id="w3753"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:programlisting</span><span class="step" start="18">/</span><span class="node" start="19" pair-end="24" select="quick">node</span><span class="parenthesis">(</span><span class="parenthesis" start="24">)</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx3771" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="cl">db:programlisting</span><span id="wx3775" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ww" id="w3777"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:calloutlist</span><span class="z">"</span><span id="wx3785" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx3789" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx3793" class="ec">&gt;</span></span><span class="txt">

  </span><span class="ww" id="w3795"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$normalized</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:verbatim-phase-1</span><span class="z">"</span><span id="wx3809" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx3813" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w3815"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">*</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w3831"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w3835"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:title</span><span class="op" start="9">|</span><span class="qname" start="10" select="quick">db:subtitle</span><span class="op" start="21">|</span><span class="qname" start="22" select="quick">db:titleabbrev</span><span class="op" start="36">|</span><span class="qname" start="37" select="quick">db:info</span><span class="step" start="44">/</span><span class="qname" start="45" select="quick">db:title</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w3853"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
        </span><span class="ww" id="w3857"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">parent::</span><span class="qname" start="9" select="quick">db:biblioentry</span><span class="whitespace" start="23">
                                        </span><span class="op" start="48">|</span><span class="axis" start="49">parent::</span><span class="qname" start="57" select="quick">db:bibliomixed</span><span class="whitespace" start="71">
                                        </span><span class="op" start="96">|</span><span class="axis" start="97">parent::</span><span class="qname" start="105" select="quick">db:bibliomset</span><span class="whitespace" start="118">
                                        </span><span class="op" start="143">|</span><span class="axis" start="144">parent::</span><span class="qname" start="152" select="quick">db:biblioset</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="ww" id="w3880"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
            </span><span class="ww" id="w3884"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx3893" class="sc">/&gt;</span></span><span class="txt">
            </span><span class="ww" id="w3895"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx3903" class="sc">/&gt;</span></span><span class="txt">
          </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx3907" class="ec">&gt;</span></span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx3911" class="ec">&gt;</span></span><span class="txt">
        </span><span class="ww" id="w3913"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
          </span><span class="ww" id="w3917"><span class="es">&lt;</span><span class="enxsl">xsl:call-template</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><a href="xslt/base/common/normalize.xsl.html#t?{http://docbook.org/xslt/ns/normalize}normalize-movetitle" class="solar"><span class="tcall">n:normalize-movetitle</span></a><span class="z">"</span><span id="wx3925" class="sc">/&gt;</span></span><span class="txt">
        </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx3929" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx3933" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx3937" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ww" id="w3939"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w3943"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
	</span><span class="ww" id="w3947"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx3956" class="sc">/&gt;</span></span><span class="txt">
	</span><span class="ww" id="w3958"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span id="wx3966" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx3970" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx3974" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx3978" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx3982" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w3984"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="node" start="1" pair-end="9" select="quick">comment</span><span class="parenthesis">(</span><span class="parenthesis" start="9">)</span><span class="op" start="10">|</span><span class="node" start="11" pair-end="34" select="quick">processing-instruction</span><span class="parenthesis">(</span><span class="parenthesis" start="34">)</span><span class="op" start="35">|</span><span class="node" start="36" pair-end="41" select="quick">text</span><span class="parenthesis">(</span><span class="parenthesis" start="41">)</span><span class="z">"</span><span class="z">
              	      </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:normalize</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w4010"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span id="wx4012" class="sc">/&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx4016" class="ec">&gt;</span></span><span class="txt">

</span><span class="z">&lt;!--</span><span class="cm"> ============================================================ </span><span class="z">--&gt;</span><span class="txt">
</span><span class="z">&lt;!--</span><span class="cm"> copy external glossary </span><span class="z">--&gt;</span><span class="txt">

</span><span class="ww" id="w4026"><span class="es">&lt;</span><span class="en">doc:mode</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:copy-external-glossary</span><span class="z">"</span><span class="z">
          	  </span><span class="atn">xmlns</span><span class="atneq">=</span><span class="z">"</span><span class="av">http://docbook.org/ns/docbook</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w4042"><span class="es">&lt;</span><span class="en">refpurpose</span><span class="scx">&gt;</span><span class="txt">Mode for copying external glossary entries</span><span class="ez">&lt;/</span><span class="cl">refpurpose</span><span id="wx4048" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w4050"><span class="es">&lt;</span><span class="en">refdescription</span><span class="scx">&gt;</span><span class="txt">
</span><span class="ww" id="w4054"><span class="es">&lt;</span><span class="en">para</span><span class="scx">&gt;</span><span class="txt">This mode is used to copy glossary entries from the
</span><span class="ww" id="w4058"><span class="es">&lt;</span><span class="en">parameter</span><span class="scx">&gt;</span><span class="txt">glossary.collection</span><span class="ez">&lt;/</span><span class="cl">parameter</span><span id="wx4064" class="ec">&gt;</span></span><span class="txt"> into the current document.</span><span class="ez">&lt;/</span><span class="cl">para</span><span id="wx4068" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">refdescription</span><span id="wx4072" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="cl">doc:mode</span><span id="wx4076" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w4078"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:glossdiv</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:copy-external-glossary</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w4094"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?terms">terms</span><span class="z">"</span><span id="wx4102" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ww" id="w4104"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?divs">divs</span><span class="z">"</span><span id="wx4112" class="sc">/&gt;</span></span><span class="txt">

  </span><span class="ww" id="w4114"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?entries">entries</span><span class="z">"</span><span class="z"> </span><span class="atn">as</span><span class="atneq">=</span><span class="z">"</span><span class="av">element()*</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w4130"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:glossentry</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:copy-external-glossary</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w4146"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">terms</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$terms</span><span class="z">"</span><span id="wx4160" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ww" id="w4162"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">divs</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$divs</span><span class="z">"</span><span id="wx4176" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:apply-templates</span><span id="wx4180" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:variable</span><span id="wx4184" class="ec">&gt;</span></span><span class="txt">

  </span><span class="ww" id="w4186"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$entries</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w4196"><span class="es">&lt;</span><span class="enxsl">xsl:choose</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w4200"><span class="es">&lt;</span><span class="enxsl">xsl:when</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$divs</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
	</span><span class="ww" id="w4210"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
	  </span><span class="ww" id="w4214"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx4223" class="sc">/&gt;</span></span><span class="txt">
	  </span><span class="ww" id="w4225"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:info</span><span class="z">"</span><span id="wx4233" class="sc">/&gt;</span></span><span class="txt">
	  </span><span class="ww" id="w4235"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$entries</span><span class="z">"</span><span id="wx4243" class="sc">/&gt;</span></span><span class="txt">
	</span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx4247" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:when</span><span id="wx4251" class="ec">&gt;</span></span><span class="txt">
      </span><span class="ww" id="w4253"><span class="es">&lt;</span><span class="enxsl">xsl:otherwise</span><span class="scx">&gt;</span><span class="txt">
	</span><span class="ww" id="w4257"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$entries</span><span class="z">"</span><span id="wx4265" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ez">&lt;/</span><span class="clxsl">xsl:otherwise</span><span id="wx4269" class="ec">&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:choose</span><span id="wx4273" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx4277" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx4281" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w4283"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">db:glossentry</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:copy-external-glossary</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w4299"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?terms">terms</span><span class="z">"</span><span id="wx4307" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ww" id="w4309"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?divs">divs</span><span class="z">"</span><span id="wx4317" class="sc">/&gt;</span></span><span class="txt">

  </span><span class="ww" id="w4319"><span class="es">&lt;</span><span class="enxsl">xsl:variable</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?include">include</span><span class="z">"</span><span class="z">
                              </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="higher" start="1">for</span><span class="whitespace" start="4"> </span><span id="rng-$dterm" class="variable" start="5" select="quick">$dterm</span><span class="whitespace" start="11"> </span><span class="op" start="12">in</span><span class="whitespace" start="14"> </span><span class="variable" start="15" select="quick">$terms</span><span class="whitespace" start="21">
                                                 </span><span class="op" start="49">return</span><span class="whitespace" start="55"> 
                                                    </span><span class="higher" start="87">for</span><span class="whitespace" start="90"> </span><span id="rng-$gterm" class="variable" start="91" select="quick">$gterm</span><span class="whitespace" start="97"> </span><span class="op" start="98">in</span><span class="whitespace" start="100"> </span><span class="qname" start="101" select="quick">db:glossterm</span><span class="whitespace" start="113">
                                                       </span><span class="op" start="147">return</span><span class="whitespace" start="153">
                                                          </span><span class="if" start="190">if</span><span class="whitespace" start="192"> </span><span class="parenthesis" start="193" pair-end="302" select="quick">(</span><a href="http://www.w3.org/TR/xpath-functions/#func-string" class="solar"><span class="function" start="194" pair-end="207" select="quick">string</span></a><span class="parenthesis">(</span><span class="variable" start="201" select="quick">$dterm</span><span class="parenthesis" start="207">)</span><span class="whitespace" start="208"> </span><span class="op" start="209">=</span><span class="whitespace" start="210"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-string" class="solar"><span class="function" start="211" pair-end="224" select="quick">string</span></a><span class="parenthesis">(</span><span class="variable" start="218" select="quick">$gterm</span><span class="parenthesis" start="224">)</span><span class="whitespace" start="225">
                                                              </span><span class="op" start="266">or</span><span class="whitespace" start="268"> </span><span class="variable" start="269" select="quick">$dterm</span><span class="step" start="275">/</span><span class="axis" start="276">@</span><span class="qname" start="277" select="quick">baseform</span><span class="whitespace" start="285"> </span><span class="op" start="286">=</span><span class="whitespace" start="287"> </span><a href="http://www.w3.org/TR/xpath-functions/#func-string" class="solar"><span class="function" start="288" pair-end="301" select="quick">string</span></a><span class="parenthesis">(</span><span class="variable" start="295" select="quick">$gterm</span><span class="parenthesis" start="301">)</span><span class="parenthesis" start="302">)</span><span class="whitespace" start="303">
                                                          </span><span class="op" start="340">then</span><span class="whitespace" start="344"> </span><span class="op">'</span><span class="literal" start="345">x</span><span class="op">'</span><span class="whitespace" start="348">
                                                          </span><span class="op" start="385">else</span><span class="whitespace" start="389"> </span><span class="parenthesis" start="390" pair-end="391" select="quick">(</span><span class="parenthesis" start="391">)</span><span class="z">"</span><span id="wx4392" class="sc">/&gt;</span></span><span class="txt">

  </span><span class="ww" id="w4394"><span class="es">&lt;</span><span class="enxsl">xsl:if</span><span class="z"> </span><span class="atn">test</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$include</span><span class="whitespace" start="9"> </span><span class="op" start="10">!=</span><span class="whitespace" start="12"> </span><span class="op">'</span><span class="literal" start="13"></span><span class="op">'</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w4410"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="context" start="1">.</span><span class="z">"</span><span id="wx4418" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:if</span><span id="wx4422" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx4426" class="ec">&gt;</span></span><span class="txt">

</span><span class="ww" id="w4428"><span class="es">&lt;</span><span class="enxsl">xsl:template</span><span class="z"> </span><span class="atn">match</span><span class="atneq">=</span><span class="z">"</span><span class="qname" start="1" select="quick">*</span><span class="z">"</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:copy-external-glossary</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
  </span><span class="ww" id="w4444"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?terms">terms</span><span class="z">"</span><span id="wx4452" class="sc">/&gt;</span></span><span class="txt">
  </span><span class="ww" id="w4454"><span class="es">&lt;</span><span class="enxsl">xsl:param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="vname" id="v?divs">divs</span><span class="z">"</span><span id="wx4462" class="sc">/&gt;</span></span><span class="txt">

  </span><span class="ww" id="w4464"><span class="es">&lt;</span><span class="enxsl">xsl:copy</span><span class="scx">&gt;</span><span class="txt">
    </span><span class="ww" id="w4468"><span class="es">&lt;</span><span class="enxsl">xsl:copy-of</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="axis" start="1">@</span><span class="qname" start="2" select="quick">*</span><span class="z">"</span><span id="wx4477" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ww" id="w4479"><span class="es">&lt;</span><span class="enxsl">xsl:apply-templates</span><span class="z"> </span><span class="atn">mode</span><span class="atneq">=</span><span class="z">"</span><span class="av">m:copy-external-glossary</span><span class="z">"</span><span class="scx">&gt;</span><span class="txt">
      </span><span class="ww" id="w4489"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">terms</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$terms</span><span class="z">"</span><span id="wx4503" class="sc">/&gt;</span></span><span class="txt">
      </span><span class="ww" id="w4505"><span class="es">&lt;</span><span class="enxsl">xsl:with-param</span><span class="z"> </span><span class="atn">name</span><span class="atneq">=</span><span class="z">"</span><span class="av">divs</span><span class="z">"</span><span class="z"> </span><span class="atn">select</span><span class="atneq">=</span><span class="z">"</span><span class="variable" start="1" select="quick">$divs</span><span class="z">"</span><span id="wx4519" class="sc">/&gt;</span></span><span class="txt">
    </span><span class="ez">&lt;/</span><span class="clxsl">xsl:apply-templates</span><span id="wx4523" class="ec">&gt;</span></span><span class="txt">
  </span><span class="ez">&lt;/</span><span class="clxsl">xsl:copy</span><span id="wx4527" class="ec">&gt;</span></span><span class="txt">
</span><span class="ez">&lt;/</span><span class="clxsl">xsl:template</span><span id="wx4531" class="ec">&gt;</span></span><span class="txt">

</span><span class="ez">&lt;/</span><span class="clxsl">xsl:stylesheet</span><span id="wx4535" class="ec">&gt;</span></span><span class="txt">
</span></p></div></body></html>